[0m22:53:21.561721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA427E6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA53058D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA5306E50>]}


============================== 22:53:21.577353 | 30a38ec4-a58c-44b6-8537-b9a73d6254ac ==============================
[0m22:53:21.577353 [info ] [MainThread]: Running with dbt=1.10.9
[0m22:53:21.577353 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m22:53:21.615715 [info ] [MainThread]: dbt version: 1.10.9
[0m22:53:21.615715 [info ] [MainThread]: python version: 3.11.0
[0m22:53:21.615715 [info ] [MainThread]: python path: C:\Users\Administrator\Documents\health-readmission-case\.venv\Scripts\python.exe
[0m22:53:21.615715 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m22:53:25.354388 [info ] [MainThread]: Using profiles dir at C:\Users\Administrator\.dbt
[0m22:53:25.354388 [info ] [MainThread]: Using profiles.yml file at C:\Users\Administrator\.dbt\profiles.yml
[0m22:53:25.354388 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\dbt_project.yml
[0m22:53:25.354388 [info ] [MainThread]: adapter type: sqlserver
[0m22:53:25.354388 [info ] [MainThread]: adapter version: 1.9.0
[0m22:53:25.440048 [info ] [MainThread]: Configuration:
[0m22:53:25.441053 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:53:25.442053 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:53:25.442053 [info ] [MainThread]: Required dependencies:
[0m22:53:25.442053 [debug] [MainThread]: Executing "git --help"
[0m22:53:25.448324 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m22:53:25.448824 [info ] [MainThread]: Connection:
[0m22:53:25.449840 [info ] [MainThread]:   server: DESKTOP-DUU3C7T
[0m22:53:25.449840 [info ] [MainThread]:   database: ReadmitDB
[0m22:53:25.450839 [info ] [MainThread]:   schema: dbo
[0m22:53:25.450839 [info ] [MainThread]:   UID: None
[0m22:53:25.450839 [info ] [MainThread]:   client_id: None
[0m22:53:25.451838 [info ] [MainThread]:   authentication: windows
[0m22:53:25.451838 [info ] [MainThread]:   encrypt: False
[0m22:53:25.452838 [info ] [MainThread]:   trust_cert: False
[0m22:53:25.452838 [info ] [MainThread]:   retries: 3
[0m22:53:25.453839 [info ] [MainThread]:   login_timeout: 0
[0m22:53:25.454613 [info ] [MainThread]:   query_timeout: 0
[0m22:53:25.455593 [info ] [MainThread]:   trace_flag: False
[0m22:53:25.455895 [info ] [MainThread]:   port: 1433
[0m22:53:25.456898 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m22:53:25.825096 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m22:53:25.825096 [debug] [MainThread]: Using sqlserver connection "debug"
[0m22:53:25.825096 [debug] [MainThread]: On debug: select 1 as id
[0m22:53:25.825096 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:53:25.825096 [debug] [MainThread]: fabric adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T;Database=ReadmitDB;Pooling=true;SQL_ATTR_TRACE=SQL_OPT_TRACE_OFF;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.3;ConnectRetryCount=3;ConnectRetryInterval=10
[0m22:53:25.918868 [debug] [MainThread]: fabric adapter: Error running SQL: select 1 as id
[0m22:53:25.918868 [debug] [MainThread]: fabric adapter: Rolling back transaction.
[0m22:53:25.934419 [debug] [MainThread]: On debug: No close available on handle
[0m22:53:25.934419 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m22:53:25.934419 [info ] [MainThread]: [31m2 checks failed:[0m
[0m22:53:25.934419 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m22:53:25.934419 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('28000', "[28000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Login failed for user ''. (18456) (SQLDriverConnect); [28000] [Microsoft][ODBC Driver 17 for SQL Server]Invalid connection string attribute (0); [28000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Login failed for user ''. (18456); [28000] [Microsoft][ODBC Driver 17 for SQL Server]Invalid connection string attribute (0)")

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m22:53:25.934419 [debug] [MainThread]: Command `dbt debug` failed at 22:53:25.934419 after 4.46 seconds
[0m22:53:25.934419 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:53:25.934419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA427DF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA5B00F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA3273BD0>]}
[0m22:53:25.934419 [debug] [MainThread]: Flushing usage events
[0m22:53:33.318595 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:11:29.194651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE2DA6CFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE2B252DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE2DB9BC10>]}


============================== 23:11:29.194651 | 93e6dbf5-d5c0-486f-b9f0-c0b025d5052a ==============================
[0m23:11:29.194651 [info ] [MainThread]: Running with dbt=1.10.9
[0m23:11:29.194651 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m23:11:29.222059 [info ] [MainThread]: dbt version: 1.10.9
[0m23:11:29.223063 [info ] [MainThread]: python version: 3.11.0
[0m23:11:29.223737 [info ] [MainThread]: python path: C:\Users\Administrator\Documents\health-readmission-case\.venv\Scripts\python.exe
[0m23:11:29.224741 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m23:11:29.450696 [info ] [MainThread]: Using profiles dir at C:\Users\Administrator\.dbt
[0m23:11:29.450696 [info ] [MainThread]: Using profiles.yml file at C:\Users\Administrator\.dbt\profiles.yml
[0m23:11:29.450696 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\dbt_project.yml
[0m23:11:29.450696 [info ] [MainThread]: adapter type: sqlserver
[0m23:11:29.450696 [info ] [MainThread]: adapter version: 1.9.0
[0m23:11:29.531967 [info ] [MainThread]: Configuration:
[0m23:11:29.532679 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:11:29.533762 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:11:29.533762 [info ] [MainThread]: Required dependencies:
[0m23:11:29.534953 [debug] [MainThread]: Executing "git --help"
[0m23:11:29.540620 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m23:11:29.540620 [info ] [MainThread]: Connection:
[0m23:11:29.541620 [info ] [MainThread]:   server: DESKTOP-DUU3C7T
[0m23:11:29.541620 [info ] [MainThread]:   database: ReadmitDB
[0m23:11:29.542621 [info ] [MainThread]:   schema: dbo
[0m23:11:29.542621 [info ] [MainThread]:   UID: dbt_user
[0m23:11:29.543621 [info ] [MainThread]:   client_id: None
[0m23:11:29.543621 [info ] [MainThread]:   authentication: sql
[0m23:11:29.544621 [info ] [MainThread]:   encrypt: True
[0m23:11:29.544621 [info ] [MainThread]:   trust_cert: True
[0m23:11:29.544621 [info ] [MainThread]:   retries: 3
[0m23:11:29.544621 [info ] [MainThread]:   login_timeout: 0
[0m23:11:29.544621 [info ] [MainThread]:   query_timeout: 0
[0m23:11:29.544621 [info ] [MainThread]:   trace_flag: False
[0m23:11:29.544621 [info ] [MainThread]:   port: 1433
[0m23:11:29.547361 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m23:11:29.703180 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m23:11:29.703180 [debug] [MainThread]: Using sqlserver connection "debug"
[0m23:11:29.703180 [debug] [MainThread]: On debug: select 1 as id
[0m23:11:29.703180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:11:29.703180 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T,1433;Database=ReadmitDB;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m23:11:45.468791 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
3 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')
[0m23:11:46.476786 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T,1433;Database=ReadmitDB;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m23:12:02.195839 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
2 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')
[0m23:12:03.198599 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T,1433;Database=ReadmitDB;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m23:12:18.900455 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')
[0m23:12:19.903247 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T,1433;Database=ReadmitDB;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m23:12:35.596514 [debug] [MainThread]: fabric adapter: Error running SQL: select 1 as id
[0m23:12:35.596514 [debug] [MainThread]: fabric adapter: Rolling back transaction.
[0m23:12:35.596514 [debug] [MainThread]: On debug: No close available on handle
[0m23:12:35.627699 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m23:12:35.627699 [info ] [MainThread]: [31m2 checks failed:[0m
[0m23:12:35.627699 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m23:12:35.627699 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m23:12:35.632862 [debug] [MainThread]: Command `dbt debug` failed at 23:12:35.632862 after 66.54 seconds
[0m23:12:35.632862 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:12:35.632862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE2DBB3ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE2DB9B150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE2F29DE10>]}
[0m23:12:35.632862 [debug] [MainThread]: Flushing usage events
[0m23:12:37.784745 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:25:24.137737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272ABECFE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272ABC31010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272ABE92190>]}


============================== 23:25:24.137737 | f722a791-dcc6-4e32-8456-d648f417aae4 ==============================
[0m23:25:24.137737 [info ] [MainThread]: Running with dbt=1.10.9
[0m23:25:24.137737 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m23:25:24.153351 [info ] [MainThread]: dbt version: 1.10.9
[0m23:25:24.161560 [info ] [MainThread]: python version: 3.11.0
[0m23:25:24.161560 [info ] [MainThread]: python path: C:\Users\Administrator\Documents\health-readmission-case\.venv\Scripts\python.exe
[0m23:25:24.162565 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m23:25:24.340652 [info ] [MainThread]: Using profiles dir at C:\Users\Administrator\.dbt
[0m23:25:24.340652 [info ] [MainThread]: Using profiles.yml file at C:\Users\Administrator\.dbt\profiles.yml
[0m23:25:24.340652 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\dbt_project.yml
[0m23:25:24.340652 [info ] [MainThread]: adapter type: sqlserver
[0m23:25:24.340652 [info ] [MainThread]: adapter version: 1.9.0
[0m23:25:24.412249 [info ] [MainThread]: Configuration:
[0m23:25:24.412249 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:25:24.412249 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:25:24.412249 [info ] [MainThread]: Required dependencies:
[0m23:25:24.412249 [debug] [MainThread]: Executing "git --help"
[0m23:25:24.412249 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m23:25:24.412249 [info ] [MainThread]: Connection:
[0m23:25:24.412249 [info ] [MainThread]:   server: DESKTOP-DUU3C7T
[0m23:25:24.412249 [info ] [MainThread]:   database: ReadmitDB
[0m23:25:24.412249 [info ] [MainThread]:   schema: dbo
[0m23:25:24.427759 [info ] [MainThread]:   UID: DESKTOP-DUU3C7T\Administrator
[0m23:25:24.428171 [info ] [MainThread]:   client_id: None
[0m23:25:24.428171 [info ] [MainThread]:   authentication: sql
[0m23:25:24.429212 [info ] [MainThread]:   encrypt: True
[0m23:25:24.429785 [info ] [MainThread]:   trust_cert: True
[0m23:25:24.429785 [info ] [MainThread]:   retries: 3
[0m23:25:24.429785 [info ] [MainThread]:   login_timeout: 0
[0m23:25:24.429785 [info ] [MainThread]:   query_timeout: 0
[0m23:25:24.429785 [info ] [MainThread]:   trace_flag: False
[0m23:25:24.429785 [info ] [MainThread]:   port: 1433
[0m23:25:24.429785 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m23:25:24.576882 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m23:25:24.576882 [debug] [MainThread]: Using sqlserver connection "debug"
[0m23:25:24.576882 [debug] [MainThread]: On debug: select 1 as id
[0m23:25:24.576882 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:25:24.576882 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T,1433;Database=ReadmitDB;UID={DESKTOP-DUU3C7T\Administrator};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m23:25:40.302514 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
3 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')
[0m23:25:41.307704 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T,1433;Database=ReadmitDB;UID={DESKTOP-DUU3C7T\Administrator};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m23:25:57.061791 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
2 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')
[0m23:25:58.066920 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T,1433;Database=ReadmitDB;UID={DESKTOP-DUU3C7T\Administrator};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m23:26:13.811570 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')
[0m23:26:14.812980 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T,1433;Database=ReadmitDB;UID={DESKTOP-DUU3C7T\Administrator};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m23:26:30.575595 [debug] [MainThread]: fabric adapter: Error running SQL: select 1 as id
[0m23:26:30.576978 [debug] [MainThread]: fabric adapter: Rolling back transaction.
[0m23:26:30.578100 [debug] [MainThread]: On debug: No close available on handle
[0m23:26:30.579024 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m23:26:30.581423 [info ] [MainThread]: [31m2 checks failed:[0m
[0m23:26:30.583453 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m23:26:30.584403 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m23:26:30.587715 [debug] [MainThread]: Command `dbt debug` failed at 23:26:30.587715 after 66.53 seconds
[0m23:26:30.588733 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:26:30.590717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272A51BA390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272A51BA310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272AD5DC810>]}
[0m23:26:30.593717 [debug] [MainThread]: Flushing usage events
[0m23:26:35.727024 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:03:10.958727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002076869AE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020768707810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020768707150>]}


============================== 00:03:10.967314 | a81986a8-720c-456d-b167-7bf09679f726 ==============================
[0m00:03:10.967314 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:03:10.967314 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'profiles_dir': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk', 'static_parser': 'True', 'write_json': 'True'}
[0m00:03:10.985576 [info ] [MainThread]: dbt version: 1.10.9
[0m00:03:10.985576 [info ] [MainThread]: python version: 3.11.0
[0m00:03:10.989864 [info ] [MainThread]: python path: C:\Users\Administrator\Documents\health-readmission-case\.venv\Scripts\python.exe
[0m00:03:10.990930 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m00:03:11.238776 [info ] [MainThread]: Using profiles dir at C:\Users\Administrator\Documents\health-readmission-case\readmit_risk
[0m00:03:11.238776 [info ] [MainThread]: Using profiles.yml file at C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\profiles.yml
[0m00:03:11.238776 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\dbt_project.yml
[0m00:03:11.238776 [info ] [MainThread]: adapter type: sqlserver
[0m00:03:11.249849 [info ] [MainThread]: adapter version: 1.9.0
[0m00:03:11.343242 [info ] [MainThread]: Configuration:
[0m00:03:11.343242 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:03:11.343242 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:03:11.343242 [info ] [MainThread]: Required dependencies:
[0m00:03:11.349745 [debug] [MainThread]: Executing "git --help"
[0m00:03:11.349745 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m00:03:11.349745 [info ] [MainThread]: Connection:
[0m00:03:11.349745 [info ] [MainThread]:   server: DESKTOP-DUU3C7T
[0m00:03:11.349745 [info ] [MainThread]:   database: ReadmitDB
[0m00:03:11.349745 [info ] [MainThread]:   schema: dbo
[0m00:03:11.358029 [info ] [MainThread]:   UID: dbt_users
[0m00:03:11.358488 [info ] [MainThread]:   client_id: None
[0m00:03:11.358488 [info ] [MainThread]:   authentication: sql
[0m00:03:11.361081 [info ] [MainThread]:   encrypt: True
[0m00:03:11.361081 [info ] [MainThread]:   trust_cert: True
[0m00:03:11.361081 [info ] [MainThread]:   retries: 3
[0m00:03:11.361081 [info ] [MainThread]:   login_timeout: 0
[0m00:03:11.361081 [info ] [MainThread]:   query_timeout: 0
[0m00:03:11.361081 [info ] [MainThread]:   trace_flag: False
[0m00:03:11.361081 [info ] [MainThread]:   port: 1433
[0m00:03:11.361081 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m00:03:11.548163 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m00:03:11.548163 [debug] [MainThread]: Using sqlserver connection "debug"
[0m00:03:11.548163 [debug] [MainThread]: On debug: select 1 as id
[0m00:03:11.548163 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:03:11.548163 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m00:03:27.288604 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
3 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')
[0m00:03:28.291300 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m00:03:43.987963 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
2 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')
[0m00:03:44.990990 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m00:04:00.718253 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')
[0m00:04:01.720447 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m00:04:17.436949 [debug] [MainThread]: fabric adapter: Error running SQL: select 1 as id
[0m00:04:17.436949 [debug] [MainThread]: fabric adapter: Rolling back transaction.
[0m00:04:17.436949 [debug] [MainThread]: On debug: No close available on handle
[0m00:04:17.436949 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m00:04:17.436949 [info ] [MainThread]: [31m2 checks failed:[0m
[0m00:04:17.436949 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m00:04:17.436949 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m00:04:17.450524 [debug] [MainThread]: Command `dbt debug` failed at 00:04:17.450524 after 66.59 seconds
[0m00:04:17.456136 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:04:17.456593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207619EA310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207619EA250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207676B7510>]}
[0m00:04:17.458647 [debug] [MainThread]: Flushing usage events
[0m00:04:18.956194 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:06:31.386433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CFB343D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CFB1D5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CFB47AF10>]}


============================== 00:06:31.386433 | d7e72ca8-7138-4337-bbcc-425b3354ef49 ==============================
[0m00:06:31.386433 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:06:31.386433 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m00:06:31.418701 [info ] [MainThread]: dbt version: 1.10.9
[0m00:06:31.418701 [info ] [MainThread]: python version: 3.11.0
[0m00:06:31.418701 [info ] [MainThread]: python path: C:\Users\Administrator\Documents\health-readmission-case\.venv\Scripts\python.exe
[0m00:06:31.418701 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m00:06:31.677159 [info ] [MainThread]: Using profiles dir at C:\Users\Administrator\Documents\health-readmission-case\readmit_risk
[0m00:06:31.677159 [info ] [MainThread]: Using profiles.yml file at C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\profiles.yml
[0m00:06:31.677159 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\dbt_project.yml
[0m00:06:31.677159 [info ] [MainThread]: adapter type: sqlserver
[0m00:06:31.677159 [info ] [MainThread]: adapter version: 1.9.0
[0m00:06:31.789217 [info ] [MainThread]: Configuration:
[0m00:06:31.789217 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:06:31.789217 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:06:31.789217 [info ] [MainThread]: Required dependencies:
[0m00:06:31.789217 [debug] [MainThread]: Executing "git --help"
[0m00:06:31.789217 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m00:06:31.789217 [info ] [MainThread]: Connection:
[0m00:06:31.789217 [info ] [MainThread]:   server: DESKTOP-DUU3C7T
[0m00:06:31.801708 [info ] [MainThread]:   database: ReadmitDB
[0m00:06:31.803230 [info ] [MainThread]:   schema: dbo
[0m00:06:31.804082 [info ] [MainThread]:   UID: dbt_users
[0m00:06:31.804082 [info ] [MainThread]:   client_id: None
[0m00:06:31.804082 [info ] [MainThread]:   authentication: sql
[0m00:06:31.805532 [info ] [MainThread]:   encrypt: True
[0m00:06:31.805532 [info ] [MainThread]:   trust_cert: True
[0m00:06:31.807868 [info ] [MainThread]:   retries: 3
[0m00:06:31.807868 [info ] [MainThread]:   login_timeout: 0
[0m00:06:31.807868 [info ] [MainThread]:   query_timeout: 0
[0m00:06:31.807868 [info ] [MainThread]:   trace_flag: False
[0m00:06:31.807868 [info ] [MainThread]:   port: 1433
[0m00:06:31.807868 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m00:06:31.991881 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m00:06:31.991881 [debug] [MainThread]: Using sqlserver connection "debug"
[0m00:06:31.991881 [debug] [MainThread]: On debug: select 1 as id
[0m00:06:31.991881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:06:31.991881 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m00:06:47.692396 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
3 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')
[0m00:06:48.694349 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m00:07:04.458293 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
2 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')
[0m00:07:05.460528 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m00:07:21.222333 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')
[0m00:07:22.225092 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m00:07:37.974234 [debug] [MainThread]: fabric adapter: Error running SQL: select 1 as id
[0m00:07:37.974234 [debug] [MainThread]: fabric adapter: Rolling back transaction.
[0m00:07:37.974234 [debug] [MainThread]: On debug: No close available on handle
[0m00:07:37.974234 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m00:07:37.982235 [info ] [MainThread]: [31m2 checks failed:[0m
[0m00:07:37.982654 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m00:07:37.982654 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m00:07:37.990293 [debug] [MainThread]: Command `dbt debug` failed at 00:07:37.990013 after 66.70 seconds
[0m00:07:37.992113 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:07:37.992113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CFB47B150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CF47AA410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CF47AA310>]}
[0m00:07:37.992113 [debug] [MainThread]: Flushing usage events
[0m00:07:39.194016 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:08:20.357286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F7082AD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F7082AC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F7082B990>]}


============================== 01:08:20.357286 | 1a05b18a-35af-4d00-b58a-c784b0b6d093 ==============================
[0m01:08:20.357286 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:08:20.357286 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m01:08:20.391659 [info ] [MainThread]: dbt version: 1.10.9
[0m01:08:20.391659 [info ] [MainThread]: python version: 3.11.0
[0m01:08:20.401110 [info ] [MainThread]: python path: C:\Users\Administrator\Documents\health-readmission-case\.venv\Scripts\python.exe
[0m01:08:20.401934 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m01:08:20.740717 [info ] [MainThread]: Using profiles dir at C:\Users\Administrator\.dbt
[0m01:08:20.740717 [info ] [MainThread]: Using profiles.yml file at C:\Users\Administrator\.dbt\profiles.yml
[0m01:08:20.743583 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\dbt_project.yml
[0m01:08:20.743583 [info ] [MainThread]: adapter type: sqlserver
[0m01:08:20.745379 [info ] [MainThread]: adapter version: 1.9.0
[0m01:08:20.862015 [info ] [MainThread]: Configuration:
[0m01:08:20.862015 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:08:20.862015 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:08:20.862015 [info ] [MainThread]: Required dependencies:
[0m01:08:20.862015 [debug] [MainThread]: Executing "git --help"
[0m01:08:20.926050 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:08:20.926050 [debug] [MainThread]: STDERR: "b''"
[0m01:08:20.929534 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:08:20.929534 [info ] [MainThread]: Connection:
[0m01:08:20.929534 [info ] [MainThread]:   server: DESKTOP-DUU3C7T
[0m01:08:20.929534 [info ] [MainThread]:   database: ReadmitDB
[0m01:08:20.934044 [info ] [MainThread]:   schema: dbo
[0m01:08:20.934044 [info ] [MainThread]:   UID: dbt_users
[0m01:08:20.934044 [info ] [MainThread]:   client_id: None
[0m01:08:20.934044 [info ] [MainThread]:   authentication: sql
[0m01:08:20.937268 [info ] [MainThread]:   encrypt: True
[0m01:08:20.937268 [info ] [MainThread]:   trust_cert: True
[0m01:08:20.937268 [info ] [MainThread]:   retries: 3
[0m01:08:20.941128 [info ] [MainThread]:   login_timeout: 0
[0m01:08:20.941705 [info ] [MainThread]:   query_timeout: 0
[0m01:08:20.941705 [info ] [MainThread]:   trace_flag: False
[0m01:08:20.941705 [info ] [MainThread]:   port: 1433
[0m01:08:20.941705 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m01:08:21.171263 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m01:08:21.171263 [debug] [MainThread]: Using sqlserver connection "debug"
[0m01:08:21.171263 [debug] [MainThread]: On debug: select 1 as id
[0m01:08:21.171263 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:08:21.171263 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m01:08:36.950596 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
3 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')
[0m01:08:37.952742 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m01:08:53.727301 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
2 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')
[0m01:08:54.729289 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m01:09:10.501755 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')
[0m01:09:11.504630 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=DESKTOP-DUU3C7T,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m01:09:27.255986 [debug] [MainThread]: fabric adapter: Error running SQL: select 1 as id
[0m01:09:27.255986 [debug] [MainThread]: fabric adapter: Rolling back transaction.
[0m01:09:27.255986 [debug] [MainThread]: On debug: No close available on handle
[0m01:09:27.261022 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m01:09:27.261022 [info ] [MainThread]: [31m1 check failed:[0m
[0m01:09:27.262914 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m01:09:27.265987 [debug] [MainThread]: Command `dbt debug` failed at 01:09:27.265987 after 67.01 seconds
[0m01:09:27.265987 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:09:27.270145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F707F9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F69C0A310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F69C0A710>]}
[0m01:09:27.270659 [debug] [MainThread]: Flushing usage events
[0m01:09:28.576101 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:22:06.967686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74DBEA890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74DC1F850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74DBE9050>]}


============================== 01:22:06.967686 | 895889ee-d20d-45e9-9ea4-a4caf724d36c ==============================
[0m01:22:06.967686 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:22:06.967686 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m01:22:07.018769 [info ] [MainThread]: dbt version: 1.10.9
[0m01:22:07.018769 [info ] [MainThread]: python version: 3.11.0
[0m01:22:07.024078 [info ] [MainThread]: python path: C:\Users\Administrator\Documents\health-readmission-case\.venv\Scripts\python.exe
[0m01:22:07.024078 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m01:22:07.389909 [info ] [MainThread]: Using profiles dir at C:\Users\Administrator\.dbt
[0m01:22:07.389909 [info ] [MainThread]: Using profiles.yml file at C:\Users\Administrator\.dbt\profiles.yml
[0m01:22:07.389909 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\dbt_project.yml
[0m01:22:07.389909 [info ] [MainThread]: adapter type: sqlserver
[0m01:22:07.389909 [info ] [MainThread]: adapter version: 1.9.0
[0m01:22:07.518301 [info ] [MainThread]: Configuration:
[0m01:22:07.518301 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:22:07.518301 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:22:07.518301 [info ] [MainThread]: Required dependencies:
[0m01:22:07.518301 [debug] [MainThread]: Executing "git --help"
[0m01:22:07.573150 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:22:07.573150 [debug] [MainThread]: STDERR: "b''"
[0m01:22:07.573150 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:22:07.573150 [info ] [MainThread]: Connection:
[0m01:22:07.573150 [info ] [MainThread]:   server: localhost
[0m01:22:07.573150 [info ] [MainThread]:   database: ReadmitDB
[0m01:22:07.581959 [info ] [MainThread]:   schema: dbo
[0m01:22:07.582685 [info ] [MainThread]:   UID: dbt_users
[0m01:22:07.585499 [info ] [MainThread]:   client_id: None
[0m01:22:07.585499 [info ] [MainThread]:   authentication: sql
[0m01:22:07.585499 [info ] [MainThread]:   encrypt: True
[0m01:22:07.585499 [info ] [MainThread]:   trust_cert: False
[0m01:22:07.590027 [info ] [MainThread]:   retries: 3
[0m01:22:07.590027 [info ] [MainThread]:   login_timeout: 0
[0m01:22:07.590027 [info ] [MainThread]:   query_timeout: 0
[0m01:22:07.590027 [info ] [MainThread]:   trace_flag: False
[0m01:22:07.590027 [info ] [MainThread]:   port: 1433
[0m01:22:07.590027 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m01:22:07.806738 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m01:22:07.806738 [debug] [MainThread]: Using sqlserver connection "debug"
[0m01:22:07.806738 [debug] [MainThread]: On debug: select 1 as id
[0m01:22:07.822824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:22:07.823521 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m01:22:07.860695 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
3 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]SSL Provider: The certificate chain was issued by an authority that is not trusted.\r\n (-2146893019) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Client unable to establish connection (-2146893019)')
[0m01:22:08.864756 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m01:22:08.877565 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
2 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]SSL Provider: The certificate chain was issued by an authority that is not trusted.\r\n (-2146893019) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Client unable to establish connection (-2146893019)')
[0m01:22:09.878972 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m01:22:09.893101 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]SSL Provider: The certificate chain was issued by an authority that is not trusted.\r\n (-2146893019) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Client unable to establish connection (-2146893019)')
[0m01:22:10.895206 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m01:22:10.903887 [debug] [MainThread]: fabric adapter: Error running SQL: select 1 as id
[0m01:22:10.903887 [debug] [MainThread]: fabric adapter: Rolling back transaction.
[0m01:22:10.903887 [debug] [MainThread]: On debug: No close available on handle
[0m01:22:10.903887 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m01:22:10.903887 [info ] [MainThread]: [31m1 check failed:[0m
[0m01:22:10.910897 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]SSL Provider: The certificate chain was issued by an authority that is not trusted.\r\n (-2146893019) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Client unable to establish connection (-2146893019)')

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m01:22:10.910897 [debug] [MainThread]: Command `dbt debug` failed at 01:22:10.910897 after 4.06 seconds
[0m01:22:10.910897 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:22:10.910897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74F3C79D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E746F6A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E746F6A310>]}
[0m01:22:10.910897 [debug] [MainThread]: Flushing usage events
[0m01:22:12.250870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:29:34.695022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0CA6B0A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0CDBD3FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0CDCC5E90>]}


============================== 01:29:34.695022 | 927dd0dd-afca-41e5-9f52-eb950b44aef8 ==============================
[0m01:29:34.695022 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:29:34.695022 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m01:29:34.724604 [info ] [MainThread]: dbt version: 1.10.9
[0m01:29:34.724604 [info ] [MainThread]: python version: 3.11.0
[0m01:29:34.734157 [info ] [MainThread]: python path: C:\Users\Administrator\Documents\health-readmission-case\.venv\Scripts\python.exe
[0m01:29:34.735044 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m01:29:35.036706 [info ] [MainThread]: Using profiles dir at C:\Users\Administrator\.dbt
[0m01:29:35.036706 [info ] [MainThread]: Using profiles.yml file at C:\Users\Administrator\.dbt\profiles.yml
[0m01:29:35.036706 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\dbt_project.yml
[0m01:29:35.036706 [info ] [MainThread]: adapter type: sqlserver
[0m01:29:35.036706 [info ] [MainThread]: adapter version: 1.9.0
[0m01:29:35.180486 [info ] [MainThread]: Configuration:
[0m01:29:35.180486 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:29:35.180486 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:29:35.180486 [info ] [MainThread]: Required dependencies:
[0m01:29:35.180486 [debug] [MainThread]: Executing "git --help"
[0m01:29:35.223522 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:29:35.223522 [debug] [MainThread]: STDERR: "b''"
[0m01:29:35.223522 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:29:35.223522 [info ] [MainThread]: Connection:
[0m01:29:35.223522 [info ] [MainThread]:   server: localhost
[0m01:29:35.223522 [info ] [MainThread]:   database: ReadmitDB
[0m01:29:35.223522 [info ] [MainThread]:   schema: dbo
[0m01:29:35.223522 [info ] [MainThread]:   UID: dbt_users
[0m01:29:35.223522 [info ] [MainThread]:   client_id: None
[0m01:29:35.238786 [info ] [MainThread]:   authentication: sql
[0m01:29:35.238786 [info ] [MainThread]:   encrypt: False
[0m01:29:35.238786 [info ] [MainThread]:   trust_cert: True
[0m01:29:35.238786 [info ] [MainThread]:   retries: 3
[0m01:29:35.238786 [info ] [MainThread]:   login_timeout: 0
[0m01:29:35.242862 [info ] [MainThread]:   query_timeout: 0
[0m01:29:35.243319 [info ] [MainThread]:   trace_flag: False
[0m01:29:35.243319 [info ] [MainThread]:   port: 1433
[0m01:29:35.246092 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m01:29:35.471898 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m01:29:35.471898 [debug] [MainThread]: Using sqlserver connection "debug"
[0m01:29:35.471898 [debug] [MainThread]: On debug: select 1 as id
[0m01:29:35.471898 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:29:35.471898 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m01:29:35.552756 [debug] [MainThread]: sqlserver adapter: Connected to db: ReadmitDB
[0m01:29:35.567765 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:29:35.567765 [debug] [MainThread]: On debug: Close
[0m01:29:35.567765 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:29:35.567765 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:29:35.567765 [debug] [MainThread]: Command `dbt debug` succeeded at 01:29:35.567765 after 1.00 seconds
[0m01:29:35.567765 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:29:35.567765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0CDC99610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0CDC98910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0CDC9BE90>]}
[0m01:29:35.567765 [debug] [MainThread]: Flushing usage events
[0m01:29:36.637115 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:35:57.723484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF2D13550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF2CCBF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF2CC8E10>]}


============================== 02:35:57.723484 | 186b202d-a50b-4542-a037-68ec30cd9522 ==============================
[0m02:35:57.723484 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:35:57.723484 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt seed', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'None', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m02:35:58.276477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '186b202d-a50b-4542-a037-68ec30cd9522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF2CC93D0>]}
[0m02:35:58.339479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '186b202d-a50b-4542-a037-68ec30cd9522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF45CBC10>]}
[0m02:35:58.339479 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m02:35:58.680798 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:35:58.680798 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:35:58.693166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '186b202d-a50b-4542-a037-68ec30cd9522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF4446710>]}
[0m02:36:01.959762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '186b202d-a50b-4542-a037-68ec30cd9522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF247E0D0>]}
[0m02:36:02.006693 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m02:36:02.040659 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m02:36:02.103623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '186b202d-a50b-4542-a037-68ec30cd9522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF2CFB190>]}
[0m02:36:02.103623 [info ] [MainThread]: Found 510 macros
[0m02:36:02.103623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '186b202d-a50b-4542-a037-68ec30cd9522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF48BFF10>]}
[0m02:36:02.103623 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:36:02.103623 [debug] [MainThread]: Command end result
[0m02:36:02.134435 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m02:36:02.134435 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m02:36:02.149502 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m02:36:02.150737 [info ] [MainThread]: 
[0m02:36:02.150737 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:36:02.150737 [info ] [MainThread]: 
[0m02:36:02.150737 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=0
[0m02:36:02.155423 [debug] [MainThread]: Command `dbt seed` succeeded at 02:36:02.155423 after 4.53 seconds
[0m02:36:02.155423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF2D5BF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF2CC8810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF29A79D0>]}
[0m02:36:02.157834 [debug] [MainThread]: Flushing usage events
[0m02:36:03.325162 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:38:11.553832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B68946C7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B68959B050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B68959B990>]}


============================== 02:38:11.554835 | 37f9c511-61e0-432d-af55-3dd4eeb12978 ==============================
[0m02:38:11.554835 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:38:11.554835 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'printer_width': '80', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m02:38:11.991246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37f9c511-61e0-432d-af55-3dd4eeb12978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B68AC9C3D0>]}
[0m02:38:12.066093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37f9c511-61e0-432d-af55-3dd4eeb12978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B688567B90>]}
[0m02:38:12.066093 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m02:38:12.313101 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:38:12.544790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m02:38:12.544790 [debug] [MainThread]: Partial parsing: added file: readmit_risk://seeds\pharmacy.csv
[0m02:38:12.553090 [debug] [MainThread]: Partial parsing: added file: readmit_risk://seeds\patients.csv
[0m02:38:12.553090 [debug] [MainThread]: Partial parsing: added file: readmit_risk://seeds\claims.csv
[0m02:38:12.554002 [debug] [MainThread]: Partial parsing: added file: readmit_risk://seeds\labs.csv
[0m02:38:12.554002 [debug] [MainThread]: Partial parsing: added file: readmit_risk://seeds\admissions.csv
[0m02:38:12.858501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37f9c511-61e0-432d-af55-3dd4eeb12978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B68B127E50>]}
[0m02:38:12.917458 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m02:38:12.917458 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m02:38:12.949120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37f9c511-61e0-432d-af55-3dd4eeb12978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B68B34C910>]}
[0m02:38:12.955611 [info ] [MainThread]: Found 5 seeds, 510 macros
[0m02:38:12.957119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f9c511-61e0-432d-af55-3dd4eeb12978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B68B2A8C10>]}
[0m02:38:12.965228 [info ] [MainThread]: 
[0m02:38:12.965228 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:38:12.965228 [info ] [MainThread]: 
[0m02:38:12.965228 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m02:38:12.981839 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB'
[0m02:38:12.998946 [debug] [ThreadPool]: dbt-sqlserver
[0m02:38:12.998946 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB"
[0m02:38:12.998946 [debug] [ThreadPool]: On list_ReadmitDB: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB"} */
USE [ReadmitDB];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m02:38:12.998946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:38:12.998946 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m02:38:13.120944 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m02:38:13.137755 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:38:13.137755 [debug] [ThreadPool]: On list_ReadmitDB: Close
[0m02:38:13.137755 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m02:38:13.154020 [debug] [ThreadPool]: dbt-sqlserver
[0m02:38:13.154020 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m02:38:13.154020 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m02:38:13.154020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:38:13.154020 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m02:38:13.154020 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m02:38:13.228358 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:38:13.228358 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m02:38:13.228358 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m02:38:13.236630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f9c511-61e0-432d-af55-3dd4eeb12978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B68B2F8B90>]}
[0m02:38:13.236630 [debug] [MainThread]: On master: COMMIT
[0m02:38:13.269601 [debug] [Thread-1 (]: Began running node seed.readmit_risk.admissions
[0m02:38:13.277991 [info ] [Thread-1 (]: 1 of 5 START seed file dbo.admissions .......................................... [RUN]
[0m02:38:13.277991 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'seed.readmit_risk.admissions'
[0m02:38:13.277991 [debug] [Thread-1 (]: Began compiling node seed.readmit_risk.admissions
[0m02:38:13.277991 [debug] [Thread-1 (]: Began executing node seed.readmit_risk.admissions
[0m02:38:13.832657 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:13.832657 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "seed.readmit_risk.admissions"} */

    create table "ReadmitDB"."dbo"."admissions" ("admission_id" int,"patient_id" int,"admit_date" date,"discharge_date" date,"length_of_stay" int,"department" varchar(16),"primary_icd10" varchar(16),"payer" varchar(16),"age" int,"prior_admissions" int,"telehealth_followup" int,"nurse_call" int,"home_monitor" int,"readmitted_30d" int,"readmit_date" date)
  
[0m02:38:13.832657 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:38:13.832657 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m02:38:13.839992 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m02:38:13.848938 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:13.865014 [debug] [Thread-1 (]: Inserting batches of 139 records
[0m02:38:14.318148 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:14.318148 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:14.638387 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:15.065009 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:15.065009 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:15.352407 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:15.769360 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:15.769360 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:16.060083 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:16.468189 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:16.468189 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:16.747081 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:17.164140 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:17.164140 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:17.449778 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:17.887779 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:17.887779 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:18.161627 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:18.586381 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:18.586381 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:18.857110 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:19.282049 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:19.282049 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:19.556367 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:19.989041 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:19.989041 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:20.264373 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:20.701362 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:20.701362 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:20.966422 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:21.388328 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:21.388328 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:21.663820 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:22.083410 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:22.083410 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:22.352132 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:22.780720 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:22.780720 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:23.059518 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:23.492816 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:23.492816 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:23.764083 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:24.188588 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:24.188588 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:24.467254 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:24.920358 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:24.921020 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:25.203707 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:25.625868 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:25.625868 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:25.899711 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:26.312766 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:26.312766 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:26.600057 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:27.043898 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:27.043898 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:27.387959 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:27.829956 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:27.829956 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:28.156300 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:28.626648 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:28.626648 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:28.951646 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:29.427901 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:29.427901 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:29.744705 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:30.205667 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:30.205667 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:30.550304 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:30.986627 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:30.986627 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:31.317907 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:31.748482 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:31.748482 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:32.021769 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:32.514907 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:32.514907 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:32.862507 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:33.298075 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:33.298075 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:33.579377 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:34.010677 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:34.010677 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:34.286401 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:34.725812 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:34.725812 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:34.999512 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:35.458789 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:35.458789 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:35.732353 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:36.220546 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:36.220546 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:36.493106 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:36.901391 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:36.901391 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:37.173689 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:37.589373 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:37.589373 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:37.872531 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:38.304495 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:38.304998 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:38.583925 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:38.797013 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.admissions"
[0m02:38:38.797013 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: 
          insert into "ReadmitDB"."dbo"."admissions" ("admission_id", "patient_id", "admit_date", "discharge_date", "length_of_stay", "department", "primary_icd10", "payer", "age", "prior_admissions", "telehealth_followup", "nurse_call", "home_monitor", "readmitted_30d", "readmit_date") values
          (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?...
[0m02:38:38.894739 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:38.902869 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.readmit_risk.admissions"
[0m02:38:38.928009 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: COMMIT
[0m02:38:38.928009 [debug] [Thread-1 (]: On seed.readmit_risk.admissions: Close
[0m02:38:38.935614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f9c511-61e0-432d-af55-3dd4eeb12978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B68BA785D0>]}
[0m02:38:38.936659 [info ] [Thread-1 (]: 1 of 5 OK loaded seed file dbo.admissions ...................................... [[32mINSERT 4796[0m in 25.65s]
[0m02:38:38.936659 [debug] [Thread-1 (]: Finished running node seed.readmit_risk.admissions
[0m02:38:38.936659 [debug] [Thread-1 (]: Began running node seed.readmit_risk.claims
[0m02:38:38.939674 [info ] [Thread-1 (]: 2 of 5 START seed file dbo.claims .............................................. [RUN]
[0m02:38:38.939674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.readmit_risk.admissions, now seed.readmit_risk.claims)
[0m02:38:38.939674 [debug] [Thread-1 (]: Began compiling node seed.readmit_risk.claims
[0m02:38:38.942009 [debug] [Thread-1 (]: Began executing node seed.readmit_risk.claims
[0m02:38:39.361752 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:39.361752 [debug] [Thread-1 (]: On seed.readmit_risk.claims: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "seed.readmit_risk.claims"} */

    create table "ReadmitDB"."dbo"."claims" ("claim_id" varchar(36),"admission_id" int,"patient_id" int,"procedure_code" varchar(16),"amount_billed" float,"amount_paid" float,"approved" int)
  
[0m02:38:39.361752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:38:39.361752 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m02:38:39.369348 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m02:38:39.377828 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:39.386833 [debug] [Thread-1 (]: Inserting batches of 299 records
[0m02:38:39.829059 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:39.829059 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:40.003238 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:40.436905 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:40.436905 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:40.597041 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:41.034942 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:41.034942 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:41.187055 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:41.626946 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:41.634946 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:41.793124 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:42.248843 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:42.248843 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:42.416323 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:42.849242 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:42.849242 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:43.012408 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:43.440075 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:43.440075 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:43.609973 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:44.038767 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:44.046271 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:44.194374 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:44.627662 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:44.627662 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:44.792916 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:45.226872 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:45.226872 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:45.398720 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:45.833817 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:45.833817 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:46.010929 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:46.443092 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:46.443092 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:46.607295 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:47.050516 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:47.050516 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:47.198638 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:47.632473 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:47.632473 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:47.784086 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:48.226602 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:48.226602 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:48.382217 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:48.809680 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:48.809680 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:48.974286 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:49.409046 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:49.409046 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:49.566078 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:50.000068 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:50.000068 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:50.158256 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:50.600200 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:50.600200 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:50.759391 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:51.186586 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:51.186586 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:51.382462 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:51.821887 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:51.821887 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:51.988572 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:52.497369 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:52.505432 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:52.736719 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:53.204901 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:53.204901 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:53.382857 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:53.837941 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:53.837941 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:54.003590 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:54.434381 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:54.434381 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:54.592299 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:55.022761 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:55.023266 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:55.180818 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:55.638750 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:55.638750 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:55.826009 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:56.258940 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:56.258940 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:56.422471 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:56.871772 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:56.871772 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:57.032349 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:57.463662 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:57.463662 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:57.619177 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:58.068866 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:58.068866 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:58.228448 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:58.673835 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:58.673835 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?...
[0m02:38:58.837951 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:58.837951 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.claims"
[0m02:38:58.837951 [debug] [Thread-1 (]: On seed.readmit_risk.claims: 
          insert into "ReadmitDB"."dbo"."claims" ("claim_id", "admission_id", "patient_id", "procedure_code", "amount_billed", "amount_paid", "approved") values
          (?,?,?,?,?,?,?),(?,?,?,?,?,?,?),(?,?,?,?,?,?,?)
      ...
[0m02:38:58.846018 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:58.846018 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.readmit_risk.claims"
[0m02:38:58.854277 [debug] [Thread-1 (]: On seed.readmit_risk.claims: COMMIT
[0m02:38:58.854277 [debug] [Thread-1 (]: On seed.readmit_risk.claims: Close
[0m02:38:58.854277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f9c511-61e0-432d-af55-3dd4eeb12978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B68B12EE90>]}
[0m02:38:58.854277 [info ] [Thread-1 (]: 2 of 5 OK loaded seed file dbo.claims .......................................... [[32mINSERT 9571[0m in 19.91s]
[0m02:38:58.854277 [debug] [Thread-1 (]: Finished running node seed.readmit_risk.claims
[0m02:38:58.854277 [debug] [Thread-1 (]: Began running node seed.readmit_risk.labs
[0m02:38:58.854277 [info ] [Thread-1 (]: 3 of 5 START seed file dbo.labs ................................................ [RUN]
[0m02:38:58.854277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.readmit_risk.claims, now seed.readmit_risk.labs)
[0m02:38:58.854277 [debug] [Thread-1 (]: Began compiling node seed.readmit_risk.labs
[0m02:38:58.861785 [debug] [Thread-1 (]: Began executing node seed.readmit_risk.labs
[0m02:38:59.542036 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:38:59.550328 [debug] [Thread-1 (]: On seed.readmit_risk.labs: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "seed.readmit_risk.labs"} */

    create table "ReadmitDB"."dbo"."labs" ("lab_id" varchar(36),"admission_id" int,"patient_id" int,"lab_date" date,"glucose_mgdl" float,"hba1c_pct" float,"creatinine_mgdl" float,"systolic_bp" int)
  
[0m02:38:59.550328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:38:59.550328 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m02:38:59.550328 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m02:38:59.560555 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:38:59.566880 [debug] [Thread-1 (]: Inserting batches of 262 records
[0m02:39:00.001697 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:00.001697 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:00.212287 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:00.636688 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:00.637776 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:00.813903 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:01.255539 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:01.255539 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:01.431054 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:01.852841 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:01.852841 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:02.035674 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:02.468499 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:02.468499 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:02.640673 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:03.099569 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:03.099749 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:03.271470 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:03.698333 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:03.698333 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:03.876938 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:04.321927 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:04.321927 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:04.506472 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:04.928285 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:04.936592 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:05.116216 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:05.526094 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:05.526094 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:05.703817 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:06.149188 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:06.149188 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:06.330233 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:06.780832 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:06.780832 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:06.948504 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:07.379380 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:07.387378 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:07.571337 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:07.994213 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:07.994213 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:08.175474 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:08.590613 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:08.598854 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:08.764137 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:09.190122 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:09.190122 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:09.363401 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:09.805930 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:09.814107 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:09.988072 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:10.423441 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:10.423441 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:10.597916 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:11.037251 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:11.037251 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:11.213391 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:11.642047 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:11.642047 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:11.825685 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:12.281908 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:12.281908 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:12.457356 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:12.889411 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:12.889411 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:13.088250 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:13.521879 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:13.521879 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:13.706195 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:14.136307 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:14.136307 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:14.322677 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:14.818343 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:14.826578 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:15.007326 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:15.456541 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:15.456541 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:15.620882 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:16.048195 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:16.048195 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:16.212334 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:16.662366 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:16.671015 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:16.832854 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:17.242930 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:17.250512 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:17.430741 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:17.861117 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:17.869355 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:18.035710 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:18.458867 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:18.467325 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:18.636433 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:19.071856 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:19.079465 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:19.247150 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:19.699533 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:19.699533 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:19.867925 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:20.303844 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:20.303844 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:20.481271 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:20.890588 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:20.890588 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:21.056703 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:21.486744 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:21.486744 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:21.664082 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:21.875393 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.labs"
[0m02:39:21.875393 [debug] [Thread-1 (]: On seed.readmit_risk.labs: 
          insert into "ReadmitDB"."dbo"."labs" ("lab_id", "admission_id", "patient_id", "lab_date", "glucose_mgdl", "hba1c_pct", "creatinine_mgdl", "systolic_bp") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,...
[0m02:39:21.949086 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:21.951097 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.readmit_risk.labs"
[0m02:39:21.951097 [debug] [Thread-1 (]: On seed.readmit_risk.labs: COMMIT
[0m02:39:21.951097 [debug] [Thread-1 (]: On seed.readmit_risk.labs: Close
[0m02:39:21.951097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f9c511-61e0-432d-af55-3dd4eeb12978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B68BC585D0>]}
[0m02:39:21.951097 [info ] [Thread-1 (]: 3 of 5 OK loaded seed file dbo.labs ............................................ [[32mINSERT 9568[0m in 23.10s]
[0m02:39:21.959183 [debug] [Thread-1 (]: Finished running node seed.readmit_risk.labs
[0m02:39:21.959975 [debug] [Thread-1 (]: Began running node seed.readmit_risk.patients
[0m02:39:21.959975 [info ] [Thread-1 (]: 4 of 5 START seed file dbo.patients ............................................ [RUN]
[0m02:39:21.959975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.readmit_risk.labs, now seed.readmit_risk.patients)
[0m02:39:21.959975 [debug] [Thread-1 (]: Began compiling node seed.readmit_risk.patients
[0m02:39:21.959975 [debug] [Thread-1 (]: Began executing node seed.readmit_risk.patients
[0m02:39:22.107896 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.patients"
[0m02:39:22.107896 [debug] [Thread-1 (]: On seed.readmit_risk.patients: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "seed.readmit_risk.patients"} */

    create table "ReadmitDB"."dbo"."patients" ("patient_id" int,"gender" varchar(16),"ethnicity" varchar(16),"smoker" int,"alcohol_use" int,"bmi" float,"ses_index" int,"birth_year" int)
  
[0m02:39:22.111937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:39:22.113053 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m02:39:22.113053 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m02:39:22.117227 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:22.117227 [debug] [Thread-1 (]: Inserting batches of 262 records
[0m02:39:22.545955 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.patients"
[0m02:39:22.545955 [debug] [Thread-1 (]: On seed.readmit_risk.patients: 
          insert into "ReadmitDB"."dbo"."patients" ("patient_id", "gender", "ethnicity", "smoker", "alcohol_use", "bmi", "ses_index", "birth_year") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?...
[0m02:39:22.700493 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:23.140794 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.patients"
[0m02:39:23.140794 [debug] [Thread-1 (]: On seed.readmit_risk.patients: 
          insert into "ReadmitDB"."dbo"."patients" ("patient_id", "gender", "ethnicity", "smoker", "alcohol_use", "bmi", "ses_index", "birth_year") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?...
[0m02:39:23.282823 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:23.728465 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.patients"
[0m02:39:23.728465 [debug] [Thread-1 (]: On seed.readmit_risk.patients: 
          insert into "ReadmitDB"."dbo"."patients" ("patient_id", "gender", "ethnicity", "smoker", "alcohol_use", "bmi", "ses_index", "birth_year") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?...
[0m02:39:23.875514 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:24.300594 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.patients"
[0m02:39:24.300594 [debug] [Thread-1 (]: On seed.readmit_risk.patients: 
          insert into "ReadmitDB"."dbo"."patients" ("patient_id", "gender", "ethnicity", "smoker", "alcohol_use", "bmi", "ses_index", "birth_year") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?...
[0m02:39:24.465968 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:24.874326 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.patients"
[0m02:39:24.874326 [debug] [Thread-1 (]: On seed.readmit_risk.patients: 
          insert into "ReadmitDB"."dbo"."patients" ("patient_id", "gender", "ethnicity", "smoker", "alcohol_use", "bmi", "ses_index", "birth_year") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?...
[0m02:39:25.024788 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:25.478002 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.patients"
[0m02:39:25.478533 [debug] [Thread-1 (]: On seed.readmit_risk.patients: 
          insert into "ReadmitDB"."dbo"."patients" ("patient_id", "gender", "ethnicity", "smoker", "alcohol_use", "bmi", "ses_index", "birth_year") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?...
[0m02:39:25.627887 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:26.041453 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.patients"
[0m02:39:26.041453 [debug] [Thread-1 (]: On seed.readmit_risk.patients: 
          insert into "ReadmitDB"."dbo"."patients" ("patient_id", "gender", "ethnicity", "smoker", "alcohol_use", "bmi", "ses_index", "birth_year") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?...
[0m02:39:26.195105 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:26.635064 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.patients"
[0m02:39:26.635064 [debug] [Thread-1 (]: On seed.readmit_risk.patients: 
          insert into "ReadmitDB"."dbo"."patients" ("patient_id", "gender", "ethnicity", "smoker", "alcohol_use", "bmi", "ses_index", "birth_year") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?...
[0m02:39:26.803796 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:27.230689 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.patients"
[0m02:39:27.230689 [debug] [Thread-1 (]: On seed.readmit_risk.patients: 
          insert into "ReadmitDB"."dbo"."patients" ("patient_id", "gender", "ethnicity", "smoker", "alcohol_use", "bmi", "ses_index", "birth_year") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?...
[0m02:39:27.379540 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:27.826240 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.patients"
[0m02:39:27.826240 [debug] [Thread-1 (]: On seed.readmit_risk.patients: 
          insert into "ReadmitDB"."dbo"."patients" ("patient_id", "gender", "ethnicity", "smoker", "alcohol_use", "bmi", "ses_index", "birth_year") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?...
[0m02:39:27.974053 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:28.397302 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.patients"
[0m02:39:28.397302 [debug] [Thread-1 (]: On seed.readmit_risk.patients: 
          insert into "ReadmitDB"."dbo"."patients" ("patient_id", "gender", "ethnicity", "smoker", "alcohol_use", "bmi", "ses_index", "birth_year") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?...
[0m02:39:28.551375 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:28.744608 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.patients"
[0m02:39:28.744608 [debug] [Thread-1 (]: On seed.readmit_risk.patients: 
          insert into "ReadmitDB"."dbo"."patients" ("patient_id", "gender", "ethnicity", "smoker", "alcohol_use", "bmi", "ses_index", "birth_year") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?...
[0m02:39:28.796283 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:28.796283 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.readmit_risk.patients"
[0m02:39:28.802292 [debug] [Thread-1 (]: On seed.readmit_risk.patients: COMMIT
[0m02:39:28.802292 [debug] [Thread-1 (]: On seed.readmit_risk.patients: Close
[0m02:39:28.802292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f9c511-61e0-432d-af55-3dd4eeb12978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B68BC33750>]}
[0m02:39:28.802292 [info ] [Thread-1 (]: 4 of 5 OK loaded seed file dbo.patients ........................................ [[32mINSERT 3000[0m in 6.84s]
[0m02:39:28.807602 [debug] [Thread-1 (]: Finished running node seed.readmit_risk.patients
[0m02:39:28.808603 [debug] [Thread-1 (]: Began running node seed.readmit_risk.pharmacy
[0m02:39:28.808603 [info ] [Thread-1 (]: 5 of 5 START seed file dbo.pharmacy ............................................ [RUN]
[0m02:39:28.810607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.readmit_risk.patients, now seed.readmit_risk.pharmacy)
[0m02:39:28.810607 [debug] [Thread-1 (]: Began compiling node seed.readmit_risk.pharmacy
[0m02:39:28.810607 [debug] [Thread-1 (]: Began executing node seed.readmit_risk.pharmacy
[0m02:39:29.154465 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:29.162676 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "seed.readmit_risk.pharmacy"} */

    create table "ReadmitDB"."dbo"."pharmacy" ("rx_id" varchar(36),"admission_id" int,"patient_id" int,"drug_name" varchar(16),"dose" varchar(16),"start_date" date,"days_supply" int,"adherence_rate" float)
  
[0m02:39:29.162676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:39:29.162676 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m02:39:29.162676 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m02:39:29.162676 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:29.170939 [debug] [Thread-1 (]: Inserting batches of 262 records
[0m02:39:29.599675 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:29.599675 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: 
          insert into "ReadmitDB"."dbo"."pharmacy" ("rx_id", "admission_id", "patient_id", "drug_name", "dose", "start_date", "days_supply", "adherence_rate") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,...
[0m02:39:29.767754 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:30.197544 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:30.197544 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: 
          insert into "ReadmitDB"."dbo"."pharmacy" ("rx_id", "admission_id", "patient_id", "drug_name", "dose", "start_date", "days_supply", "adherence_rate") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,...
[0m02:39:30.371461 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:30.804337 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:30.804871 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: 
          insert into "ReadmitDB"."dbo"."pharmacy" ("rx_id", "admission_id", "patient_id", "drug_name", "dose", "start_date", "days_supply", "adherence_rate") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,...
[0m02:39:30.977442 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:31.399240 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:31.399240 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: 
          insert into "ReadmitDB"."dbo"."pharmacy" ("rx_id", "admission_id", "patient_id", "drug_name", "dose", "start_date", "days_supply", "adherence_rate") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,...
[0m02:39:31.574666 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:32.013505 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:32.013505 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: 
          insert into "ReadmitDB"."dbo"."pharmacy" ("rx_id", "admission_id", "patient_id", "drug_name", "dose", "start_date", "days_supply", "adherence_rate") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,...
[0m02:39:32.176714 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:32.693913 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:32.693913 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: 
          insert into "ReadmitDB"."dbo"."pharmacy" ("rx_id", "admission_id", "patient_id", "drug_name", "dose", "start_date", "days_supply", "adherence_rate") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,...
[0m02:39:32.873924 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:33.317322 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:33.317322 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: 
          insert into "ReadmitDB"."dbo"."pharmacy" ("rx_id", "admission_id", "patient_id", "drug_name", "dose", "start_date", "days_supply", "adherence_rate") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,...
[0m02:39:33.491412 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:33.927169 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:33.927169 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: 
          insert into "ReadmitDB"."dbo"."pharmacy" ("rx_id", "admission_id", "patient_id", "drug_name", "dose", "start_date", "days_supply", "adherence_rate") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,...
[0m02:39:34.099468 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:34.543916 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:34.543916 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: 
          insert into "ReadmitDB"."dbo"."pharmacy" ("rx_id", "admission_id", "patient_id", "drug_name", "dose", "start_date", "days_supply", "adherence_rate") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,...
[0m02:39:34.715158 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:35.154941 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:35.163102 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: 
          insert into "ReadmitDB"."dbo"."pharmacy" ("rx_id", "admission_id", "patient_id", "drug_name", "dose", "start_date", "days_supply", "adherence_rate") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,...
[0m02:39:35.336166 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:35.753137 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:35.761397 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: 
          insert into "ReadmitDB"."dbo"."pharmacy" ("rx_id", "admission_id", "patient_id", "drug_name", "dose", "start_date", "days_supply", "adherence_rate") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,...
[0m02:39:35.920727 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:36.349343 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:36.349343 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: 
          insert into "ReadmitDB"."dbo"."pharmacy" ("rx_id", "admission_id", "patient_id", "drug_name", "dose", "start_date", "days_supply", "adherence_rate") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,...
[0m02:39:36.510744 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:36.955956 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:36.962452 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: 
          insert into "ReadmitDB"."dbo"."pharmacy" ("rx_id", "admission_id", "patient_id", "drug_name", "dose", "start_date", "days_supply", "adherence_rate") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,...
[0m02:39:37.142291 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:37.582060 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:37.583580 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: 
          insert into "ReadmitDB"."dbo"."pharmacy" ("rx_id", "admission_id", "patient_id", "drug_name", "dose", "start_date", "days_supply", "adherence_rate") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,...
[0m02:39:37.753178 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:38.220659 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:38.220659 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: 
          insert into "ReadmitDB"."dbo"."pharmacy" ("rx_id", "admission_id", "patient_id", "drug_name", "dose", "start_date", "days_supply", "adherence_rate") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,...
[0m02:39:38.434848 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:38.929525 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:38.929525 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: 
          insert into "ReadmitDB"."dbo"."pharmacy" ("rx_id", "admission_id", "patient_id", "drug_name", "dose", "start_date", "days_supply", "adherence_rate") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,...
[0m02:39:39.129381 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:39.559313 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:39.559313 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: 
          insert into "ReadmitDB"."dbo"."pharmacy" ("rx_id", "admission_id", "patient_id", "drug_name", "dose", "start_date", "days_supply", "adherence_rate") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,...
[0m02:39:39.723761 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:40.159827 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:40.159827 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: 
          insert into "ReadmitDB"."dbo"."pharmacy" ("rx_id", "admission_id", "patient_id", "drug_name", "dose", "start_date", "days_supply", "adherence_rate") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,...
[0m02:39:40.330346 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:40.781925 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:40.782283 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: 
          insert into "ReadmitDB"."dbo"."pharmacy" ("rx_id", "admission_id", "patient_id", "drug_name", "dose", "start_date", "days_supply", "adherence_rate") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,...
[0m02:39:40.953394 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:41.044350 [debug] [Thread-1 (]: Using sqlserver connection "seed.readmit_risk.pharmacy"
[0m02:39:41.044350 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: 
          insert into "ReadmitDB"."dbo"."pharmacy" ("rx_id", "admission_id", "patient_id", "drug_name", "dose", "start_date", "days_supply", "adherence_rate") values
          (?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,?,?,?),(?,?,?,?,?,...
[0m02:39:41.076290 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:39:41.077954 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.readmit_risk.pharmacy"
[0m02:39:41.077954 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: COMMIT
[0m02:39:41.077954 [debug] [Thread-1 (]: On seed.readmit_risk.pharmacy: Close
[0m02:39:41.077954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f9c511-61e0-432d-af55-3dd4eeb12978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B68BD205D0>]}
[0m02:39:41.077954 [info ] [Thread-1 (]: 5 of 5 OK loaded seed file dbo.pharmacy ........................................ [[32mINSERT 5035[0m in 12.27s]
[0m02:39:41.086136 [debug] [Thread-1 (]: Finished running node seed.readmit_risk.pharmacy
[0m02:39:41.086136 [debug] [MainThread]: On master: COMMIT
[0m02:39:41.086136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:39:41.086136 [debug] [MainThread]: Connection 'list_ReadmitDB' was properly closed.
[0m02:39:41.086136 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m02:39:41.086136 [debug] [MainThread]: Connection 'seed.readmit_risk.pharmacy' was properly closed.
[0m02:39:41.086136 [info ] [MainThread]: 
[0m02:39:41.086136 [info ] [MainThread]: Finished running 5 seeds in 0 hours 1 minutes and 28.12 seconds (88.12s).
[0m02:39:41.095399 [debug] [MainThread]: Command end result
[0m02:39:41.119472 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m02:39:41.127692 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m02:39:41.128530 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m02:39:41.135597 [info ] [MainThread]: 
[0m02:39:41.135597 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:39:41.137280 [info ] [MainThread]: 
[0m02:39:41.137280 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m02:39:41.139878 [debug] [MainThread]: Command `dbt seed` succeeded at 02:39:41.139878 after 89.68 seconds
[0m02:39:41.139878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6828CA350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6828CA190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6828CA090>]}
[0m02:39:41.139878 [debug] [MainThread]: Flushing usage events
[0m02:39:42.752894 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:34:32.354751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CC4CFF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CC499410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CC510210>]}


============================== 03:34:32.361995 | 7b9b9113-e755-4e0b-a5ce-2bdaf16e6b01 ==============================
[0m03:34:32.361995 [info ] [MainThread]: Running with dbt=1.10.9
[0m03:34:32.361995 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m03:34:32.892718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b9b9113-e755-4e0b-a5ce-2bdaf16e6b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CB615990>]}
[0m03:34:32.975885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b9b9113-e755-4e0b-a5ce-2bdaf16e6b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CC4F4E50>]}
[0m03:34:32.977020 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m03:34:33.210222 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m03:34:33.461952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m03:34:33.461952 [debug] [MainThread]: Partial parsing: added file: readmit_risk://models\staging\stg_claims.sql
[0m03:34:33.461952 [debug] [MainThread]: Partial parsing: added file: readmit_risk://models\staging\stg_labs.sql
[0m03:34:33.461952 [debug] [MainThread]: Partial parsing: added file: readmit_risk://models\staging\stg_patients.sql
[0m03:34:33.477657 [debug] [MainThread]: Partial parsing: added file: readmit_risk://models\staging\stg_admissions.sql
[0m03:34:33.477657 [debug] [MainThread]: Partial parsing: added file: readmit_risk://models\staging\stg_pharmacy.sql
[0m03:34:33.868342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b9b9113-e755-4e0b-a5ce-2bdaf16e6b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CE042A10>]}
[0m03:34:33.947025 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m03:34:33.965797 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m03:34:33.994473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b9b9113-e755-4e0b-a5ce-2bdaf16e6b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CDC1B150>]}
[0m03:34:33.994473 [info ] [MainThread]: Found 5 seeds, 5 models, 510 macros
[0m03:34:33.994473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b9b9113-e755-4e0b-a5ce-2bdaf16e6b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C9A9EA90>]}
[0m03:34:33.994473 [info ] [MainThread]: 
[0m03:34:33.994473 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:34:33.994473 [info ] [MainThread]: 
[0m03:34:33.994473 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m03:34:34.016728 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB'
[0m03:34:34.039111 [debug] [ThreadPool]: dbt-sqlserver
[0m03:34:34.039111 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB"
[0m03:34:34.039111 [debug] [ThreadPool]: On list_ReadmitDB: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB"} */
USE [ReadmitDB];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m03:34:34.039111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:34:34.039111 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m03:34:34.121042 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m03:34:34.138134 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:34:34.138134 [debug] [ThreadPool]: On list_ReadmitDB: Close
[0m03:34:34.138134 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m03:34:34.150295 [debug] [ThreadPool]: dbt-sqlserver
[0m03:34:34.150295 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m03:34:34.150295 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m03:34:34.158306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:34:34.158306 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m03:34:34.158306 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m03:34:34.214363 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:34:34.214363 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m03:34:34.214363 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m03:34:34.224805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b9b9113-e755-4e0b-a5ce-2bdaf16e6b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CC4E3D50>]}
[0m03:34:34.224805 [debug] [MainThread]: On master: COMMIT
[0m03:34:34.229310 [debug] [Thread-1 (]: Began running node model.readmit_risk.stg_admissions
[0m03:34:34.229310 [info ] [Thread-1 (]: 1 of 5 START sql view model dbo.stg_admissions ................................. [RUN]
[0m03:34:34.229310 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.readmit_risk.stg_admissions'
[0m03:34:34.235696 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.stg_admissions
[0m03:34:34.247154 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.stg_admissions"
[0m03:34:34.250177 [debug] [Thread-1 (]: Began executing node model.readmit_risk.stg_admissions
[0m03:34:34.301893 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.stg_admissions"
[0m03:34:34.301893 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.stg_admissions"
[0m03:34:34.301893 [debug] [Thread-1 (]: On model.readmit_risk.stg_admissions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.stg_admissions"} */
USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."stg_admissions__dbt_tmp" as 

-- stg_admissions: normalize dates, compute length_of_stay if missing
with raw as (
  select
    try_cast(admission_id as int) as admission_id,
    try_cast(patient_id as int)   as patient_id,
    try_cast(admit_date as date)  as admit_date,
    try_cast(discharge_date as date) as discharge_date,
    try_cast(length_of_stay as int) as length_of_stay_raw,
    nullif(ltrim(rtrim(department)), '''') as department,
    upper(nullif(ltrim(rtrim(primary_icd10)), '''')) as primary_icd10,
    nullif(ltrim(rtrim(payer)), '''') as payer,
    try_cast(age as int) as age,
    try_cast(prior_admissions as int) as prior_admissions,
    try_cast(telehealth_followup as int) as telehealth_followup,
    try_cast(nurse_call as int) as nurse_call,
    try_cast(home_monitor as int) as home_monitor,
    try_cast(readmitted_30d as int) as readmitted_30d,
    try_cast(readmit_date as date) as readmit_date
  from "ReadmitDB"."dbo"."admissions"
)

select
  admission_id,
  patient_id,
  admit_date,
  discharge_date,
  -- if length_of_stay exists use it, otherwise compute via dates
  coalesce(length_of_stay_raw,
           case 
             when admit_date is not null and discharge_date is not null
             then datediff(day, admit_date, discharge_date)
             else null
           end) as length_of_stay,
  department,
  primary_icd10,
  payer,
  age,
  prior_admissions,
  telehealth_followup,
  nurse_call,
  home_monitor,
  readmitted_30d,
  readmit_date,
  -- derived: days to readmit (null if none)
  case 
    when readmit_date is not null and discharge_date is not null 
    then datediff(day, discharge_date, readmit_date) 
    else null 
  end as days_to_readmit,
  -- derived flag: readmitted within 30 days (safe fallback to readmitted_30d if present)
  case
    when readmitted_30d is not null then readmitted_30d
    when datediff(day, discharge_date, readmit_date) <= 30 then 1
    else 0
  end as readmitted_within_30
from raw
;;
    ')


[0m03:34:34.301893 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:34:34.301893 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m03:34:34.301893 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m03:34:34.317074 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:34:34.325184 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.stg_admissions"
[0m03:34:34.325184 [debug] [Thread-1 (]: On model.readmit_risk.stg_admissions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.stg_admissions"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.stg_admissions__dbt_tmp', 'stg_admissions'
[0m03:34:34.640355 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:34:34.655995 [debug] [Thread-1 (]: On model.readmit_risk.stg_admissions: COMMIT
[0m03:34:34.672426 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."stg_admissions__dbt_backup"
[0m03:34:34.683126 [debug] [Thread-1 (]: dbt-sqlserver
[0m03:34:34.683126 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.stg_admissions"
[0m03:34:34.683126 [debug] [Thread-1 (]: On model.readmit_risk.stg_admissions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.stg_admissions"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_admissions__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m03:34:34.722268 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:34:34.733026 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.stg_admissions"
[0m03:34:34.733026 [debug] [Thread-1 (]: On model.readmit_risk.stg_admissions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.stg_admissions"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."stg_admissions__dbt_backup";');

[0m03:34:34.733026 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:34:34.733026 [debug] [Thread-1 (]: On model.readmit_risk.stg_admissions: ROLLBACK
[0m03:34:34.733026 [debug] [Thread-1 (]: On model.readmit_risk.stg_admissions: Close
[0m03:34:34.740611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b9b9113-e755-4e0b-a5ce-2bdaf16e6b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CE344F50>]}
[0m03:34:34.740611 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbo.stg_admissions ............................ [[32mOK[0m in 0.51s]
[0m03:34:34.740611 [debug] [Thread-1 (]: Finished running node model.readmit_risk.stg_admissions
[0m03:34:34.744982 [debug] [Thread-1 (]: Began running node model.readmit_risk.stg_claims
[0m03:34:34.744982 [info ] [Thread-1 (]: 2 of 5 START sql view model dbo.stg_claims ..................................... [RUN]
[0m03:34:34.744982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.stg_admissions, now model.readmit_risk.stg_claims)
[0m03:34:34.744982 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.stg_claims
[0m03:34:34.750665 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.stg_claims"
[0m03:34:34.750665 [debug] [Thread-1 (]: Began executing node model.readmit_risk.stg_claims
[0m03:34:34.757954 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.stg_claims"
[0m03:34:34.757954 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.stg_claims"
[0m03:34:34.757954 [debug] [Thread-1 (]: On model.readmit_risk.stg_claims: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.stg_claims"} */
USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."stg_claims__dbt_tmp" as 

-- stg_claims: amounts to numeric, standardize codes
select
  nullif(ltrim(rtrim(claim_id)), '''')                       as claim_id,
  try_cast(admission_id as int)                            as admission_id,
  try_cast(patient_id as int)                              as patient_id,
  nullif(ltrim(rtrim(procedure_code)), '''')                 as procedure_code,
  try_cast(amount_billed  as decimal(12,2))                as amount_billed,
  try_cast(amount_paid    as decimal(12,2))                as amount_paid,
  try_cast(approved as int)                                as approved,
  -- derived: claim coverage ratio (avoid divide by zero)
  case when try_cast(amount_billed as decimal(12,2)) is not null and try_cast(amount_billed as decimal(12,2)) <> 0
       then try_cast(amount_paid as decimal(12,2)) / try_cast(amount_billed as decimal(12,2))
       else null end as paid_ratio
from "ReadmitDB"."dbo"."claims"
;;
    ')


[0m03:34:34.757954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:34:34.757954 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m03:34:34.757954 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m03:34:34.767432 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:34:34.767432 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.stg_claims"
[0m03:34:34.767432 [debug] [Thread-1 (]: On model.readmit_risk.stg_claims: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.stg_claims"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.stg_claims__dbt_tmp', 'stg_claims'
[0m03:34:34.767432 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:34:34.767432 [debug] [Thread-1 (]: On model.readmit_risk.stg_claims: COMMIT
[0m03:34:34.781851 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."stg_claims__dbt_backup"
[0m03:34:34.781851 [debug] [Thread-1 (]: dbt-sqlserver
[0m03:34:34.785553 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.stg_claims"
[0m03:34:34.785617 [debug] [Thread-1 (]: On model.readmit_risk.stg_claims: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.stg_claims"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_claims__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m03:34:34.802035 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:34:34.802035 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.stg_claims"
[0m03:34:34.802035 [debug] [Thread-1 (]: On model.readmit_risk.stg_claims: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.stg_claims"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."stg_claims__dbt_backup";');

[0m03:34:34.802035 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:34:34.802035 [debug] [Thread-1 (]: On model.readmit_risk.stg_claims: ROLLBACK
[0m03:34:34.802035 [debug] [Thread-1 (]: On model.readmit_risk.stg_claims: Close
[0m03:34:34.815543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b9b9113-e755-4e0b-a5ce-2bdaf16e6b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CEA314D0>]}
[0m03:34:34.816554 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbo.stg_claims ................................ [[32mOK[0m in 0.06s]
[0m03:34:34.816554 [debug] [Thread-1 (]: Finished running node model.readmit_risk.stg_claims
[0m03:34:34.816554 [debug] [Thread-1 (]: Began running node model.readmit_risk.stg_labs
[0m03:34:34.816554 [info ] [Thread-1 (]: 3 of 5 START sql view model dbo.stg_labs ....................................... [RUN]
[0m03:34:34.816554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.stg_claims, now model.readmit_risk.stg_labs)
[0m03:34:34.816554 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.stg_labs
[0m03:34:34.826249 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.stg_labs"
[0m03:34:34.826249 [debug] [Thread-1 (]: Began executing node model.readmit_risk.stg_labs
[0m03:34:34.832984 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.stg_labs"
[0m03:34:34.834286 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.stg_labs"
[0m03:34:34.834286 [debug] [Thread-1 (]: On model.readmit_risk.stg_labs: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.stg_labs"} */
USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."stg_labs__dbt_tmp" as 

-- stg_labs: latest lab per admission is suitable for staging; cast numeric values
select
  nullif(ltrim(rtrim(lab_id)), '''')                        as lab_id,
  try_cast(admission_id as int)                           as admission_id,
  try_cast(patient_id as int)                             as patient_id,
  try_cast(lab_date as date)                              as lab_date,
  try_cast(glucose_mgdl as float)                         as glucose_mgdl,
  try_cast(hba1c_pct as float)                            as hba1c_pct,
  try_cast(creatinine_mgdl as float)                      as creatinine_mgdl,
  try_cast(systolic_bp as int)                            as systolic_bp,
  -- simple abnormal flags (adjust thresholds as you prefer)
  case when try_cast(glucose_mgdl as float) > 180 then 1 else 0 end as high_glucose_flag,
  case when try_cast(hba1c_pct as float) > 8.0 then 1 else 0 end as high_hba1c_flag,
  case when try_cast(creatinine_mgdl as float) > 1.5 then 1 else 0 end as high_creatinine_flag,
  case when try_cast(systolic_bp as int) > 160 then 1 else 0 end as high_sbp_flag
from "ReadmitDB"."dbo"."labs"
;;
    ')


[0m03:34:34.834286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:34:34.834286 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m03:34:34.834286 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m03:34:34.834286 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:34:34.834286 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.stg_labs"
[0m03:34:34.847868 [debug] [Thread-1 (]: On model.readmit_risk.stg_labs: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.stg_labs"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.stg_labs__dbt_tmp', 'stg_labs'
[0m03:34:34.849648 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:34:34.849648 [debug] [Thread-1 (]: On model.readmit_risk.stg_labs: COMMIT
[0m03:34:34.856156 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."stg_labs__dbt_backup"
[0m03:34:34.856156 [debug] [Thread-1 (]: dbt-sqlserver
[0m03:34:34.856156 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.stg_labs"
[0m03:34:34.856156 [debug] [Thread-1 (]: On model.readmit_risk.stg_labs: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.stg_labs"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_labs__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m03:34:34.873388 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:34:34.883480 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.stg_labs"
[0m03:34:34.883480 [debug] [Thread-1 (]: On model.readmit_risk.stg_labs: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.stg_labs"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."stg_labs__dbt_backup";');

[0m03:34:34.883480 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:34:34.889188 [debug] [Thread-1 (]: On model.readmit_risk.stg_labs: ROLLBACK
[0m03:34:34.889188 [debug] [Thread-1 (]: On model.readmit_risk.stg_labs: Close
[0m03:34:34.889188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b9b9113-e755-4e0b-a5ce-2bdaf16e6b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CE275310>]}
[0m03:34:34.889188 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbo.stg_labs .................................. [[32mOK[0m in 0.07s]
[0m03:34:34.889188 [debug] [Thread-1 (]: Finished running node model.readmit_risk.stg_labs
[0m03:34:34.889188 [debug] [Thread-1 (]: Began running node model.readmit_risk.stg_patients
[0m03:34:34.889188 [info ] [Thread-1 (]: 4 of 5 START sql view model dbo.stg_patients ................................... [RUN]
[0m03:34:34.895996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.stg_labs, now model.readmit_risk.stg_patients)
[0m03:34:34.895996 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.stg_patients
[0m03:34:34.902130 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.stg_patients"
[0m03:34:34.902130 [debug] [Thread-1 (]: Began executing node model.readmit_risk.stg_patients
[0m03:34:34.907302 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.stg_patients"
[0m03:34:34.907302 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.stg_patients"
[0m03:34:34.907302 [debug] [Thread-1 (]: On model.readmit_risk.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.stg_patients"} */
USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."stg_patients__dbt_tmp" as 

-- stg_patients: clean basic types and normalize text
select
  try_cast(patient_id as int)                                as patient_id,
  nullif(ltrim(rtrim(gender)), '''')                           as gender,
  nullif(ltrim(rtrim(ethnicity)), '''')                        as ethnicity,
  try_cast(smoker as int)                                    as smoker,
  try_cast(alcohol_use as int)                               as alcohol_use,
  try_cast(bmi as float)                                     as bmi,
  try_cast(ses_index as int)                                 as ses_index,
  try_cast(birth_year as int)                                as birth_year,
  -- approximate current age (useful if no birthdate available)
  (datepart(year, getdate()) - try_cast(birth_year as int))  as age_estimate
from "ReadmitDB"."dbo"."patients"
;;
    ')


[0m03:34:34.907302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:34:34.907302 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m03:34:34.907302 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m03:34:34.917798 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:34:34.917798 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.stg_patients"
[0m03:34:34.917798 [debug] [Thread-1 (]: On model.readmit_risk.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.stg_patients"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.stg_patients__dbt_tmp', 'stg_patients'
[0m03:34:34.933313 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:34:34.935864 [debug] [Thread-1 (]: On model.readmit_risk.stg_patients: COMMIT
[0m03:34:34.935864 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."stg_patients__dbt_backup"
[0m03:34:34.941000 [debug] [Thread-1 (]: dbt-sqlserver
[0m03:34:34.941051 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.stg_patients"
[0m03:34:34.941051 [debug] [Thread-1 (]: On model.readmit_risk.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.stg_patients"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_patients__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m03:34:34.950905 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:34:34.965410 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.stg_patients"
[0m03:34:34.966319 [debug] [Thread-1 (]: On model.readmit_risk.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.stg_patients"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."stg_patients__dbt_backup";');

[0m03:34:34.967135 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:34:34.968640 [debug] [Thread-1 (]: On model.readmit_risk.stg_patients: ROLLBACK
[0m03:34:34.968640 [debug] [Thread-1 (]: On model.readmit_risk.stg_patients: Close
[0m03:34:34.968640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b9b9113-e755-4e0b-a5ce-2bdaf16e6b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CEA9A190>]}
[0m03:34:34.968640 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbo.stg_patients .............................. [[32mOK[0m in 0.07s]
[0m03:34:34.973655 [debug] [Thread-1 (]: Finished running node model.readmit_risk.stg_patients
[0m03:34:34.973655 [debug] [Thread-1 (]: Began running node model.readmit_risk.stg_pharmacy
[0m03:34:34.973655 [info ] [Thread-1 (]: 5 of 5 START sql view model dbo.stg_pharmacy ................................... [RUN]
[0m03:34:34.973655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.stg_patients, now model.readmit_risk.stg_pharmacy)
[0m03:34:34.973655 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.stg_pharmacy
[0m03:34:34.973655 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.stg_pharmacy"
[0m03:34:34.981658 [debug] [Thread-1 (]: Began executing node model.readmit_risk.stg_pharmacy
[0m03:34:34.983101 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.stg_pharmacy"
[0m03:34:34.983101 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.stg_pharmacy"
[0m03:34:34.983101 [debug] [Thread-1 (]: On model.readmit_risk.stg_pharmacy: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.stg_pharmacy"} */
USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."stg_pharmacy__dbt_tmp" as 

-- stg_pharmacy: normalize prescriptions + numeric fields
select
  nullif(ltrim(rtrim(rx_id)), '''')                           as rx_id,
  try_cast(admission_id as int)                             as admission_id,
  try_cast(patient_id as int)                               as patient_id,
  nullif(ltrim(rtrim(drug_name)), '''')                       as drug_name,
  nullif(ltrim(rtrim(dose)), '''')                            as dose,
  try_cast(start_date as date)                              as start_date,
  try_cast(days_supply as int)                              as days_supply,
  try_cast(adherence_rate as float)                         as adherence_rate,
  -- derived: expected end date of supply
  case when try_cast(start_date as date) is not null and try_cast(days_supply as int) is not null
       then dateadd(day, try_cast(days_supply as int), try_cast(start_date as date))
       else null end as expected_supply_end_date
from "ReadmitDB"."dbo"."pharmacy"
;;
    ')


[0m03:34:34.983101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:34:34.990139 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m03:34:34.990139 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m03:34:34.991991 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:34:35.001404 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.stg_pharmacy"
[0m03:34:35.001888 [debug] [Thread-1 (]: On model.readmit_risk.stg_pharmacy: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.stg_pharmacy"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.stg_pharmacy__dbt_tmp', 'stg_pharmacy'
[0m03:34:35.003446 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:34:35.003446 [debug] [Thread-1 (]: On model.readmit_risk.stg_pharmacy: COMMIT
[0m03:34:35.003446 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."stg_pharmacy__dbt_backup"
[0m03:34:35.014454 [debug] [Thread-1 (]: dbt-sqlserver
[0m03:34:35.014454 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.stg_pharmacy"
[0m03:34:35.015411 [debug] [Thread-1 (]: On model.readmit_risk.stg_pharmacy: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.stg_pharmacy"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_pharmacy__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m03:34:35.036132 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:34:35.038150 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.stg_pharmacy"
[0m03:34:35.038150 [debug] [Thread-1 (]: On model.readmit_risk.stg_pharmacy: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.stg_pharmacy"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."stg_pharmacy__dbt_backup";');

[0m03:34:35.038150 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:34:35.038150 [debug] [Thread-1 (]: On model.readmit_risk.stg_pharmacy: ROLLBACK
[0m03:34:35.038150 [debug] [Thread-1 (]: On model.readmit_risk.stg_pharmacy: Close
[0m03:34:35.038150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b9b9113-e755-4e0b-a5ce-2bdaf16e6b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CEA8F510>]}
[0m03:34:35.038150 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbo.stg_pharmacy .............................. [[32mOK[0m in 0.06s]
[0m03:34:35.046164 [debug] [Thread-1 (]: Finished running node model.readmit_risk.stg_pharmacy
[0m03:34:35.046164 [debug] [MainThread]: On master: COMMIT
[0m03:34:35.046164 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:34:35.046164 [debug] [MainThread]: Connection 'list_ReadmitDB' was properly closed.
[0m03:34:35.050883 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m03:34:35.050883 [debug] [MainThread]: Connection 'model.readmit_risk.stg_pharmacy' was properly closed.
[0m03:34:35.050883 [info ] [MainThread]: 
[0m03:34:35.050883 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m03:34:35.055208 [debug] [MainThread]: Command end result
[0m03:34:35.084666 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m03:34:35.084666 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m03:34:35.091304 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m03:34:35.091304 [info ] [MainThread]: 
[0m03:34:35.091304 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:34:35.091304 [info ] [MainThread]: 
[0m03:34:35.102664 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m03:34:35.104086 [debug] [MainThread]: Command `dbt run` succeeded at 03:34:35.104086 after 2.90 seconds
[0m03:34:35.104086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CC5263D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CC525B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C5B01090>]}
[0m03:34:35.104086 [debug] [MainThread]: Flushing usage events
[0m03:34:40.736710 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:36:56.164012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6C277E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6C281C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6C281AD0>]}


============================== 14:36:56.164012 | 38809a32-65a3-460b-9f47-0956a11de8be ==============================
[0m14:36:56.164012 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:36:56.164012 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select path:models/core/patients_enriched.sql', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:36:59.503570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38809a32-65a3-460b-9f47-0956a11de8be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6C277C50>]}
[0m14:36:59.549823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38809a32-65a3-460b-9f47-0956a11de8be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6C2DCC90>]}
[0m14:36:59.549823 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:36:59.842763 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:37:01.902159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 8 files added, 0 files changed.
[0m14:37:01.902159 [debug] [MainThread]: Partial parsing: added file: readmit_risk://models\core\pharmacy_agg.sql
[0m14:37:01.902159 [debug] [MainThread]: Partial parsing: added file: readmit_risk://models\core\admissions_enriched.sql
[0m14:37:01.902159 [debug] [MainThread]: Partial parsing: added file: readmit_risk://models\core\features_ml.sql
[0m14:37:01.902159 [debug] [MainThread]: Partial parsing: added file: readmit_risk://models\core\labs_latest.sql
[0m14:37:01.902159 [debug] [MainThread]: Partial parsing: added file: readmit_risk://models\core\claims_agg.sql
[0m14:37:01.902159 [debug] [MainThread]: Partial parsing: added file: readmit_risk://models\core\dim_patient.sql
[0m14:37:01.902159 [debug] [MainThread]: Partial parsing: added file: readmit_risk://models\core\fact_readmissions.sql
[0m14:37:01.902159 [debug] [MainThread]: Partial parsing: added file: readmit_risk://models\core\patients_enriched.sql
[0m14:37:02.152612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38809a32-65a3-460b-9f47-0956a11de8be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6DAE9E10>]}
[0m14:37:02.199092 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m14:37:02.214714 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m14:37:02.245857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38809a32-65a3-460b-9f47-0956a11de8be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6C210A10>]}
[0m14:37:02.245857 [info ] [MainThread]: Found 5 seeds, 13 models, 510 macros
[0m14:37:02.245857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38809a32-65a3-460b-9f47-0956a11de8be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6DB693D0>]}
[0m14:37:02.245857 [info ] [MainThread]: 
[0m14:37:02.261582 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:37:02.261582 [info ] [MainThread]: 
[0m14:37:02.263562 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:37:02.265709 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB'
[0m14:37:02.269032 [debug] [ThreadPool]: dbt-sqlserver
[0m14:37:02.269032 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB"
[0m14:37:02.269032 [debug] [ThreadPool]: On list_ReadmitDB: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB"} */
USE [ReadmitDB];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:37:02.269032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:02.269032 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:37:02.385078 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:37:02.416263 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:37:02.416263 [debug] [ThreadPool]: On list_ReadmitDB: Close
[0m14:37:02.431943 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m14:37:02.431943 [debug] [ThreadPool]: dbt-sqlserver
[0m14:37:02.431943 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m14:37:02.431943 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:37:02.431943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:02.431943 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:37:02.431943 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:37:02.526283 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:37:02.542091 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m14:37:02.542091 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m14:37:02.542091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38809a32-65a3-460b-9f47-0956a11de8be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6DDA72D0>]}
[0m14:37:02.542091 [debug] [MainThread]: On master: COMMIT
[0m14:37:02.561260 [debug] [Thread-1 (]: Began running node model.readmit_risk.patients_enriched
[0m14:37:02.562158 [info ] [Thread-1 (]: 1 of 1 START sql table model dbo.patients_enriched ............................. [RUN]
[0m14:37:02.562158 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.readmit_risk.patients_enriched'
[0m14:37:02.562158 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.patients_enriched
[0m14:37:02.562158 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.patients_enriched"
[0m14:37:02.562158 [debug] [Thread-1 (]: Began executing node model.readmit_risk.patients_enriched
[0m14:37:02.602367 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:37:02.604176 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."patients_enriched__dbt_tmp__dbt_tmp_vw"
[0m14:37:02.604176 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:37:02.604176 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.patients_enriched"
[0m14:37:02.604176 [debug] [Thread-1 (]: On model.readmit_risk.patients_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.patients_enriched"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'patients_enriched__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:37:02.604176 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:37:02.604176 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:37:02.604176 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:37:02.653965 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:37:02.653965 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.patients_enriched"
[0m14:37:02.653965 [debug] [Thread-1 (]: On model.readmit_risk.patients_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.patients_enriched"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."patients_enriched__dbt_tmp__dbt_tmp_vw";');

[0m14:37:02.653965 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:37:02.681288 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.patients_enriched"
[0m14:37:02.683223 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.patients_enriched"
[0m14:37:02.683223 [debug] [Thread-1 (]: On model.readmit_risk.patients_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.patients_enriched"} */

  
    USE [ReadmitDB];
    USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."patients_enriched__dbt_tmp__dbt_tmp_vw" as 

select
  patient_id,
  gender,
  ethnicity,
  smoker,
  alcohol_use,
  bmi,
  ses_index,
  birth_year,
  -- approximate age now
  (year(getdate()) - try_cast(birth_year as int)) as age,
  case
    when ses_index is not null and ses_index < 35 then ''low''
    when ses_index is not null and ses_index >= 35 and ses_index < 65 then ''mid''
    when ses_index is not null and ses_index >= 65 then ''high''
    else null end as ses_group
from "ReadmitDB"."dbo"."stg_patients"
;;
    ')

EXEC('
            SELECT * INTO "ReadmitDB"."dbo"."patients_enriched__dbt_tmp" FROM "ReadmitDB"."dbo"."patients_enriched__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.patients_enriched__dbt_tmp__dbt_tmp_vw')



    
    use [ReadmitDB];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_patients_enriched__dbt_tmp_cci'
        AND object_id=object_id('dbo_patients_enriched__dbt_tmp')
    )
    DROP index "dbo"."patients_enriched__dbt_tmp".dbo_patients_enriched__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_patients_enriched__dbt_tmp_cci
    ON "dbo"."patients_enriched__dbt_tmp"

   


  
[0m14:37:02.873451 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:37:02.873451 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.patients_enriched"
[0m14:37:02.873451 [debug] [Thread-1 (]: On model.readmit_risk.patients_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.patients_enriched"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.patients_enriched__dbt_tmp', 'patients_enriched'
[0m14:37:03.391136 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m14:37:03.406982 [debug] [Thread-1 (]: On model.readmit_risk.patients_enriched: COMMIT
[0m14:37:03.406982 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."patients_enriched__dbt_backup"
[0m14:37:03.406982 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.patients_enriched"
[0m14:37:03.406982 [debug] [Thread-1 (]: On model.readmit_risk.patients_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.patients_enriched"} */

      
    USE [ReadmitDB];
    EXEC('DROP table IF EXISTS "dbo"."patients_enriched__dbt_backup";');

[0m14:37:03.422697 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:37:03.422697 [debug] [Thread-1 (]: On model.readmit_risk.patients_enriched: Close
[0m14:37:03.422697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38809a32-65a3-460b-9f47-0956a11de8be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6E143850>]}
[0m14:37:03.422697 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbo.patients_enriched ........................ [[32mOK[0m in 0.86s]
[0m14:37:03.422697 [debug] [Thread-1 (]: Finished running node model.readmit_risk.patients_enriched
[0m14:37:03.422697 [debug] [MainThread]: On master: COMMIT
[0m14:37:03.422697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:03.422697 [debug] [MainThread]: Connection 'list_ReadmitDB' was properly closed.
[0m14:37:03.422697 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m14:37:03.422697 [debug] [MainThread]: Connection 'model.readmit_risk.patients_enriched' was properly closed.
[0m14:37:03.422697 [info ] [MainThread]: 
[0m14:37:03.422697 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m14:37:03.435556 [debug] [MainThread]: Command end result
[0m14:37:03.455271 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m14:37:03.457252 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m14:37:03.459467 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m14:37:03.459467 [info ] [MainThread]: 
[0m14:37:03.459467 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:37:03.459467 [info ] [MainThread]: 
[0m14:37:03.459467 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:37:03.459467 [debug] [MainThread]: Command `dbt run` succeeded at 14:37:03.459467 after 7.40 seconds
[0m14:37:03.459467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6C297ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6559A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6559A250>]}
[0m14:37:03.459467 [debug] [MainThread]: Flushing usage events
[0m14:37:07.561733 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:15.229070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D90A0BE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D90A0BBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D90A10E50>]}


============================== 14:39:15.229070 | 83bf2f1a-6f62-47c7-8af9-2ae6178f30f5 ==============================
[0m14:39:15.229070 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:39:15.229070 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select path:models/core/admissions_enriched.sql', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt'}
[0m14:39:15.574099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83bf2f1a-6f62-47c7-8af9-2ae6178f30f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D909A2910>]}
[0m14:39:15.620968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83bf2f1a-6f62-47c7-8af9-2ae6178f30f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D8F9D7C50>]}
[0m14:39:15.620968 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:39:15.791512 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:39:15.947721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:39:15.947721 [debug] [MainThread]: Partial parsing: updated file: readmit_risk://models\core\admissions_enriched.sql
[0m14:39:16.195466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83bf2f1a-6f62-47c7-8af9-2ae6178f30f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9277AB10>]}
[0m14:39:16.245088 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m14:39:16.245088 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m14:39:16.278458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83bf2f1a-6f62-47c7-8af9-2ae6178f30f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9224DAD0>]}
[0m14:39:16.278458 [info ] [MainThread]: Found 5 seeds, 13 models, 510 macros
[0m14:39:16.293506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83bf2f1a-6f62-47c7-8af9-2ae6178f30f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D92789D10>]}
[0m14:39:16.295150 [info ] [MainThread]: 
[0m14:39:16.295150 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:39:16.295150 [info ] [MainThread]: 
[0m14:39:16.295150 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:39:16.295150 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB'
[0m14:39:16.311283 [debug] [ThreadPool]: dbt-sqlserver
[0m14:39:16.311979 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB"
[0m14:39:16.311979 [debug] [ThreadPool]: On list_ReadmitDB: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB"} */
USE [ReadmitDB];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:39:16.313033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:16.313033 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:39:16.411632 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:39:16.411632 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:39:16.411632 [debug] [ThreadPool]: On list_ReadmitDB: Close
[0m14:39:16.427153 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m14:39:16.427153 [debug] [ThreadPool]: dbt-sqlserver
[0m14:39:16.442866 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m14:39:16.442866 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:39:16.442866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:16.442866 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:39:16.442866 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:39:16.520903 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:39:16.520903 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m14:39:16.536603 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m14:39:16.536603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83bf2f1a-6f62-47c7-8af9-2ae6178f30f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D927D2C90>]}
[0m14:39:16.536603 [debug] [MainThread]: On master: COMMIT
[0m14:39:16.536603 [debug] [Thread-1 (]: Began running node model.readmit_risk.admissions_enriched
[0m14:39:16.536603 [info ] [Thread-1 (]: 1 of 1 START sql table model dbo.admissions_enriched ........................... [RUN]
[0m14:39:16.552791 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.readmit_risk.admissions_enriched'
[0m14:39:16.553581 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.admissions_enriched
[0m14:39:16.553581 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.admissions_enriched"
[0m14:39:16.561298 [debug] [Thread-1 (]: Began executing node model.readmit_risk.admissions_enriched
[0m14:39:16.585019 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:39:16.595512 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."admissions_enriched__dbt_tmp__dbt_tmp_vw"
[0m14:39:16.598286 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:39:16.598286 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.admissions_enriched"
[0m14:39:16.598286 [debug] [Thread-1 (]: On model.readmit_risk.admissions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.admissions_enriched"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'admissions_enriched__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:39:16.598286 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:39:16.598286 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:39:16.598286 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:39:16.645010 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:39:16.648089 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.admissions_enriched"
[0m14:39:16.649012 [debug] [Thread-1 (]: On model.readmit_risk.admissions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.admissions_enriched"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."admissions_enriched__dbt_tmp__dbt_tmp_vw";');

[0m14:39:16.651015 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:39:16.661012 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.admissions_enriched"
[0m14:39:16.661012 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.admissions_enriched"
[0m14:39:16.661012 [debug] [Thread-1 (]: On model.readmit_risk.admissions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.admissions_enriched"} */

  
    USE [ReadmitDB];
    USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."admissions_enriched__dbt_tmp__dbt_tmp_vw" as 

with a as (
  select * from "ReadmitDB"."dbo"."stg_admissions"
)

select
  admission_id,
  patient_id,
  admit_date,
  discharge_date,
  coalesce(length_of_stay, datediff(day, admit_date, discharge_date)) as length_of_stay,
  department,
  primary_icd10,
  payer,
  age,
  prior_admissions,
  telehealth_followup,
  nurse_call,
  home_monitor,
  readmitted_30d,
  readmit_date,
  case 
    when readmit_date is not null and discharge_date is not null
    then datediff(day, discharge_date, readmit_date) else null end as days_to_readmit,
  case
    when readmitted_30d is not null then readmitted_30d
    when readmit_date is not null and datediff(day, discharge_date, readmit_date) <= 30 then 1
    else 0
  end as readmitted_within_30
from a
;;
    ')

EXEC('
            SELECT * INTO "ReadmitDB"."dbo"."admissions_enriched__dbt_tmp" FROM "ReadmitDB"."dbo"."admissions_enriched__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.admissions_enriched__dbt_tmp__dbt_tmp_vw')



    
    use [ReadmitDB];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_admissions_enriched__dbt_tmp_cci'
        AND object_id=object_id('dbo_admissions_enriched__dbt_tmp')
    )
    DROP index "dbo"."admissions_enriched__dbt_tmp".dbo_admissions_enriched__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_admissions_enriched__dbt_tmp_cci
    ON "dbo"."admissions_enriched__dbt_tmp"

   


  
[0m14:39:16.856339 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:39:16.856339 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.admissions_enriched"
[0m14:39:16.856339 [debug] [Thread-1 (]: On model.readmit_risk.admissions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.admissions_enriched"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.admissions_enriched__dbt_tmp', 'admissions_enriched'
[0m14:39:17.360922 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m14:39:17.376846 [debug] [Thread-1 (]: On model.readmit_risk.admissions_enriched: COMMIT
[0m14:39:17.376846 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."admissions_enriched__dbt_backup"
[0m14:39:17.376846 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.admissions_enriched"
[0m14:39:17.376846 [debug] [Thread-1 (]: On model.readmit_risk.admissions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.admissions_enriched"} */

      
    USE [ReadmitDB];
    EXEC('DROP table IF EXISTS "dbo"."admissions_enriched__dbt_backup";');

[0m14:39:17.376846 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:39:17.376846 [debug] [Thread-1 (]: On model.readmit_risk.admissions_enriched: Close
[0m14:39:17.392910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83bf2f1a-6f62-47c7-8af9-2ae6178f30f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D92F81A10>]}
[0m14:39:17.392910 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbo.admissions_enriched ...................... [[32mOK[0m in 0.82s]
[0m14:39:17.392910 [debug] [Thread-1 (]: Finished running node model.readmit_risk.admissions_enriched
[0m14:39:17.392910 [debug] [MainThread]: On master: COMMIT
[0m14:39:17.392910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:17.392910 [debug] [MainThread]: Connection 'list_ReadmitDB' was properly closed.
[0m14:39:17.392910 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m14:39:17.392910 [debug] [MainThread]: Connection 'model.readmit_risk.admissions_enriched' was properly closed.
[0m14:39:17.392910 [info ] [MainThread]: 
[0m14:39:17.392910 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m14:39:17.403464 [debug] [MainThread]: Command end result
[0m14:39:17.421155 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m14:39:17.429343 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m14:39:17.429343 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m14:39:17.429343 [info ] [MainThread]: 
[0m14:39:17.429343 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:39:17.429343 [info ] [MainThread]: 
[0m14:39:17.429343 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:39:17.429343 [debug] [MainThread]: Command `dbt run` succeeded at 14:39:17.429343 after 2.28 seconds
[0m14:39:17.429343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D90A25390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D90765750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D90998790>]}
[0m14:39:17.429343 [debug] [MainThread]: Flushing usage events
[0m14:39:19.253963 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:34.602106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027254769C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272547E0CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272547E0D50>]}


============================== 14:40:34.602106 | ef9cb376-5c17-4e0e-bba2-4572ba5b4932 ==============================
[0m14:40:34.602106 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:40:34.602106 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select path:models/core/labs_latest.sql', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m14:40:34.930016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef9cb376-5c17-4e0e-bba2-4572ba5b4932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272547E1350>]}
[0m14:40:34.977209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef9cb376-5c17-4e0e-bba2-4572ba5b4932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272537A7D50>]}
[0m14:40:34.977209 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:40:35.142618 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:40:35.261040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:40:35.261040 [debug] [MainThread]: Partial parsing: updated file: readmit_risk://models\core\labs_latest.sql
[0m14:40:35.496100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef9cb376-5c17-4e0e-bba2-4572ba5b4932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002725605B090>]}
[0m14:40:35.542974 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m14:40:35.542974 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m14:40:35.574223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef9cb376-5c17-4e0e-bba2-4572ba5b4932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272565B1090>]}
[0m14:40:35.574223 [info ] [MainThread]: Found 5 seeds, 13 models, 510 macros
[0m14:40:35.574223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef9cb376-5c17-4e0e-bba2-4572ba5b4932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272565B81D0>]}
[0m14:40:35.574223 [info ] [MainThread]: 
[0m14:40:35.574223 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:40:35.574223 [info ] [MainThread]: 
[0m14:40:35.574223 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:40:35.574223 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB'
[0m14:40:35.596103 [debug] [ThreadPool]: dbt-sqlserver
[0m14:40:35.596103 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB"
[0m14:40:35.596103 [debug] [ThreadPool]: On list_ReadmitDB: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB"} */
USE [ReadmitDB];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:40:35.596103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:35.596103 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:40:35.693646 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:40:35.694846 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:40:35.694846 [debug] [ThreadPool]: On list_ReadmitDB: Close
[0m14:40:35.710578 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m14:40:35.726204 [debug] [ThreadPool]: dbt-sqlserver
[0m14:40:35.726204 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m14:40:35.726204 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:40:35.726204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:35.726204 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:40:35.726204 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:40:35.809433 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:40:35.809433 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m14:40:35.809433 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m14:40:35.809433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef9cb376-5c17-4e0e-bba2-4572ba5b4932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002725479DC90>]}
[0m14:40:35.809433 [debug] [MainThread]: On master: COMMIT
[0m14:40:35.825123 [debug] [Thread-1 (]: Began running node model.readmit_risk.labs_latest
[0m14:40:35.825123 [info ] [Thread-1 (]: 1 of 1 START sql view model dbo.labs_latest .................................... [RUN]
[0m14:40:35.825123 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.readmit_risk.labs_latest'
[0m14:40:35.825123 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.labs_latest
[0m14:40:35.840410 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.labs_latest"
[0m14:40:35.841723 [debug] [Thread-1 (]: Began executing node model.readmit_risk.labs_latest
[0m14:40:35.867446 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.labs_latest"
[0m14:40:35.867446 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.labs_latest"
[0m14:40:35.867446 [debug] [Thread-1 (]: On model.readmit_risk.labs_latest: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.labs_latest"} */
USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."labs_latest__dbt_tmp" as 

with ranked as (
  select
    lab_id,
    admission_id,
    patient_id,
    lab_date,
    glucose_mgdl,
    hba1c_pct,
    creatinine_mgdl,
    systolic_bp,
    row_number() over (partition by admission_id order by lab_date desc) as rn
  from "ReadmitDB"."dbo"."stg_labs"
)
select
  lab_id,
  admission_id,
  patient_id,
  lab_date,
  glucose_mgdl,
  hba1c_pct,
  creatinine_mgdl,
  systolic_bp,
  case when glucose_mgdl > 180 then 1 else 0 end as high_glucose_flag,
  case when hba1c_pct > 8.0 then 1 else 0 end as high_hba1c_flag,
  case when creatinine_mgdl > 1.5 then 1 else 0 end as high_creatinine_flag,
  case when systolic_bp > 160 then 1 else 0 end as high_sbp_flag
from ranked
where rn = 1
;
-- This query selects the latest lab results per admission, casting numeric values and flagging abnormal results.
-- It uses a common table expression (CTE) to rank labs by date and filters to keep only the most recent lab for each admission.
-- The flags indicate whether the lab results exceed predefined thresholds for glucose, HbA1c, creatinine, and systolic blood pressure.
-- Adjust the thresholds as needed based on clinical guidelines or requirements.
-- This query is suitable for staging in a data pipeline, ensuring that only the most relevant lab results are processed further.
-- The materialization is set to ''view'' for efficient querying and updates.;
    ')


[0m14:40:35.867446 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:40:35.867446 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:40:35.867446 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:40:35.878798 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:35.878798 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.labs_latest"
[0m14:40:35.878798 [debug] [Thread-1 (]: On model.readmit_risk.labs_latest: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.labs_latest"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.labs_latest__dbt_tmp', 'labs_latest'
[0m14:40:36.286550 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:36.303684 [debug] [Thread-1 (]: On model.readmit_risk.labs_latest: COMMIT
[0m14:40:36.313318 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."labs_latest__dbt_backup"
[0m14:40:36.318281 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:40:36.319283 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.labs_latest"
[0m14:40:36.319283 [debug] [Thread-1 (]: On model.readmit_risk.labs_latest: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.labs_latest"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'labs_latest__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:40:36.373376 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:36.373376 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.labs_latest"
[0m14:40:36.373376 [debug] [Thread-1 (]: On model.readmit_risk.labs_latest: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.labs_latest"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."labs_latest__dbt_backup";');

[0m14:40:36.388988 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:36.388988 [debug] [Thread-1 (]: On model.readmit_risk.labs_latest: ROLLBACK
[0m14:40:36.388988 [debug] [Thread-1 (]: On model.readmit_risk.labs_latest: Close
[0m14:40:36.388988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef9cb376-5c17-4e0e-bba2-4572ba5b4932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272546A2FD0>]}
[0m14:40:36.388988 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbo.labs_latest ............................... [[32mOK[0m in 0.56s]
[0m14:40:36.388988 [debug] [Thread-1 (]: Finished running node model.readmit_risk.labs_latest
[0m14:40:36.388988 [debug] [MainThread]: On master: COMMIT
[0m14:40:36.388988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:36.404677 [debug] [MainThread]: Connection 'list_ReadmitDB' was properly closed.
[0m14:40:36.404677 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m14:40:36.404677 [debug] [MainThread]: Connection 'model.readmit_risk.labs_latest' was properly closed.
[0m14:40:36.404677 [info ] [MainThread]: 
[0m14:40:36.404677 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m14:40:36.404677 [debug] [MainThread]: Command end result
[0m14:40:36.413298 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m14:40:36.427912 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m14:40:36.432718 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m14:40:36.432718 [info ] [MainThread]: 
[0m14:40:36.432718 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:40:36.432718 [info ] [MainThread]: 
[0m14:40:36.436023 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:40:36.437078 [debug] [MainThread]: Command `dbt run` succeeded at 14:40:36.437078 after 1.89 seconds
[0m14:40:36.438124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027254535250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002724DACA250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002724DACA150>]}
[0m14:40:36.438124 [debug] [MainThread]: Flushing usage events
[0m14:40:40.573356 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:41:40.883961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF39A40AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3DC1B2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3DC1BBD0>]}


============================== 14:41:40.900477 | 721f7f9a-9b19-4bdd-a0fb-604b1983011e ==============================
[0m14:41:40.900477 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:41:40.900477 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select path:models/core/pharmacy_agg.sql', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m14:41:41.193996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '721f7f9a-9b19-4bdd-a0fb-604b1983011e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3D887C50>]}
[0m14:41:41.248661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '721f7f9a-9b19-4bdd-a0fb-604b1983011e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3CBD7D10>]}
[0m14:41:41.248661 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:41:41.444143 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:41:41.617006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:41:41.617006 [debug] [MainThread]: Partial parsing: updated file: readmit_risk://models\core\pharmacy_agg.sql
[0m14:41:41.888039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '721f7f9a-9b19-4bdd-a0fb-604b1983011e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3F7C2050>]}
[0m14:41:41.940111 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m14:41:41.942153 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m14:41:41.964268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '721f7f9a-9b19-4bdd-a0fb-604b1983011e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3F9F00D0>]}
[0m14:41:41.965644 [info ] [MainThread]: Found 5 seeds, 13 models, 510 macros
[0m14:41:41.965644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '721f7f9a-9b19-4bdd-a0fb-604b1983011e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3F9B7AD0>]}
[0m14:41:41.965644 [info ] [MainThread]: 
[0m14:41:41.965644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:41:41.965644 [info ] [MainThread]: 
[0m14:41:41.965644 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:41:41.965644 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB'
[0m14:41:41.984398 [debug] [ThreadPool]: dbt-sqlserver
[0m14:41:41.985398 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB"
[0m14:41:41.985398 [debug] [ThreadPool]: On list_ReadmitDB: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB"} */
USE [ReadmitDB];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:41:41.985398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:41.986397 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:41:42.077661 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:41:42.082022 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:41:42.082022 [debug] [ThreadPool]: On list_ReadmitDB: Close
[0m14:41:42.082022 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m14:41:42.097679 [debug] [ThreadPool]: dbt-sqlserver
[0m14:41:42.097679 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m14:41:42.097679 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:41:42.097679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:42.097679 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:41:42.097679 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:41:42.160394 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:41:42.160394 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m14:41:42.160394 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m14:41:42.160394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '721f7f9a-9b19-4bdd-a0fb-604b1983011e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3F436D10>]}
[0m14:41:42.160394 [debug] [MainThread]: On master: COMMIT
[0m14:41:42.176477 [debug] [Thread-1 (]: Began running node model.readmit_risk.pharmacy_agg
[0m14:41:42.176477 [info ] [Thread-1 (]: 1 of 1 START sql view model dbo.pharmacy_agg ................................... [RUN]
[0m14:41:42.176477 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.readmit_risk.pharmacy_agg'
[0m14:41:42.176477 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.pharmacy_agg
[0m14:41:42.176477 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.pharmacy_agg"
[0m14:41:42.176477 [debug] [Thread-1 (]: Began executing node model.readmit_risk.pharmacy_agg
[0m14:41:42.218060 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.pharmacy_agg"
[0m14:41:42.218833 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.pharmacy_agg"
[0m14:41:42.218833 [debug] [Thread-1 (]: On model.readmit_risk.pharmacy_agg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.pharmacy_agg"} */
USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."pharmacy_agg__dbt_tmp" as 

select
  admission_id,
  patient_id,
  count(*) as rx_count,
  sum(coalesce(days_supply,0)) as total_days_supply,
  avg(coalesce(adherence_rate,0)) as avg_adherence
from "ReadmitDB"."dbo"."stg_pharmacy"
group by admission_id, patient_id
;
-- This query aggregates pharmacy data by admission and patient, calculating the total number of prescriptions,
-- total days supply, and average adherence rate.
-- It uses the staging table ''stg_pharmacy'' to ensure that the data is normalized and cleaned before aggregation.
-- The materialization is set to ''view'' for efficient querying and updates.
-- The ''coalesce'' function is used to handle any null values in the ''days_supply'' and ''adherence_rate'' fields,
-- ensuring that the calculations are robust against missing data.
-- The ''group by'' clause ensures that the aggregation is done per admission and patient, allowing for detailed insights into pharmacy usage.
-- This query is suitable for staging in a data pipeline, providing a summarized view of pharmacy data  for further analysis.;
    ')


[0m14:41:42.218833 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:41:42.218833 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:41:42.218833 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:41:42.218833 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:41:42.233306 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.pharmacy_agg"
[0m14:41:42.233306 [debug] [Thread-1 (]: On model.readmit_risk.pharmacy_agg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.pharmacy_agg"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.pharmacy_agg__dbt_tmp', 'pharmacy_agg'
[0m14:41:42.692527 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:41:42.715329 [debug] [Thread-1 (]: On model.readmit_risk.pharmacy_agg: COMMIT
[0m14:41:42.715329 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."pharmacy_agg__dbt_backup"
[0m14:41:42.731742 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:41:42.731742 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.pharmacy_agg"
[0m14:41:42.731742 [debug] [Thread-1 (]: On model.readmit_risk.pharmacy_agg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.pharmacy_agg"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'pharmacy_agg__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:41:42.783313 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:41:42.800191 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.pharmacy_agg"
[0m14:41:42.800191 [debug] [Thread-1 (]: On model.readmit_risk.pharmacy_agg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.pharmacy_agg"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."pharmacy_agg__dbt_backup";');

[0m14:41:42.800191 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:41:42.800191 [debug] [Thread-1 (]: On model.readmit_risk.pharmacy_agg: ROLLBACK
[0m14:41:42.800191 [debug] [Thread-1 (]: On model.readmit_risk.pharmacy_agg: Close
[0m14:41:42.800191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '721f7f9a-9b19-4bdd-a0fb-604b1983011e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3F506A10>]}
[0m14:41:42.800191 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbo.pharmacy_agg .............................. [[32mOK[0m in 0.62s]
[0m14:41:42.800191 [debug] [Thread-1 (]: Finished running node model.readmit_risk.pharmacy_agg
[0m14:41:42.815065 [debug] [MainThread]: On master: COMMIT
[0m14:41:42.816571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:42.817158 [debug] [MainThread]: Connection 'list_ReadmitDB' was properly closed.
[0m14:41:42.817611 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m14:41:42.817611 [debug] [MainThread]: Connection 'model.readmit_risk.pharmacy_agg' was properly closed.
[0m14:41:42.818329 [info ] [MainThread]: 
[0m14:41:42.820335 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m14:41:42.821334 [debug] [MainThread]: Command end result
[0m14:41:42.842434 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m14:41:42.842434 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m14:41:42.854711 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m14:41:42.855695 [info ] [MainThread]: 
[0m14:41:42.855695 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:42.856714 [info ] [MainThread]: 
[0m14:41:42.857917 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:41:42.857917 [debug] [MainThread]: Command `dbt run` succeeded at 14:41:42.857917 after 2.04 seconds
[0m14:41:42.857917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3DC37F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF36F8A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF36F8A250>]}
[0m14:41:42.857917 [debug] [MainThread]: Flushing usage events
[0m14:41:46.149374 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:42:43.172907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A64810CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A64810150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A64810350>]}


============================== 14:42:43.172907 | 788ad1dc-cf53-4e0d-a09c-2cb72a8dd0c0 ==============================
[0m14:42:43.172907 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:42:43.172907 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select path:models/core/claims_agg.sql', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m14:42:43.484882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '788ad1dc-cf53-4e0d-a09c-2cb72a8dd0c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A64813010>]}
[0m14:42:43.531675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '788ad1dc-cf53-4e0d-a09c-2cb72a8dd0c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A63807E10>]}
[0m14:42:43.531675 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:42:43.684890 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:42:43.809892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:42:43.809892 [debug] [MainThread]: Partial parsing: updated file: readmit_risk://models\core\claims_agg.sql
[0m14:42:44.051113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '788ad1dc-cf53-4e0d-a09c-2cb72a8dd0c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A6608B8D0>]}
[0m14:42:44.088677 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m14:42:44.104874 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m14:42:44.124034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '788ad1dc-cf53-4e0d-a09c-2cb72a8dd0c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A6660D450>]}
[0m14:42:44.124034 [info ] [MainThread]: Found 5 seeds, 13 models, 510 macros
[0m14:42:44.124034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '788ad1dc-cf53-4e0d-a09c-2cb72a8dd0c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A65F476D0>]}
[0m14:42:44.124034 [info ] [MainThread]: 
[0m14:42:44.124034 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:42:44.124034 [info ] [MainThread]: 
[0m14:42:44.124034 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:42:44.124034 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB'
[0m14:42:44.144790 [debug] [ThreadPool]: dbt-sqlserver
[0m14:42:44.144790 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB"
[0m14:42:44.144790 [debug] [ThreadPool]: On list_ReadmitDB: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB"} */
USE [ReadmitDB];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:42:44.144790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:44.144790 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:42:44.244929 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:42:44.250920 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:42:44.252921 [debug] [ThreadPool]: On list_ReadmitDB: Close
[0m14:42:44.262171 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m14:42:44.268172 [debug] [ThreadPool]: dbt-sqlserver
[0m14:42:44.269170 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m14:42:44.269170 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:42:44.269170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:44.270170 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:42:44.270170 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:42:44.336661 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:42:44.352201 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m14:42:44.352201 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m14:42:44.352201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '788ad1dc-cf53-4e0d-a09c-2cb72a8dd0c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A65F6DE50>]}
[0m14:42:44.352201 [debug] [MainThread]: On master: COMMIT
[0m14:42:44.352201 [debug] [Thread-1 (]: Began running node model.readmit_risk.claims_agg
[0m14:42:44.352201 [info ] [Thread-1 (]: 1 of 1 START sql view model dbo.claims_agg ..................................... [RUN]
[0m14:42:44.352201 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.readmit_risk.claims_agg'
[0m14:42:44.352201 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.claims_agg
[0m14:42:44.369972 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.claims_agg"
[0m14:42:44.371501 [debug] [Thread-1 (]: Began executing node model.readmit_risk.claims_agg
[0m14:42:44.388578 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.claims_agg"
[0m14:42:44.388578 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.claims_agg"
[0m14:42:44.388578 [debug] [Thread-1 (]: On model.readmit_risk.claims_agg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.claims_agg"} */
USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."claims_agg__dbt_tmp" as 

select
  admission_id,
  patient_id,
  count(*) as claims_count,
  sum(coalesce(amount_billed,0)) as sum_billed,
  sum(coalesce(amount_paid,0)) as sum_paid,
  case when sum(coalesce(amount_billed,0)) = 0 then null
       else sum(coalesce(amount_paid,0))/nullif(sum(coalesce(amount_billed,0)),0) end as paid_ratio
from "ReadmitDB"."dbo"."stg_claims"
group by admission_id, patient_id
;
-- This query aggregates claims data by admission and patient, calculating the total number of claims,
-- total billed amount, total paid amount, and the paid ratio.
-- It uses the staging table ''stg_claims'' to ensure that the data is normalized and cleaned before aggregation.
-- The materialization is set to ''view'' for efficient querying and updates.
-- The ''coalesce'' function is used to handle any null values in the ''amount_billed'' and ''amount_paid'' fields,
-- ensuring that the calculations are robust against missing data.
-- The ''nullif'' function is used to avoid division by zero when calculating the paid ratio.
-- The ''group by'' clause ensures that the aggregation is done per admission and patient, allowing
-- for detailed insights into claims data.
-- This query is suitable for staging in a data pipeline, providing a summarized view of claims data
-- for further analysis.;
    ')


[0m14:42:44.388578 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:42:44.388578 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:42:44.388578 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:42:44.405254 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:42:44.405254 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.claims_agg"
[0m14:42:44.405254 [debug] [Thread-1 (]: On model.readmit_risk.claims_agg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.claims_agg"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.claims_agg__dbt_tmp', 'claims_agg'
[0m14:42:44.824348 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:42:44.847352 [debug] [Thread-1 (]: On model.readmit_risk.claims_agg: COMMIT
[0m14:42:44.857555 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."claims_agg__dbt_backup"
[0m14:42:44.865555 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:42:44.866634 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.claims_agg"
[0m14:42:44.867556 [debug] [Thread-1 (]: On model.readmit_risk.claims_agg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.claims_agg"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'claims_agg__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:42:44.888575 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:42:44.891613 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.claims_agg"
[0m14:42:44.891613 [debug] [Thread-1 (]: On model.readmit_risk.claims_agg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.claims_agg"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."claims_agg__dbt_backup";');

[0m14:42:44.891613 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:42:44.891613 [debug] [Thread-1 (]: On model.readmit_risk.claims_agg: ROLLBACK
[0m14:42:44.891613 [debug] [Thread-1 (]: On model.readmit_risk.claims_agg: Close
[0m14:42:44.891613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '788ad1dc-cf53-4e0d-a09c-2cb72a8dd0c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A63FCDB10>]}
[0m14:42:44.891613 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbo.claims_agg ................................ [[32mOK[0m in 0.54s]
[0m14:42:44.891613 [debug] [Thread-1 (]: Finished running node model.readmit_risk.claims_agg
[0m14:42:44.891613 [debug] [MainThread]: On master: COMMIT
[0m14:42:44.891613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:44.891613 [debug] [MainThread]: Connection 'list_ReadmitDB' was properly closed.
[0m14:42:44.904378 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m14:42:44.904896 [debug] [MainThread]: Connection 'model.readmit_risk.claims_agg' was properly closed.
[0m14:42:44.904896 [info ] [MainThread]: 
[0m14:42:44.904896 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m14:42:44.907413 [debug] [MainThread]: Command end result
[0m14:42:44.932139 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m14:42:44.934129 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m14:42:44.939726 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m14:42:44.939726 [info ] [MainThread]: 
[0m14:42:44.940726 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:42:44.941727 [info ] [MainThread]: 
[0m14:42:44.941727 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:42:44.942726 [debug] [MainThread]: Command `dbt run` succeeded at 14:42:44.942726 after 1.83 seconds
[0m14:42:44.943736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A6483B990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A63955F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A647C8950>]}
[0m14:42:44.943736 [debug] [MainThread]: Flushing usage events
[0m14:42:50.065009 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:43:32.800879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002415469AFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241546995D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024154699590>]}


============================== 14:43:32.800879 | 33e14cc5-2a21-4279-bd09-74d31ecbf342 ==============================
[0m14:43:32.800879 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:43:32.800879 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select path:models/core/dim_patient.sql', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m14:43:33.101478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33e14cc5-2a21-4279-bd09-74d31ecbf342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024154707C50>]}
[0m14:43:33.150101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33e14cc5-2a21-4279-bd09-74d31ecbf342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241546F4D50>]}
[0m14:43:33.150101 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:43:33.299360 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:43:33.446674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:43:33.446674 [debug] [MainThread]: Partial parsing: updated file: readmit_risk://models\core\dim_patient.sql
[0m14:43:33.733960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33e14cc5-2a21-4279-bd09-74d31ecbf342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024151325C50>]}
[0m14:43:33.784029 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m14:43:33.784029 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m14:43:33.817249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33e14cc5-2a21-4279-bd09-74d31ecbf342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024155F7F150>]}
[0m14:43:33.817249 [info ] [MainThread]: Found 5 seeds, 13 models, 510 macros
[0m14:43:33.817249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33e14cc5-2a21-4279-bd09-74d31ecbf342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024155F64E10>]}
[0m14:43:33.817249 [info ] [MainThread]: 
[0m14:43:33.817249 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:43:33.817249 [info ] [MainThread]: 
[0m14:43:33.817249 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:43:33.817249 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB'
[0m14:43:33.839175 [debug] [ThreadPool]: dbt-sqlserver
[0m14:43:33.839175 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB"
[0m14:43:33.839175 [debug] [ThreadPool]: On list_ReadmitDB: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB"} */
USE [ReadmitDB];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:43:33.839175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:33.839175 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:43:33.939723 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:43:33.951580 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:43:33.954571 [debug] [ThreadPool]: On list_ReadmitDB: Close
[0m14:43:33.966821 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m14:43:33.966821 [debug] [ThreadPool]: dbt-sqlserver
[0m14:43:33.966821 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m14:43:33.966821 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:43:33.966821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:33.966821 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:43:33.966821 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:43:34.048158 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:43:34.048158 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m14:43:34.048158 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m14:43:34.048158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33e14cc5-2a21-4279-bd09-74d31ecbf342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024156245E90>]}
[0m14:43:34.048158 [debug] [MainThread]: On master: COMMIT
[0m14:43:34.048158 [debug] [Thread-1 (]: Began running node model.readmit_risk.dim_patient
[0m14:43:34.063739 [info ] [Thread-1 (]: 1 of 1 START sql table model dbo.dim_patient ................................... [RUN]
[0m14:43:34.063739 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.readmit_risk.dim_patient'
[0m14:43:34.063739 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.dim_patient
[0m14:43:34.063739 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.dim_patient"
[0m14:43:34.063739 [debug] [Thread-1 (]: Began executing node model.readmit_risk.dim_patient
[0m14:43:34.116376 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:43:34.117153 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."dim_patient__dbt_tmp__dbt_tmp_vw"
[0m14:43:34.117153 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:43:34.117153 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.dim_patient"
[0m14:43:34.133379 [debug] [Thread-1 (]: On model.readmit_risk.dim_patient: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.dim_patient"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'dim_patient__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:43:34.133890 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:43:34.133890 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:43:34.133890 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:43:34.164954 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:43:34.168261 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.dim_patient"
[0m14:43:34.168261 [debug] [Thread-1 (]: On model.readmit_risk.dim_patient: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.dim_patient"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."dim_patient__dbt_tmp__dbt_tmp_vw";');

[0m14:43:34.171261 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:43:34.183346 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.dim_patient"
[0m14:43:34.183346 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.dim_patient"
[0m14:43:34.183346 [debug] [Thread-1 (]: On model.readmit_risk.dim_patient: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.dim_patient"} */

  
    USE [ReadmitDB];
    USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."dim_patient__dbt_tmp__dbt_tmp_vw" as 

with adm_dx as (
  select patient_id,
    max(case when primary_icd10 = ''E11'' then 1 else 0 end) as ever_diabetes,
    max(case when primary_icd10 = ''I50'' then 1 else 0 end) as ever_heart_failure,
    max(case when primary_icd10 = ''J44'' then 1 else 0 end) as ever_copd,
    max(case when primary_icd10 = ''N18'' then 1 else 0 end) as ever_ckd
  from "ReadmitDB"."dbo"."stg_admissions"
  group by patient_id
)

select
  p.*,
  coalesce(ad.ever_diabetes,0) as ever_diabetes,
  coalesce(ad.ever_heart_failure,0) as ever_heart_failure,
  coalesce(ad.ever_copd,0) as ever_copd,
  coalesce(ad.ever_ckd,0) as ever_ckd
from "ReadmitDB"."dbo"."patients_enriched" p
left join adm_dx ad on p.patient_id = ad.patient_id
;
-- This query enriches patient data with chronic condition flags based on admissions.
-- It uses a common table expression (CTE) to determine if a patient has ever been  admitted with specific conditions (diabetes, heart failure, COPD, CKD).     
-- The main query selects all patient fields and joins the CTE to add the chronic condition flags.
-- The ''coalesce'' function is used to ensure that if a patient has never been admitted with a condition, the flag will default to 0.    
-- This query is suitable for staging in a data pipeline, providing a comprehensive view of patient data with chronic condition indicators.
-- The materialization is set to ''table'' for efficient querying and storage.
-- Adjust the conditions and flags as needed based on clinical guidelines or requirements.;
    ')

EXEC('
            SELECT * INTO "ReadmitDB"."dbo"."dim_patient__dbt_tmp" FROM "ReadmitDB"."dbo"."dim_patient__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.dim_patient__dbt_tmp__dbt_tmp_vw')



    
    use [ReadmitDB];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_dim_patient__dbt_tmp_cci'
        AND object_id=object_id('dbo_dim_patient__dbt_tmp')
    )
    DROP index "dbo"."dim_patient__dbt_tmp".dbo_dim_patient__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_dim_patient__dbt_tmp_cci
    ON "dbo"."dim_patient__dbt_tmp"

   


  
[0m14:43:34.402102 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:43:34.405874 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.dim_patient"
[0m14:43:34.405874 [debug] [Thread-1 (]: On model.readmit_risk.dim_patient: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.dim_patient"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.dim_patient__dbt_tmp', 'dim_patient'
[0m14:43:34.967518 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m14:43:34.989049 [debug] [Thread-1 (]: On model.readmit_risk.dim_patient: COMMIT
[0m14:43:34.991035 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."dim_patient__dbt_backup"
[0m14:43:34.992035 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.dim_patient"
[0m14:43:34.992035 [debug] [Thread-1 (]: On model.readmit_risk.dim_patient: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.dim_patient"} */

      
    USE [ReadmitDB];
    EXEC('DROP table IF EXISTS "dbo"."dim_patient__dbt_backup";');

[0m14:43:34.994011 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:43:34.996046 [debug] [Thread-1 (]: On model.readmit_risk.dim_patient: Close
[0m14:43:34.998026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33e14cc5-2a21-4279-bd09-74d31ecbf342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024156000150>]}
[0m14:43:34.999019 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbo.dim_patient .............................. [[32mOK[0m in 0.93s]
[0m14:43:34.999993 [debug] [Thread-1 (]: Finished running node model.readmit_risk.dim_patient
[0m14:43:35.002013 [debug] [MainThread]: On master: COMMIT
[0m14:43:35.003041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:35.003041 [debug] [MainThread]: Connection 'list_ReadmitDB' was properly closed.
[0m14:43:35.004034 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m14:43:35.004034 [debug] [MainThread]: Connection 'model.readmit_risk.dim_patient' was properly closed.
[0m14:43:35.005004 [info ] [MainThread]: 
[0m14:43:35.005993 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m14:43:35.007019 [debug] [MainThread]: Command end result
[0m14:43:35.027051 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m14:43:35.028964 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m14:43:35.033963 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m14:43:35.035029 [info ] [MainThread]: 
[0m14:43:35.036027 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:43:35.036964 [info ] [MainThread]: 
[0m14:43:35.036964 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:43:35.038286 [debug] [MainThread]: Command `dbt run` succeeded at 14:43:35.038286 after 2.30 seconds
[0m14:43:35.039360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024154725910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024154727D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024154727F50>]}
[0m14:43:35.039360 [debug] [MainThread]: Flushing usage events
[0m14:43:37.751822 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:25.411704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F17C1F490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F17D4B990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F17CD9550>]}


============================== 14:44:25.411704 | 2315aa1b-a93f-4989-b7f7-85068201ce7a ==============================
[0m14:44:25.411704 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:44:25.411704 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select path:models/core/fact_readmissions.sql', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt'}
[0m14:44:25.721743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2315aa1b-a93f-4989-b7f7-85068201ce7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F17CD93D0>]}
[0m14:44:25.781142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2315aa1b-a93f-4989-b7f7-85068201ce7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F16D07C50>]}
[0m14:44:25.781142 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:44:25.943113 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:44:26.068099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:44:26.068099 [debug] [MainThread]: Partial parsing: updated file: readmit_risk://models\core\fact_readmissions.sql
[0m14:44:26.358717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2315aa1b-a93f-4989-b7f7-85068201ce7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F1957A350>]}
[0m14:44:26.444442 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m14:44:26.444442 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m14:44:26.461124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2315aa1b-a93f-4989-b7f7-85068201ce7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F19B257D0>]}
[0m14:44:26.461124 [info ] [MainThread]: Found 5 seeds, 13 models, 510 macros
[0m14:44:26.461124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2315aa1b-a93f-4989-b7f7-85068201ce7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F19838CD0>]}
[0m14:44:26.461124 [info ] [MainThread]: 
[0m14:44:26.461124 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:44:26.461124 [info ] [MainThread]: 
[0m14:44:26.461124 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:44:26.461124 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB'
[0m14:44:26.486603 [debug] [ThreadPool]: dbt-sqlserver
[0m14:44:26.487599 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB"
[0m14:44:26.487599 [debug] [ThreadPool]: On list_ReadmitDB: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB"} */
USE [ReadmitDB];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:44:26.487599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:26.487599 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:44:26.578318 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:44:26.600945 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:44:26.603945 [debug] [ThreadPool]: On list_ReadmitDB: Close
[0m14:44:26.622941 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m14:44:26.627274 [debug] [ThreadPool]: dbt-sqlserver
[0m14:44:26.627274 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m14:44:26.627274 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:44:26.627274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:26.627274 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:44:26.627274 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:44:26.736719 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:44:26.736719 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m14:44:26.736719 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m14:44:26.736719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2315aa1b-a93f-4989-b7f7-85068201ce7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F19585F50>]}
[0m14:44:26.736719 [debug] [MainThread]: On master: COMMIT
[0m14:44:26.752269 [debug] [Thread-1 (]: Began running node model.readmit_risk.fact_readmissions
[0m14:44:26.752269 [info ] [Thread-1 (]: 1 of 1 START sql table model dbo.fact_readmissions ............................. [RUN]
[0m14:44:26.752269 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.readmit_risk.fact_readmissions'
[0m14:44:26.752269 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.fact_readmissions
[0m14:44:26.752269 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.fact_readmissions"
[0m14:44:26.767973 [debug] [Thread-1 (]: Began executing node model.readmit_risk.fact_readmissions
[0m14:44:26.797337 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:44:26.797337 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."fact_readmissions__dbt_tmp__dbt_tmp_vw"
[0m14:44:26.797337 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:44:26.797337 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.fact_readmissions"
[0m14:44:26.810493 [debug] [Thread-1 (]: On model.readmit_risk.fact_readmissions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.fact_readmissions"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'fact_readmissions__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:44:26.810493 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:44:26.811498 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:44:26.811757 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:44:26.877274 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:44:26.877274 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.fact_readmissions"
[0m14:44:26.877274 [debug] [Thread-1 (]: On model.readmit_risk.fact_readmissions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.fact_readmissions"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."fact_readmissions__dbt_tmp__dbt_tmp_vw";');

[0m14:44:26.877274 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:44:26.908555 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.fact_readmissions"
[0m14:44:26.908555 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.fact_readmissions"
[0m14:44:26.908555 [debug] [Thread-1 (]: On model.readmit_risk.fact_readmissions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.fact_readmissions"} */

  
    USE [ReadmitDB];
    USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."fact_readmissions__dbt_tmp__dbt_tmp_vw" as 

select
  a.admission_id,
  a.patient_id,
  a.admit_date,
  a.discharge_date,
  a.length_of_stay,
  a.prior_admissions,
  a.department,
  a.primary_icd10,
  coalesce(c.sum_billed,0) as sum_billed,
  coalesce(c.sum_paid,0) as sum_paid,
  coalesce(p.avg_adherence, 0) as avg_adherence,
  coalesce(l.high_hba1c_flag,0) as high_hba1c_flag,
  a.readmitted_within_30 as label_readmit_30
from "ReadmitDB"."dbo"."admissions_enriched" a
left join "ReadmitDB"."dbo"."claims_agg" c   on a.admission_id = c.admission_id
left join "ReadmitDB"."dbo"."pharmacy_agg" p  on a.admission_id = p.admission_id
left join "ReadmitDB"."dbo"."labs_latest" l   on a.admission_id = l.admission_id
;
-- This query aggregates data from admissions, claims, pharmacy, and labs to create a comprehensive view of each admission.
-- It selects key fields from the admissions table and joins with aggregated claims, pharmacy, and labs data.
-- The ''coalesce'' function is used to handle any null values in the claims and pharmacy data, ensuring that the final dataset is complete.  
-- The ''left join'' ensures that even if there are no claims, pharmacy, or labs data for an admission, the admission record will still be included.
-- The materialization is set to ''table'' for efficient querying and storage.
-- This query is suitable for staging in a data pipeline, providing a rich dataset for further analysis or modeling.;
    ')

EXEC('
            SELECT * INTO "ReadmitDB"."dbo"."fact_readmissions__dbt_tmp" FROM "ReadmitDB"."dbo"."fact_readmissions__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.fact_readmissions__dbt_tmp__dbt_tmp_vw')



    
    use [ReadmitDB];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_fact_readmissions__dbt_tmp_cci'
        AND object_id=object_id('dbo_fact_readmissions__dbt_tmp')
    )
    DROP index "dbo"."fact_readmissions__dbt_tmp".dbo_fact_readmissions__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_fact_readmissions__dbt_tmp_cci
    ON "dbo"."fact_readmissions__dbt_tmp"

   


  
[0m14:44:34.473984 [debug] [Thread-1 (]: SQL status: OK in 8.000 seconds
[0m14:44:34.487529 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.fact_readmissions"
[0m14:44:34.488529 [debug] [Thread-1 (]: On model.readmit_risk.fact_readmissions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.fact_readmissions"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.fact_readmissions__dbt_tmp', 'fact_readmissions'
[0m14:44:34.969661 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:44:35.002773 [debug] [Thread-1 (]: On model.readmit_risk.fact_readmissions: COMMIT
[0m14:44:35.008035 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."fact_readmissions__dbt_backup"
[0m14:44:35.010022 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.fact_readmissions"
[0m14:44:35.011001 [debug] [Thread-1 (]: On model.readmit_risk.fact_readmissions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.fact_readmissions"} */

      
    USE [ReadmitDB];
    EXEC('DROP table IF EXISTS "dbo"."fact_readmissions__dbt_backup";');

[0m14:44:35.012994 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:44:35.016468 [debug] [Thread-1 (]: On model.readmit_risk.fact_readmissions: Close
[0m14:44:35.020476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2315aa1b-a93f-4989-b7f7-85068201ce7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F19C5CC90>]}
[0m14:44:35.022534 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbo.fact_readmissions ........................ [[32mOK[0m in 8.27s]
[0m14:44:35.024678 [debug] [Thread-1 (]: Finished running node model.readmit_risk.fact_readmissions
[0m14:44:35.026734 [debug] [MainThread]: On master: COMMIT
[0m14:44:35.027759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:35.028752 [debug] [MainThread]: Connection 'list_ReadmitDB' was properly closed.
[0m14:44:35.029721 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m14:44:35.030697 [debug] [MainThread]: Connection 'model.readmit_risk.fact_readmissions' was properly closed.
[0m14:44:35.031708 [info ] [MainThread]: 
[0m14:44:35.032928 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.57 seconds (8.57s).
[0m14:44:35.035077 [debug] [MainThread]: Command end result
[0m14:44:35.093339 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m14:44:35.097225 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m14:44:35.108769 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m14:44:35.109734 [info ] [MainThread]: 
[0m14:44:35.111731 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:44:35.112910 [info ] [MainThread]: 
[0m14:44:35.114225 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:44:35.117299 [debug] [MainThread]: Command `dbt run` succeeded at 14:44:35.117299 after 9.76 seconds
[0m14:44:35.118265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F17AA5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F17CDA210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F17CD8750>]}
[0m14:44:35.119270 [debug] [MainThread]: Flushing usage events
[0m14:44:38.610712 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:45:34.664604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025162ABCFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002516600D390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251660DD290>]}


============================== 14:45:34.680108 | 7107f93d-c77c-4d9a-bbb7-505e0ca766fa ==============================
[0m14:45:34.680108 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:45:34.680108 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select path:models/core/features_ml.sql', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m14:45:34.970587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7107f93d-c77c-4d9a-bbb7-505e0ca766fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025166137C50>]}
[0m14:45:35.017384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7107f93d-c77c-4d9a-bbb7-505e0ca766fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251658F3C50>]}
[0m14:45:35.017384 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:45:35.197890 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:45:35.308293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:45:35.308293 [debug] [MainThread]: Partial parsing: updated file: readmit_risk://models\core\features_ml.sql
[0m14:45:35.542674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7107f93d-c77c-4d9a-bbb7-505e0ca766fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025167CA1950>]}
[0m14:45:35.589544 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m14:45:35.589544 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m14:45:35.620754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7107f93d-c77c-4d9a-bbb7-505e0ca766fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002516794D5D0>]}
[0m14:45:35.620754 [info ] [MainThread]: Found 5 seeds, 13 models, 510 macros
[0m14:45:35.620754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7107f93d-c77c-4d9a-bbb7-505e0ca766fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025167ED9D10>]}
[0m14:45:35.620754 [info ] [MainThread]: 
[0m14:45:35.620754 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:35.636311 [info ] [MainThread]: 
[0m14:45:35.636311 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:45:35.636311 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB'
[0m14:45:35.636311 [debug] [ThreadPool]: dbt-sqlserver
[0m14:45:35.636311 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB"
[0m14:45:35.636311 [debug] [ThreadPool]: On list_ReadmitDB: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB"} */
USE [ReadmitDB];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:45:35.636311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:35.636311 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:45:35.746115 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:45:35.746115 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:45:35.746115 [debug] [ThreadPool]: On list_ReadmitDB: Close
[0m14:45:35.761754 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m14:45:35.777469 [debug] [ThreadPool]: dbt-sqlserver
[0m14:45:35.777469 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m14:45:35.777469 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:45:35.777469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:35.777469 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:45:35.777469 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:45:35.839955 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:45:35.855571 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m14:45:35.855571 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m14:45:35.855571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7107f93d-c77c-4d9a-bbb7-505e0ca766fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025167EAA690>]}
[0m14:45:35.855571 [debug] [MainThread]: On master: COMMIT
[0m14:45:35.871117 [debug] [Thread-1 (]: Began running node model.readmit_risk.features_ml
[0m14:45:35.871117 [info ] [Thread-1 (]: 1 of 1 START sql table model dbo.features_ml ................................... [RUN]
[0m14:45:35.871117 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.readmit_risk.features_ml'
[0m14:45:35.871117 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.features_ml
[0m14:45:35.871117 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.features_ml"
[0m14:45:35.871117 [debug] [Thread-1 (]: Began executing node model.readmit_risk.features_ml
[0m14:45:35.901665 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:45:35.915645 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."features_ml__dbt_tmp__dbt_tmp_vw"
[0m14:45:35.915645 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:45:35.915645 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m14:45:35.915645 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'features_ml__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:45:35.915645 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:45:35.915645 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:45:35.915645 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:45:35.965058 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:45:35.965058 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m14:45:35.965058 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."features_ml__dbt_tmp__dbt_tmp_vw";');

[0m14:45:35.965058 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:45:35.980682 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.features_ml"
[0m14:45:35.980682 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m14:45:35.980682 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

  
    USE [ReadmitDB];
    USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."features_ml__dbt_tmp__dbt_tmp_vw" as 

select
  f.admission_id,
  f.patient_id,
  dp.age,
  dp.gender,
  dp.ethnicity,
  dp.bmi,
  dp.ses_group,
  dp.ever_diabetes,
  dp.ever_heart_failure,
  dp.ever_copd,
  dp.ever_ckd,
  f.length_of_stay,
  f.prior_admissions,
  f.department,
  f.sum_billed,
  f.sum_paid,
  f.avg_adherence,
  f.high_hba1c_flag,
  f.label_readmit_30 as readmit_label
from "ReadmitDB"."dbo"."fact_readmissions" f
left join "ReadmitDB"."dbo"."dim_patient" dp on f.patient_id = dp.patient_id
;
-- This query combines the fact_readmissions data with enriched patient data to create a comprehensive view of each admission.  
-- It selects key fields from the fact_readmissions table and joins with the dim_patient table to include patient demographics and chronic condition flags.
-- The ''left join'' ensures that even if there are no matching patient records, the admission    
-- record will still be included in the final dataset.
-- The materialization is set to ''table'' for efficient querying and storage.
-- This query is suitable for staging in a data pipeline, providing a rich dataset for further analysis or modeling.
-- The ''readmit_label'' field indicates whether the patient was readmitted within 30 days of discharge, which is crucial for readmission risk analysis.;
    ')

EXEC('
            SELECT * INTO "ReadmitDB"."dbo"."features_ml__dbt_tmp" FROM "ReadmitDB"."dbo"."features_ml__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.features_ml__dbt_tmp__dbt_tmp_vw')



    
    use [ReadmitDB];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_features_ml__dbt_tmp_cci'
        AND object_id=object_id('dbo_features_ml__dbt_tmp')
    )
    DROP index "dbo"."features_ml__dbt_tmp".dbo_features_ml__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_features_ml__dbt_tmp_cci
    ON "dbo"."features_ml__dbt_tmp"

   


  
[0m14:45:36.232236 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:45:36.232236 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m14:45:36.232236 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.features_ml__dbt_tmp', 'features_ml'
[0m14:45:36.717249 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:45:36.732788 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: COMMIT
[0m14:45:36.732788 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."features_ml__dbt_backup"
[0m14:45:36.748411 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m14:45:36.749230 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

      
    USE [ReadmitDB];
    EXEC('DROP table IF EXISTS "dbo"."features_ml__dbt_backup";');

[0m14:45:36.749912 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:45:36.749912 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: Close
[0m14:45:36.749912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7107f93d-c77c-4d9a-bbb7-505e0ca766fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025167C82C50>]}
[0m14:45:36.749912 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbo.features_ml .............................. [[32mOK[0m in 0.88s]
[0m14:45:36.749912 [debug] [Thread-1 (]: Finished running node model.readmit_risk.features_ml
[0m14:45:36.749912 [debug] [MainThread]: On master: COMMIT
[0m14:45:36.749912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:36.749912 [debug] [MainThread]: Connection 'list_ReadmitDB' was properly closed.
[0m14:45:36.749912 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m14:45:36.749912 [debug] [MainThread]: Connection 'model.readmit_risk.features_ml' was properly closed.
[0m14:45:36.749912 [info ] [MainThread]: 
[0m14:45:36.749912 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m14:45:36.749912 [debug] [MainThread]: Command end result
[0m14:45:36.780362 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m14:45:36.783250 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m14:45:36.787361 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m14:45:36.787361 [info ] [MainThread]: 
[0m14:45:36.787361 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:36.787361 [info ] [MainThread]: 
[0m14:45:36.787361 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:45:36.787361 [debug] [MainThread]: Command `dbt run` succeeded at 14:45:36.787361 after 2.19 seconds
[0m14:45:36.787361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025166157FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025165E95910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002515F4DA750>]}
[0m14:45:36.787361 [debug] [MainThread]: Flushing usage events
[0m14:45:43.710666 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:46:23.225303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3043DB3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3043DBE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3043DBBD0>]}


============================== 14:46:23.225303 | bc608fec-b0e4-4016-9b03-106391734b7b ==============================
[0m14:46:23.225303 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:46:23.225303 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select path:models/core', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m14:46:23.547365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc608fec-b0e4-4016-9b03-106391734b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3019A6790>]}
[0m14:46:23.594235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc608fec-b0e4-4016-9b03-106391734b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3033A7C50>]}
[0m14:46:23.594235 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:46:23.743392 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:46:23.867863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:46:23.867863 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:46:23.945982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc608fec-b0e4-4016-9b03-106391734b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D300D2AB90>]}
[0m14:46:23.993208 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m14:46:23.993208 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m14:46:24.009251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc608fec-b0e4-4016-9b03-106391734b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3033F6190>]}
[0m14:46:24.009251 [info ] [MainThread]: Found 5 seeds, 13 models, 510 macros
[0m14:46:24.024921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc608fec-b0e4-4016-9b03-106391734b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D305F13190>]}
[0m14:46:24.024921 [info ] [MainThread]: 
[0m14:46:24.024921 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:46:24.024921 [info ] [MainThread]: 
[0m14:46:24.024921 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:46:24.024921 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB'
[0m14:46:24.047939 [debug] [ThreadPool]: dbt-sqlserver
[0m14:46:24.047939 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB"
[0m14:46:24.047939 [debug] [ThreadPool]: On list_ReadmitDB: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB"} */
USE [ReadmitDB];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:46:24.047939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:24.047939 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:46:24.142208 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:46:24.142208 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:46:24.142208 [debug] [ThreadPool]: On list_ReadmitDB: Close
[0m14:46:24.142208 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m14:46:24.157867 [debug] [ThreadPool]: dbt-sqlserver
[0m14:46:24.157867 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m14:46:24.157867 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:46:24.157867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:24.157867 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:46:24.157867 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:46:24.243399 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:46:24.259134 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m14:46:24.259134 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m14:46:24.259134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc608fec-b0e4-4016-9b03-106391734b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D30102C6D0>]}
[0m14:46:24.259134 [debug] [MainThread]: On master: COMMIT
[0m14:46:24.274686 [debug] [Thread-1 (]: Began running node model.readmit_risk.admissions_enriched
[0m14:46:24.274686 [info ] [Thread-1 (]: 1 of 8 START sql table model dbo.admissions_enriched ........................... [RUN]
[0m14:46:24.274686 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.readmit_risk.admissions_enriched'
[0m14:46:24.274686 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.admissions_enriched
[0m14:46:24.292247 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.admissions_enriched"
[0m14:46:24.293214 [debug] [Thread-1 (]: Began executing node model.readmit_risk.admissions_enriched
[0m14:46:24.310309 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:46:24.326963 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."admissions_enriched__dbt_tmp__dbt_tmp_vw"
[0m14:46:24.326963 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:46:24.326963 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.admissions_enriched"
[0m14:46:24.326963 [debug] [Thread-1 (]: On model.readmit_risk.admissions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.admissions_enriched"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'admissions_enriched__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:46:24.326963 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:46:24.326963 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:46:24.341971 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:46:24.386060 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:24.389015 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.admissions_enriched"
[0m14:46:24.389015 [debug] [Thread-1 (]: On model.readmit_risk.admissions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.admissions_enriched"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."admissions_enriched__dbt_tmp__dbt_tmp_vw";');

[0m14:46:24.391369 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:24.393527 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.admissions_enriched"
[0m14:46:24.409227 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.admissions_enriched"
[0m14:46:24.409227 [debug] [Thread-1 (]: On model.readmit_risk.admissions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.admissions_enriched"} */

  
    USE [ReadmitDB];
    USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."admissions_enriched__dbt_tmp__dbt_tmp_vw" as 

with a as (
  select * from "ReadmitDB"."dbo"."stg_admissions"
)

select
  admission_id,
  patient_id,
  admit_date,
  discharge_date,
  coalesce(length_of_stay, datediff(day, admit_date, discharge_date)) as length_of_stay,
  department,
  primary_icd10,
  payer,
  age,
  prior_admissions,
  telehealth_followup,
  nurse_call,
  home_monitor,
  readmitted_30d,
  readmit_date,
  case 
    when readmit_date is not null and discharge_date is not null
    then datediff(day, discharge_date, readmit_date) else null end as days_to_readmit,
  case
    when readmitted_30d is not null then readmitted_30d
    when readmit_date is not null and datediff(day, discharge_date, readmit_date) <= 30 then 1
    else 0
  end as readmitted_within_30
from a
;;
    ')

EXEC('
            SELECT * INTO "ReadmitDB"."dbo"."admissions_enriched__dbt_tmp" FROM "ReadmitDB"."dbo"."admissions_enriched__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.admissions_enriched__dbt_tmp__dbt_tmp_vw')



    
    use [ReadmitDB];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_admissions_enriched__dbt_tmp_cci'
        AND object_id=object_id('dbo_admissions_enriched__dbt_tmp')
    )
    DROP index "dbo"."admissions_enriched__dbt_tmp".dbo_admissions_enriched__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_admissions_enriched__dbt_tmp_cci
    ON "dbo"."admissions_enriched__dbt_tmp"

   


  
[0m14:46:24.518595 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:24.534139 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.admissions_enriched"
[0m14:46:24.534139 [debug] [Thread-1 (]: On model.readmit_risk.admissions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.admissions_enriched"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.admissions_enriched', 'admissions_enriched__dbt_backup'
[0m14:46:25.089158 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m14:46:25.104696 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.admissions_enriched"
[0m14:46:25.104696 [debug] [Thread-1 (]: On model.readmit_risk.admissions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.admissions_enriched"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.admissions_enriched__dbt_tmp', 'admissions_enriched'
[0m14:46:25.104696 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.120319 [debug] [Thread-1 (]: On model.readmit_risk.admissions_enriched: COMMIT
[0m14:46:25.120319 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."admissions_enriched__dbt_backup"
[0m14:46:25.120319 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.admissions_enriched"
[0m14:46:25.120319 [debug] [Thread-1 (]: On model.readmit_risk.admissions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.admissions_enriched"} */

      
    USE [ReadmitDB];
    EXEC('DROP table IF EXISTS "dbo"."admissions_enriched__dbt_backup";');

[0m14:46:25.136026 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.136026 [debug] [Thread-1 (]: On model.readmit_risk.admissions_enriched: Close
[0m14:46:25.136026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc608fec-b0e4-4016-9b03-106391734b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D305C28110>]}
[0m14:46:25.136026 [info ] [Thread-1 (]: 1 of 8 OK created sql table model dbo.admissions_enriched ...................... [[32mOK[0m in 0.86s]
[0m14:46:25.136026 [debug] [Thread-1 (]: Finished running node model.readmit_risk.admissions_enriched
[0m14:46:25.136026 [debug] [Thread-1 (]: Began running node model.readmit_risk.claims_agg
[0m14:46:25.136026 [info ] [Thread-1 (]: 2 of 8 START sql view model dbo.claims_agg ..................................... [RUN]
[0m14:46:25.136026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.admissions_enriched, now model.readmit_risk.claims_agg)
[0m14:46:25.136026 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.claims_agg
[0m14:46:25.136026 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.claims_agg"
[0m14:46:25.136026 [debug] [Thread-1 (]: Began executing node model.readmit_risk.claims_agg
[0m14:46:25.161576 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.claims_agg"
[0m14:46:25.162661 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.claims_agg"
[0m14:46:25.163665 [debug] [Thread-1 (]: On model.readmit_risk.claims_agg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.claims_agg"} */
USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."claims_agg__dbt_tmp" as 

select
  admission_id,
  patient_id,
  count(*) as claims_count,
  sum(coalesce(amount_billed,0)) as sum_billed,
  sum(coalesce(amount_paid,0)) as sum_paid,
  case when sum(coalesce(amount_billed,0)) = 0 then null
       else sum(coalesce(amount_paid,0))/nullif(sum(coalesce(amount_billed,0)),0) end as paid_ratio
from "ReadmitDB"."dbo"."stg_claims"
group by admission_id, patient_id
;
-- This query aggregates claims data by admission and patient, calculating the total number of claims,
-- total billed amount, total paid amount, and the paid ratio.
-- It uses the staging table ''stg_claims'' to ensure that the data is normalized and cleaned before aggregation.
-- The materialization is set to ''view'' for efficient querying and updates.
-- The ''coalesce'' function is used to handle any null values in the ''amount_billed'' and ''amount_paid'' fields,
-- ensuring that the calculations are robust against missing data.
-- The ''nullif'' function is used to avoid division by zero when calculating the paid ratio.
-- The ''group by'' clause ensures that the aggregation is done per admission and patient, allowing
-- for detailed insights into claims data.
-- This query is suitable for staging in a data pipeline, providing a summarized view of claims data
-- for further analysis.;
    ')


[0m14:46:25.163665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:25.164579 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:46:25.164579 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:46:25.166873 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.177142 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.claims_agg"
[0m14:46:25.178249 [debug] [Thread-1 (]: On model.readmit_risk.claims_agg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.claims_agg"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.claims_agg', 'claims_agg__dbt_backup'
[0m14:46:25.178249 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.178249 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.claims_agg"
[0m14:46:25.178249 [debug] [Thread-1 (]: On model.readmit_risk.claims_agg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.claims_agg"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.claims_agg__dbt_tmp', 'claims_agg'
[0m14:46:25.194394 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.194394 [debug] [Thread-1 (]: On model.readmit_risk.claims_agg: COMMIT
[0m14:46:25.194394 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."claims_agg__dbt_backup"
[0m14:46:25.194394 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:46:25.194394 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.claims_agg"
[0m14:46:25.194394 [debug] [Thread-1 (]: On model.readmit_risk.claims_agg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.claims_agg"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'claims_agg__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:46:25.235710 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.238717 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.claims_agg"
[0m14:46:25.239708 [debug] [Thread-1 (]: On model.readmit_risk.claims_agg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.claims_agg"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."claims_agg__dbt_backup";');

[0m14:46:25.242712 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.242712 [debug] [Thread-1 (]: On model.readmit_risk.claims_agg: ROLLBACK
[0m14:46:25.242712 [debug] [Thread-1 (]: On model.readmit_risk.claims_agg: Close
[0m14:46:25.242712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc608fec-b0e4-4016-9b03-106391734b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D306815ED0>]}
[0m14:46:25.242712 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dbo.claims_agg ................................ [[32mOK[0m in 0.11s]
[0m14:46:25.242712 [debug] [Thread-1 (]: Finished running node model.readmit_risk.claims_agg
[0m14:46:25.242712 [debug] [Thread-1 (]: Began running node model.readmit_risk.labs_latest
[0m14:46:25.242712 [info ] [Thread-1 (]: 3 of 8 START sql view model dbo.labs_latest .................................... [RUN]
[0m14:46:25.242712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.claims_agg, now model.readmit_risk.labs_latest)
[0m14:46:25.242712 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.labs_latest
[0m14:46:25.258369 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.labs_latest"
[0m14:46:25.260935 [debug] [Thread-1 (]: Began executing node model.readmit_risk.labs_latest
[0m14:46:25.265563 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.labs_latest"
[0m14:46:25.265563 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.labs_latest"
[0m14:46:25.265563 [debug] [Thread-1 (]: On model.readmit_risk.labs_latest: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.labs_latest"} */
USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."labs_latest__dbt_tmp" as 

with ranked as (
  select
    lab_id,
    admission_id,
    patient_id,
    lab_date,
    glucose_mgdl,
    hba1c_pct,
    creatinine_mgdl,
    systolic_bp,
    row_number() over (partition by admission_id order by lab_date desc) as rn
  from "ReadmitDB"."dbo"."stg_labs"
)
select
  lab_id,
  admission_id,
  patient_id,
  lab_date,
  glucose_mgdl,
  hba1c_pct,
  creatinine_mgdl,
  systolic_bp,
  case when glucose_mgdl > 180 then 1 else 0 end as high_glucose_flag,
  case when hba1c_pct > 8.0 then 1 else 0 end as high_hba1c_flag,
  case when creatinine_mgdl > 1.5 then 1 else 0 end as high_creatinine_flag,
  case when systolic_bp > 160 then 1 else 0 end as high_sbp_flag
from ranked
where rn = 1
;
-- This query selects the latest lab results per admission, casting numeric values and flagging abnormal results.
-- It uses a common table expression (CTE) to rank labs by date and filters to keep only the most recent lab for each admission.
-- The flags indicate whether the lab results exceed predefined thresholds for glucose, HbA1c, creatinine, and systolic blood pressure.
-- Adjust the thresholds as needed based on clinical guidelines or requirements.
-- This query is suitable for staging in a data pipeline, ensuring that only the most relevant lab results are processed further.
-- The materialization is set to ''view'' for efficient querying and updates.;
    ')


[0m14:46:25.265563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:25.265563 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:46:25.265563 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:46:25.281727 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.284755 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.labs_latest"
[0m14:46:25.284755 [debug] [Thread-1 (]: On model.readmit_risk.labs_latest: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.labs_latest"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.labs_latest', 'labs_latest__dbt_backup'
[0m14:46:25.295063 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.295063 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.labs_latest"
[0m14:46:25.295063 [debug] [Thread-1 (]: On model.readmit_risk.labs_latest: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.labs_latest"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.labs_latest__dbt_tmp', 'labs_latest'
[0m14:46:25.295063 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.295063 [debug] [Thread-1 (]: On model.readmit_risk.labs_latest: COMMIT
[0m14:46:25.311716 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."labs_latest__dbt_backup"
[0m14:46:25.311716 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:46:25.311716 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.labs_latest"
[0m14:46:25.311716 [debug] [Thread-1 (]: On model.readmit_risk.labs_latest: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.labs_latest"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'labs_latest__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:46:25.349256 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.352255 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.labs_latest"
[0m14:46:25.352255 [debug] [Thread-1 (]: On model.readmit_risk.labs_latest: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.labs_latest"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."labs_latest__dbt_backup";');

[0m14:46:25.357519 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.359624 [debug] [Thread-1 (]: On model.readmit_risk.labs_latest: ROLLBACK
[0m14:46:25.359624 [debug] [Thread-1 (]: On model.readmit_risk.labs_latest: Close
[0m14:46:25.359624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc608fec-b0e4-4016-9b03-106391734b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D305C2A750>]}
[0m14:46:25.359624 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dbo.labs_latest ............................... [[32mOK[0m in 0.12s]
[0m14:46:25.359624 [debug] [Thread-1 (]: Finished running node model.readmit_risk.labs_latest
[0m14:46:25.359624 [debug] [Thread-1 (]: Began running node model.readmit_risk.patients_enriched
[0m14:46:25.359624 [info ] [Thread-1 (]: 4 of 8 START sql table model dbo.patients_enriched ............................. [RUN]
[0m14:46:25.359624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.labs_latest, now model.readmit_risk.patients_enriched)
[0m14:46:25.359624 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.patients_enriched
[0m14:46:25.359624 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.patients_enriched"
[0m14:46:25.359624 [debug] [Thread-1 (]: Began executing node model.readmit_risk.patients_enriched
[0m14:46:25.375319 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:46:25.377670 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."patients_enriched__dbt_tmp__dbt_tmp_vw"
[0m14:46:25.378111 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:46:25.378611 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.patients_enriched"
[0m14:46:25.378611 [debug] [Thread-1 (]: On model.readmit_risk.patients_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.patients_enriched"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'patients_enriched__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:46:25.379705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:25.379705 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:46:25.379705 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:46:25.411802 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.411802 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.patients_enriched"
[0m14:46:25.411802 [debug] [Thread-1 (]: On model.readmit_risk.patients_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.patients_enriched"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."patients_enriched__dbt_tmp__dbt_tmp_vw";');

[0m14:46:25.411802 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.411802 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.patients_enriched"
[0m14:46:25.426099 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.patients_enriched"
[0m14:46:25.427881 [debug] [Thread-1 (]: On model.readmit_risk.patients_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.patients_enriched"} */

  
    USE [ReadmitDB];
    USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."patients_enriched__dbt_tmp__dbt_tmp_vw" as 

select
  patient_id,
  gender,
  ethnicity,
  smoker,
  alcohol_use,
  bmi,
  ses_index,
  birth_year,
  -- approximate age now
  (year(getdate()) - try_cast(birth_year as int)) as age,
  case
    when ses_index is not null and ses_index < 35 then ''low''
    when ses_index is not null and ses_index >= 35 and ses_index < 65 then ''mid''
    when ses_index is not null and ses_index >= 65 then ''high''
    else null end as ses_group
from "ReadmitDB"."dbo"."stg_patients"
;;
    ')

EXEC('
            SELECT * INTO "ReadmitDB"."dbo"."patients_enriched__dbt_tmp" FROM "ReadmitDB"."dbo"."patients_enriched__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.patients_enriched__dbt_tmp__dbt_tmp_vw')



    
    use [ReadmitDB];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_patients_enriched__dbt_tmp_cci'
        AND object_id=object_id('dbo_patients_enriched__dbt_tmp')
    )
    DROP index "dbo"."patients_enriched__dbt_tmp".dbo_patients_enriched__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_patients_enriched__dbt_tmp_cci
    ON "dbo"."patients_enriched__dbt_tmp"

   


  
[0m14:46:25.523072 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.538758 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.patients_enriched"
[0m14:46:25.538758 [debug] [Thread-1 (]: On model.readmit_risk.patients_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.patients_enriched"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.patients_enriched', 'patients_enriched__dbt_backup'
[0m14:46:25.538758 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.538758 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.patients_enriched"
[0m14:46:25.538758 [debug] [Thread-1 (]: On model.readmit_risk.patients_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.patients_enriched"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.patients_enriched__dbt_tmp', 'patients_enriched'
[0m14:46:25.554318 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.554318 [debug] [Thread-1 (]: On model.readmit_risk.patients_enriched: COMMIT
[0m14:46:25.554318 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."patients_enriched__dbt_backup"
[0m14:46:25.554318 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.patients_enriched"
[0m14:46:25.554318 [debug] [Thread-1 (]: On model.readmit_risk.patients_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.patients_enriched"} */

      
    USE [ReadmitDB];
    EXEC('DROP table IF EXISTS "dbo"."patients_enriched__dbt_backup";');

[0m14:46:25.570013 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.570013 [debug] [Thread-1 (]: On model.readmit_risk.patients_enriched: Close
[0m14:46:25.570013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc608fec-b0e4-4016-9b03-106391734b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3042BBC10>]}
[0m14:46:25.570013 [info ] [Thread-1 (]: 4 of 8 OK created sql table model dbo.patients_enriched ........................ [[32mOK[0m in 0.21s]
[0m14:46:25.570013 [debug] [Thread-1 (]: Finished running node model.readmit_risk.patients_enriched
[0m14:46:25.570013 [debug] [Thread-1 (]: Began running node model.readmit_risk.pharmacy_agg
[0m14:46:25.570013 [info ] [Thread-1 (]: 5 of 8 START sql view model dbo.pharmacy_agg ................................... [RUN]
[0m14:46:25.570013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.patients_enriched, now model.readmit_risk.pharmacy_agg)
[0m14:46:25.570013 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.pharmacy_agg
[0m14:46:25.585591 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.pharmacy_agg"
[0m14:46:25.586566 [debug] [Thread-1 (]: Began executing node model.readmit_risk.pharmacy_agg
[0m14:46:25.590209 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.pharmacy_agg"
[0m14:46:25.591208 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.pharmacy_agg"
[0m14:46:25.592271 [debug] [Thread-1 (]: On model.readmit_risk.pharmacy_agg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.pharmacy_agg"} */
USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."pharmacy_agg__dbt_tmp" as 

select
  admission_id,
  patient_id,
  count(*) as rx_count,
  sum(coalesce(days_supply,0)) as total_days_supply,
  avg(coalesce(adherence_rate,0)) as avg_adherence
from "ReadmitDB"."dbo"."stg_pharmacy"
group by admission_id, patient_id
;
-- This query aggregates pharmacy data by admission and patient, calculating the total number of prescriptions,
-- total days supply, and average adherence rate.
-- It uses the staging table ''stg_pharmacy'' to ensure that the data is normalized and cleaned before aggregation.
-- The materialization is set to ''view'' for efficient querying and updates.
-- The ''coalesce'' function is used to handle any null values in the ''days_supply'' and ''adherence_rate'' fields,
-- ensuring that the calculations are robust against missing data.
-- The ''group by'' clause ensures that the aggregation is done per admission and patient, allowing for detailed insights into pharmacy usage.
-- This query is suitable for staging in a data pipeline, providing a summarized view of pharmacy data  for further analysis.;
    ')


[0m14:46:25.592497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:25.592497 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:46:25.592497 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:46:25.599472 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.600747 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.pharmacy_agg"
[0m14:46:25.600747 [debug] [Thread-1 (]: On model.readmit_risk.pharmacy_agg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.pharmacy_agg"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.pharmacy_agg', 'pharmacy_agg__dbt_backup'
[0m14:46:25.611373 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.611373 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.pharmacy_agg"
[0m14:46:25.611373 [debug] [Thread-1 (]: On model.readmit_risk.pharmacy_agg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.pharmacy_agg"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.pharmacy_agg__dbt_tmp', 'pharmacy_agg'
[0m14:46:25.611373 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.611373 [debug] [Thread-1 (]: On model.readmit_risk.pharmacy_agg: COMMIT
[0m14:46:25.625985 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."pharmacy_agg__dbt_backup"
[0m14:46:25.626988 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:46:25.626988 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.pharmacy_agg"
[0m14:46:25.627646 [debug] [Thread-1 (]: On model.readmit_risk.pharmacy_agg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.pharmacy_agg"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'pharmacy_agg__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:46:25.662019 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.665091 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.pharmacy_agg"
[0m14:46:25.666096 [debug] [Thread-1 (]: On model.readmit_risk.pharmacy_agg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.pharmacy_agg"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."pharmacy_agg__dbt_backup";');

[0m14:46:25.671340 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.674467 [debug] [Thread-1 (]: On model.readmit_risk.pharmacy_agg: ROLLBACK
[0m14:46:25.675467 [debug] [Thread-1 (]: On model.readmit_risk.pharmacy_agg: Close
[0m14:46:25.676697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc608fec-b0e4-4016-9b03-106391734b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3061F0090>]}
[0m14:46:25.676697 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dbo.pharmacy_agg .............................. [[32mOK[0m in 0.11s]
[0m14:46:25.676697 [debug] [Thread-1 (]: Finished running node model.readmit_risk.pharmacy_agg
[0m14:46:25.676697 [debug] [Thread-1 (]: Began running node model.readmit_risk.dim_patient
[0m14:46:25.676697 [info ] [Thread-1 (]: 6 of 8 START sql table model dbo.dim_patient ................................... [RUN]
[0m14:46:25.676697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.pharmacy_agg, now model.readmit_risk.dim_patient)
[0m14:46:25.676697 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.dim_patient
[0m14:46:25.676697 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.dim_patient"
[0m14:46:25.676697 [debug] [Thread-1 (]: Began executing node model.readmit_risk.dim_patient
[0m14:46:25.676697 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:46:25.692389 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."dim_patient__dbt_tmp__dbt_tmp_vw"
[0m14:46:25.693520 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:46:25.694779 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.dim_patient"
[0m14:46:25.694779 [debug] [Thread-1 (]: On model.readmit_risk.dim_patient: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.dim_patient"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'dim_patient__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:46:25.695292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:25.695951 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:46:25.695951 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:46:25.727965 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.727965 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.dim_patient"
[0m14:46:25.727965 [debug] [Thread-1 (]: On model.readmit_risk.dim_patient: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.dim_patient"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."dim_patient__dbt_tmp__dbt_tmp_vw";');

[0m14:46:25.727965 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.727965 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.dim_patient"
[0m14:46:25.727965 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.dim_patient"
[0m14:46:25.727965 [debug] [Thread-1 (]: On model.readmit_risk.dim_patient: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.dim_patient"} */

  
    USE [ReadmitDB];
    USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."dim_patient__dbt_tmp__dbt_tmp_vw" as 

with adm_dx as (
  select patient_id,
    max(case when primary_icd10 = ''E11'' then 1 else 0 end) as ever_diabetes,
    max(case when primary_icd10 = ''I50'' then 1 else 0 end) as ever_heart_failure,
    max(case when primary_icd10 = ''J44'' then 1 else 0 end) as ever_copd,
    max(case when primary_icd10 = ''N18'' then 1 else 0 end) as ever_ckd
  from "ReadmitDB"."dbo"."stg_admissions"
  group by patient_id
)

select
  p.*,
  coalesce(ad.ever_diabetes,0) as ever_diabetes,
  coalesce(ad.ever_heart_failure,0) as ever_heart_failure,
  coalesce(ad.ever_copd,0) as ever_copd,
  coalesce(ad.ever_ckd,0) as ever_ckd
from "ReadmitDB"."dbo"."patients_enriched" p
left join adm_dx ad on p.patient_id = ad.patient_id
;
-- This query enriches patient data with chronic condition flags based on admissions.
-- It uses a common table expression (CTE) to determine if a patient has ever been  admitted with specific conditions (diabetes, heart failure, COPD, CKD).     
-- The main query selects all patient fields and joins the CTE to add the chronic condition flags.
-- The ''coalesce'' function is used to ensure that if a patient has never been admitted with a condition, the flag will default to 0.    
-- This query is suitable for staging in a data pipeline, providing a comprehensive view of patient data with chronic condition indicators.
-- The materialization is set to ''table'' for efficient querying and storage.
-- Adjust the conditions and flags as needed based on clinical guidelines or requirements.;
    ')

EXEC('
            SELECT * INTO "ReadmitDB"."dbo"."dim_patient__dbt_tmp" FROM "ReadmitDB"."dbo"."dim_patient__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.dim_patient__dbt_tmp__dbt_tmp_vw')



    
    use [ReadmitDB];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_dim_patient__dbt_tmp_cci'
        AND object_id=object_id('dbo_dim_patient__dbt_tmp')
    )
    DROP index "dbo"."dim_patient__dbt_tmp".dbo_dim_patient__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_dim_patient__dbt_tmp_cci
    ON "dbo"."dim_patient__dbt_tmp"

   


  
[0m14:46:25.874619 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.874619 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.dim_patient"
[0m14:46:25.874619 [debug] [Thread-1 (]: On model.readmit_risk.dim_patient: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.dim_patient"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.dim_patient', 'dim_patient__dbt_backup'
[0m14:46:25.890295 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.890295 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.dim_patient"
[0m14:46:25.890295 [debug] [Thread-1 (]: On model.readmit_risk.dim_patient: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.dim_patient"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.dim_patient__dbt_tmp', 'dim_patient'
[0m14:46:25.905911 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.905911 [debug] [Thread-1 (]: On model.readmit_risk.dim_patient: COMMIT
[0m14:46:25.905911 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."dim_patient__dbt_backup"
[0m14:46:25.905911 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.dim_patient"
[0m14:46:25.905911 [debug] [Thread-1 (]: On model.readmit_risk.dim_patient: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.dim_patient"} */

      
    USE [ReadmitDB];
    EXEC('DROP table IF EXISTS "dbo"."dim_patient__dbt_backup";');

[0m14:46:25.905911 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.921551 [debug] [Thread-1 (]: On model.readmit_risk.dim_patient: Close
[0m14:46:25.921551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc608fec-b0e4-4016-9b03-106391734b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D306160E10>]}
[0m14:46:25.921551 [info ] [Thread-1 (]: 6 of 8 OK created sql table model dbo.dim_patient .............................. [[32mOK[0m in 0.24s]
[0m14:46:25.921551 [debug] [Thread-1 (]: Finished running node model.readmit_risk.dim_patient
[0m14:46:25.921551 [debug] [Thread-1 (]: Began running node model.readmit_risk.fact_readmissions
[0m14:46:25.921551 [info ] [Thread-1 (]: 7 of 8 START sql table model dbo.fact_readmissions ............................. [RUN]
[0m14:46:25.921551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.dim_patient, now model.readmit_risk.fact_readmissions)
[0m14:46:25.921551 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.fact_readmissions
[0m14:46:25.921551 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.fact_readmissions"
[0m14:46:25.921551 [debug] [Thread-1 (]: Began executing node model.readmit_risk.fact_readmissions
[0m14:46:25.921551 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:46:25.937231 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."fact_readmissions__dbt_tmp__dbt_tmp_vw"
[0m14:46:25.937231 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:46:25.938463 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.fact_readmissions"
[0m14:46:25.938463 [debug] [Thread-1 (]: On model.readmit_risk.fact_readmissions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.fact_readmissions"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'fact_readmissions__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:46:25.939319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:25.939706 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:46:25.940253 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:46:25.965677 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.975840 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.fact_readmissions"
[0m14:46:25.976887 [debug] [Thread-1 (]: On model.readmit_risk.fact_readmissions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.fact_readmissions"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."fact_readmissions__dbt_tmp__dbt_tmp_vw";');

[0m14:46:25.977745 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:25.977745 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.fact_readmissions"
[0m14:46:25.977745 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.fact_readmissions"
[0m14:46:25.977745 [debug] [Thread-1 (]: On model.readmit_risk.fact_readmissions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.fact_readmissions"} */

  
    USE [ReadmitDB];
    USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."fact_readmissions__dbt_tmp__dbt_tmp_vw" as 

select
  a.admission_id,
  a.patient_id,
  a.admit_date,
  a.discharge_date,
  a.length_of_stay,
  a.prior_admissions,
  a.department,
  a.primary_icd10,
  coalesce(c.sum_billed,0) as sum_billed,
  coalesce(c.sum_paid,0) as sum_paid,
  coalesce(p.avg_adherence, 0) as avg_adherence,
  coalesce(l.high_hba1c_flag,0) as high_hba1c_flag,
  a.readmitted_within_30 as label_readmit_30
from "ReadmitDB"."dbo"."admissions_enriched" a
left join "ReadmitDB"."dbo"."claims_agg" c   on a.admission_id = c.admission_id
left join "ReadmitDB"."dbo"."pharmacy_agg" p  on a.admission_id = p.admission_id
left join "ReadmitDB"."dbo"."labs_latest" l   on a.admission_id = l.admission_id
;
-- This query aggregates data from admissions, claims, pharmacy, and labs to create a comprehensive view of each admission.
-- It selects key fields from the admissions table and joins with aggregated claims, pharmacy, and labs data.
-- The ''coalesce'' function is used to handle any null values in the claims and pharmacy data, ensuring that the final dataset is complete.  
-- The ''left join'' ensures that even if there are no claims, pharmacy, or labs data for an admission, the admission record will still be included.
-- The materialization is set to ''table'' for efficient querying and storage.
-- This query is suitable for staging in a data pipeline, providing a rich dataset for further analysis or modeling.;
    ')

EXEC('
            SELECT * INTO "ReadmitDB"."dbo"."fact_readmissions__dbt_tmp" FROM "ReadmitDB"."dbo"."fact_readmissions__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.fact_readmissions__dbt_tmp__dbt_tmp_vw')



    
    use [ReadmitDB];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_fact_readmissions__dbt_tmp_cci'
        AND object_id=object_id('dbo_fact_readmissions__dbt_tmp')
    )
    DROP index "dbo"."fact_readmissions__dbt_tmp".dbo_fact_readmissions__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_fact_readmissions__dbt_tmp_cci
    ON "dbo"."fact_readmissions__dbt_tmp"

   


  
[0m14:46:26.230066 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:26.245687 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.fact_readmissions"
[0m14:46:26.245687 [debug] [Thread-1 (]: On model.readmit_risk.fact_readmissions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.fact_readmissions"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.fact_readmissions', 'fact_readmissions__dbt_backup'
[0m14:46:26.245687 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:26.245687 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.fact_readmissions"
[0m14:46:26.245687 [debug] [Thread-1 (]: On model.readmit_risk.fact_readmissions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.fact_readmissions"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.fact_readmissions__dbt_tmp', 'fact_readmissions'
[0m14:46:26.261935 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:26.261935 [debug] [Thread-1 (]: On model.readmit_risk.fact_readmissions: COMMIT
[0m14:46:26.261935 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."fact_readmissions__dbt_backup"
[0m14:46:26.261935 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.fact_readmissions"
[0m14:46:26.261935 [debug] [Thread-1 (]: On model.readmit_risk.fact_readmissions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.fact_readmissions"} */

      
    USE [ReadmitDB];
    EXEC('DROP table IF EXISTS "dbo"."fact_readmissions__dbt_backup";');

[0m14:46:26.276949 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:26.276949 [debug] [Thread-1 (]: On model.readmit_risk.fact_readmissions: Close
[0m14:46:26.276949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc608fec-b0e4-4016-9b03-106391734b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3068383D0>]}
[0m14:46:26.276949 [info ] [Thread-1 (]: 7 of 8 OK created sql table model dbo.fact_readmissions ........................ [[32mOK[0m in 0.36s]
[0m14:46:26.276949 [debug] [Thread-1 (]: Finished running node model.readmit_risk.fact_readmissions
[0m14:46:26.276949 [debug] [Thread-1 (]: Began running node model.readmit_risk.features_ml
[0m14:46:26.276949 [info ] [Thread-1 (]: 8 of 8 START sql table model dbo.features_ml ................................... [RUN]
[0m14:46:26.276949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.fact_readmissions, now model.readmit_risk.features_ml)
[0m14:46:26.276949 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.features_ml
[0m14:46:26.276949 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.features_ml"
[0m14:46:26.276949 [debug] [Thread-1 (]: Began executing node model.readmit_risk.features_ml
[0m14:46:26.294051 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:46:26.296571 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."features_ml__dbt_tmp__dbt_tmp_vw"
[0m14:46:26.297664 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:46:26.297664 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m14:46:26.298665 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'features_ml__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:46:26.298665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:26.298665 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:46:26.299854 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m14:46:26.328219 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:26.328219 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m14:46:26.328219 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."features_ml__dbt_tmp__dbt_tmp_vw";');

[0m14:46:26.328219 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:26.328219 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.features_ml"
[0m14:46:26.328219 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m14:46:26.328219 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

  
    USE [ReadmitDB];
    USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."features_ml__dbt_tmp__dbt_tmp_vw" as 

select
  f.admission_id,
  f.patient_id,
  dp.age,
  dp.gender,
  dp.ethnicity,
  dp.bmi,
  dp.ses_group,
  dp.ever_diabetes,
  dp.ever_heart_failure,
  dp.ever_copd,
  dp.ever_ckd,
  f.length_of_stay,
  f.prior_admissions,
  f.department,
  f.sum_billed,
  f.sum_paid,
  f.avg_adherence,
  f.high_hba1c_flag,
  f.label_readmit_30 as readmit_label
from "ReadmitDB"."dbo"."fact_readmissions" f
left join "ReadmitDB"."dbo"."dim_patient" dp on f.patient_id = dp.patient_id
;
-- This query combines the fact_readmissions data with enriched patient data to create a comprehensive view of each admission.  
-- It selects key fields from the fact_readmissions table and joins with the dim_patient table to include patient demographics and chronic condition flags.
-- The ''left join'' ensures that even if there are no matching patient records, the admission    
-- record will still be included in the final dataset.
-- The materialization is set to ''table'' for efficient querying and storage.
-- This query is suitable for staging in a data pipeline, providing a rich dataset for further analysis or modeling.
-- The ''readmit_label'' field indicates whether the patient was readmitted within 30 days of discharge, which is crucial for readmission risk analysis.;
    ')

EXEC('
            SELECT * INTO "ReadmitDB"."dbo"."features_ml__dbt_tmp" FROM "ReadmitDB"."dbo"."features_ml__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.features_ml__dbt_tmp__dbt_tmp_vw')



    
    use [ReadmitDB];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_features_ml__dbt_tmp_cci'
        AND object_id=object_id('dbo_features_ml__dbt_tmp')
    )
    DROP index "dbo"."features_ml__dbt_tmp".dbo_features_ml__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_features_ml__dbt_tmp_cci
    ON "dbo"."features_ml__dbt_tmp"

   


  
[0m14:46:26.486122 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:26.501818 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m14:46:26.501818 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.features_ml', 'features_ml__dbt_backup'
[0m14:46:26.501818 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:26.517445 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m14:46:26.517445 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.features_ml__dbt_tmp', 'features_ml'
[0m14:46:26.517445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:26.517445 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: COMMIT
[0m14:46:26.517445 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."features_ml__dbt_backup"
[0m14:46:26.517445 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m14:46:26.533060 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

      
    USE [ReadmitDB];
    EXEC('DROP table IF EXISTS "dbo"."features_ml__dbt_backup";');

[0m14:46:26.533060 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:26.533060 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: Close
[0m14:46:26.533060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc608fec-b0e4-4016-9b03-106391734b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3068149D0>]}
[0m14:46:26.533060 [info ] [Thread-1 (]: 8 of 8 OK created sql table model dbo.features_ml .............................. [[32mOK[0m in 0.26s]
[0m14:46:26.533060 [debug] [Thread-1 (]: Finished running node model.readmit_risk.features_ml
[0m14:46:26.533060 [debug] [MainThread]: On master: COMMIT
[0m14:46:26.533060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:46:26.533060 [debug] [MainThread]: Connection 'list_ReadmitDB' was properly closed.
[0m14:46:26.533060 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m14:46:26.533060 [debug] [MainThread]: Connection 'model.readmit_risk.features_ml' was properly closed.
[0m14:46:26.533060 [info ] [MainThread]: 
[0m14:46:26.533060 [info ] [MainThread]: Finished running 5 table models, 3 view models in 0 hours 0 minutes and 2.51 seconds (2.51s).
[0m14:46:26.548466 [debug] [MainThread]: Command end result
[0m14:46:26.567034 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m14:46:26.567034 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m14:46:26.575526 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m14:46:26.576551 [info ] [MainThread]: 
[0m14:46:26.577319 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:46:26.577319 [info ] [MainThread]: 
[0m14:46:26.577319 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m14:46:26.577319 [debug] [MainThread]: Command `dbt run` succeeded at 14:46:26.577319 after 3.41 seconds
[0m14:46:26.577319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3043DBD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3043DBF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D304368710>]}
[0m14:46:26.577319 [debug] [MainThread]: Flushing usage events
[0m14:46:31.390927 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:02:13.139947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3F58D0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF429654D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF42964E10>]}


============================== 15:02:13.139947 | 81d58d79-4773-4f25-896f-ba92dea4f187 ==============================
[0m15:02:13.139947 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:02:13.155571 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m15:02:13.424291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81d58d79-4773-4f25-896f-ba92dea4f187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF41BC5390>]}
[0m15:02:13.471160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81d58d79-4773-4f25-896f-ba92dea4f187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF41BC7C10>]}
[0m15:02:13.471160 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:02:13.615604 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m15:02:13.834285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m15:02:13.834285 [debug] [MainThread]: Partial parsing: added file: readmit_risk://models\core\schema.yml
[0m15:02:13.834285 [debug] [MainThread]: Partial parsing: added file: readmit_risk://models\staging\schema.yml
[0m15:02:13.896820 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'claims_enriched' in the 'models' section of file 'models\core\schema.yml'
[0m15:02:13.896820 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'labs_enriched' in the 'models' section of file 'models\core\schema.yml'
[0m15:02:13.896820 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'pharmacy_enriched' in the 'models' section of file 'models\core\schema.yml'
[0m15:02:14.012443 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:02:14.013185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '81d58d79-4773-4f25-896f-ba92dea4f187', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4499FED0>]}
[0m15:02:14.051818 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.readmit_risk.not_null_claims_enriched_claim_id.bc86ff40d2' (models\core\schema.yml) depends on a node named 'claims_enriched' in package '' which was not found
[0m15:02:14.051818 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.readmit_risk.unique_claims_enriched_claim_id.e459bab564' (models\core\schema.yml) depends on a node named 'claims_enriched' in package '' which was not found
[0m15:02:14.051818 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.readmit_risk.not_null_labs_enriched_lab_id.917247a7e2' (models\core\schema.yml) depends on a node named 'labs_enriched' in package '' which was not found
[0m15:02:14.051818 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.readmit_risk.unique_labs_enriched_lab_id.4104eb1c96' (models\core\schema.yml) depends on a node named 'labs_enriched' in package '' which was not found
[0m15:02:14.051818 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.readmit_risk.not_null_pharmacy_enriched_rx_id.3cd07b5749' (models\core\schema.yml) depends on a node named 'pharmacy_enriched' in package '' which was not found
[0m15:02:14.051818 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.readmit_risk.unique_pharmacy_enriched_rx_id.cb8eaad8cd' (models\core\schema.yml) depends on a node named 'pharmacy_enriched' in package '' which was not found
[0m15:02:14.117970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81d58d79-4773-4f25-896f-ba92dea4f187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF446FEE10>]}
[0m15:02:14.183002 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m15:02:14.183002 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m15:02:14.214195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81d58d79-4773-4f25-896f-ba92dea4f187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF44C5EC10>]}
[0m15:02:14.214195 [info ] [MainThread]: Found 5 seeds, 13 models, 25 data tests, 510 macros
[0m15:02:14.214195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81d58d79-4773-4f25-896f-ba92dea4f187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF44B60490>]}
[0m15:02:14.214195 [info ] [MainThread]: 
[0m15:02:14.214195 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:02:14.229823 [info ] [MainThread]: 
[0m15:02:14.230404 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:02:14.235233 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m15:02:14.249749 [debug] [ThreadPool]: dbt-sqlserver
[0m15:02:14.250753 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m15:02:14.250753 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:02:14.251553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:14.251553 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:14.348703 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:14.395576 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:14.395576 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m15:02:14.395576 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m15:02:14.411197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81d58d79-4773-4f25-896f-ba92dea4f187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF444C73D0>]}
[0m15:02:14.411197 [debug] [MainThread]: On master: COMMIT
[0m15:02:14.411197 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f
[0m15:02:14.411197 [info ] [Thread-1 (]: 1 of 25 START test not_null_admissions_enriched_admission_id ................... [RUN]
[0m15:02:14.411197 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f'
[0m15:02:14.411197 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f
[0m15:02:14.432206 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f"
[0m15:02:14.433205 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f
[0m15:02:14.452879 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f"
[0m15:02:14.452879 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f"
[0m15:02:14.452879 [debug] [Thread-1 (]: On test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5c453eac14f4b87883608ab90631f899_6009]
   as 
    
    
    



select admission_id
from "ReadmitDB"."dbo"."admissions_enriched"
where admission_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5c453eac14f4b87883608ab90631f899_6009]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5c453eac14f4b87883608ab90631f899_6009]
  ;')
[0m15:02:14.452879 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:02:14.452879 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:14.452879 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:14.489155 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:14.496271 [debug] [Thread-1 (]: On test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f: ROLLBACK
[0m15:02:14.497176 [debug] [Thread-1 (]: On test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f: Close
[0m15:02:14.498258 [info ] [Thread-1 (]: 1 of 25 PASS not_null_admissions_enriched_admission_id ......................... [[32mPASS[0m in 0.09s]
[0m15:02:14.499174 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f
[0m15:02:14.500148 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c
[0m15:02:14.500148 [info ] [Thread-1 (]: 2 of 25 START test not_null_fact_readmissions_admission_id ..................... [RUN]
[0m15:02:14.501151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f, now test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c)
[0m15:02:14.501151 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c
[0m15:02:14.505233 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c"
[0m15:02:14.506150 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c
[0m15:02:14.508233 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c"
[0m15:02:14.508233 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c"
[0m15:02:14.509151 [debug] [Thread-1 (]: On test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_8518c4118139c09c218337bd47c210bd_15119]
   as 
    
    
    



select admission_id
from "ReadmitDB"."dbo"."fact_readmissions"
where admission_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_8518c4118139c09c218337bd47c210bd_15119]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_8518c4118139c09c218337bd47c210bd_15119]
  ;')
[0m15:02:14.509151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:14.509151 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:14.510199 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:14.540228 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:14.541408 [debug] [Thread-1 (]: On test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c: ROLLBACK
[0m15:02:14.541408 [debug] [Thread-1 (]: On test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c: Close
[0m15:02:14.541408 [info ] [Thread-1 (]: 2 of 25 PASS not_null_fact_readmissions_admission_id ........................... [[32mPASS[0m in 0.04s]
[0m15:02:14.541408 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c
[0m15:02:14.541408 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0
[0m15:02:14.541408 [info ] [Thread-1 (]: 3 of 25 START test not_null_fact_readmissions_label_readmit_30 ................. [RUN]
[0m15:02:14.541408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c, now test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0)
[0m15:02:14.541408 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0
[0m15:02:14.551423 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0"
[0m15:02:14.551423 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0
[0m15:02:14.551423 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0"
[0m15:02:14.551423 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0"
[0m15:02:14.551423 [debug] [Thread-1 (]: On test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_bed95e4e62bef66f3bfc252fbfff5807_18048]
   as 
    
    
    



select label_readmit_30
from "ReadmitDB"."dbo"."fact_readmissions"
where label_readmit_30 is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_bed95e4e62bef66f3bfc252fbfff5807_18048]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_bed95e4e62bef66f3bfc252fbfff5807_18048]
  ;')
[0m15:02:14.551423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:14.551423 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:14.551423 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:14.586213 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:14.588314 [debug] [Thread-1 (]: On test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0: ROLLBACK
[0m15:02:14.588314 [debug] [Thread-1 (]: On test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0: Close
[0m15:02:14.589284 [info ] [Thread-1 (]: 3 of 25 PASS not_null_fact_readmissions_label_readmit_30 ....................... [[32mPASS[0m in 0.05s]
[0m15:02:14.590212 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0
[0m15:02:14.590212 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46
[0m15:02:14.591394 [info ] [Thread-1 (]: 4 of 25 START test not_null_patients_enriched_patient_id ....................... [RUN]
[0m15:02:14.591394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0, now test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46)
[0m15:02:14.591394 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46
[0m15:02:14.591394 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46"
[0m15:02:14.591394 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46
[0m15:02:14.599567 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46"
[0m15:02:14.600628 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46"
[0m15:02:14.601572 [debug] [Thread-1 (]: On test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_94d3438421080892e10d8a24b6a606e2_6480]
   as 
    
    
    



select patient_id
from "ReadmitDB"."dbo"."patients_enriched"
where patient_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_94d3438421080892e10d8a24b6a606e2_6480]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_94d3438421080892e10d8a24b6a606e2_6480]
  ;')
[0m15:02:14.601930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:14.602820 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:14.603446 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:14.623231 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:14.625388 [debug] [Thread-1 (]: On test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46: ROLLBACK
[0m15:02:14.625388 [debug] [Thread-1 (]: On test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46: Close
[0m15:02:14.625388 [info ] [Thread-1 (]: 4 of 25 PASS not_null_patients_enriched_patient_id ............................. [[32mPASS[0m in 0.03s]
[0m15:02:14.625388 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46
[0m15:02:14.625388 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5
[0m15:02:14.625388 [info ] [Thread-1 (]: 5 of 25 START test not_null_stg_admissions_admission_id ........................ [RUN]
[0m15:02:14.625388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46, now test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5)
[0m15:02:14.625388 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5
[0m15:02:14.634664 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5"
[0m15:02:14.636644 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5
[0m15:02:14.639637 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5"
[0m15:02:14.640728 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5"
[0m15:02:14.640728 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_6caf86b824b61cb476dbbd51dff6c38e_9528]
   as 
    
    
    



select admission_id
from "ReadmitDB"."dbo"."stg_admissions"
where admission_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_6caf86b824b61cb476dbbd51dff6c38e_9528]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_6caf86b824b61cb476dbbd51dff6c38e_9528]
  ;')
[0m15:02:14.640728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:14.640728 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:14.640728 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:14.673469 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:14.673469 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5: ROLLBACK
[0m15:02:14.673469 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5: Close
[0m15:02:14.673469 [info ] [Thread-1 (]: 5 of 25 PASS not_null_stg_admissions_admission_id .............................. [[32mPASS[0m in 0.05s]
[0m15:02:14.673469 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5
[0m15:02:14.673469 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_admissions_patient_id.0706065292
[0m15:02:14.673469 [info ] [Thread-1 (]: 6 of 25 START test not_null_stg_admissions_patient_id .......................... [RUN]
[0m15:02:14.673469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5, now test.readmit_risk.not_null_stg_admissions_patient_id.0706065292)
[0m15:02:14.673469 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_admissions_patient_id.0706065292
[0m15:02:14.685299 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_admissions_patient_id.0706065292"
[0m15:02:14.687328 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_admissions_patient_id.0706065292
[0m15:02:14.690458 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_stg_admissions_patient_id.0706065292"
[0m15:02:14.690458 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_stg_admissions_patient_id.0706065292"
[0m15:02:14.690458 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_admissions_patient_id.0706065292: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_stg_admissions_patient_id.0706065292"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_9c3e890caa51fce66e84ba6ba2d5f68e_11742]
   as 
    
    
    



select patient_id
from "ReadmitDB"."dbo"."stg_admissions"
where patient_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_9c3e890caa51fce66e84ba6ba2d5f68e_11742]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_9c3e890caa51fce66e84ba6ba2d5f68e_11742]
  ;')
[0m15:02:14.690458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:14.690458 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:14.690458 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:14.701230 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:14.701230 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_admissions_patient_id.0706065292: ROLLBACK
[0m15:02:14.701230 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_admissions_patient_id.0706065292: Close
[0m15:02:14.701230 [info ] [Thread-1 (]: 6 of 25 PASS not_null_stg_admissions_patient_id ................................ [[32mPASS[0m in 0.03s]
[0m15:02:14.716086 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_admissions_patient_id.0706065292
[0m15:02:14.717090 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_claims_admission_id.401e003a5b
[0m15:02:14.717090 [info ] [Thread-1 (]: 7 of 25 START test not_null_stg_claims_admission_id ............................ [RUN]
[0m15:02:14.718460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_admissions_patient_id.0706065292, now test.readmit_risk.not_null_stg_claims_admission_id.401e003a5b)
[0m15:02:14.718460 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_claims_admission_id.401e003a5b
[0m15:02:14.722617 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_claims_admission_id.401e003a5b"
[0m15:02:14.722617 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_claims_admission_id.401e003a5b
[0m15:02:14.722617 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_stg_claims_admission_id.401e003a5b"
[0m15:02:14.722617 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_stg_claims_admission_id.401e003a5b"
[0m15:02:14.722617 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_claims_admission_id.401e003a5b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_stg_claims_admission_id.401e003a5b"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_c03fc203d4c060e84c3dc7fa32d2295a_16578]
   as 
    
    
    



select admission_id
from "ReadmitDB"."dbo"."stg_claims"
where admission_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_c03fc203d4c060e84c3dc7fa32d2295a_16578]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_c03fc203d4c060e84c3dc7fa32d2295a_16578]
  ;')
[0m15:02:14.722617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:14.722617 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:14.722617 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:14.749611 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:14.751888 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_claims_admission_id.401e003a5b: ROLLBACK
[0m15:02:14.751888 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_claims_admission_id.401e003a5b: Close
[0m15:02:14.751888 [info ] [Thread-1 (]: 7 of 25 PASS not_null_stg_claims_admission_id .................................. [[32mPASS[0m in 0.03s]
[0m15:02:14.751888 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_claims_admission_id.401e003a5b
[0m15:02:14.751888 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86
[0m15:02:14.751888 [info ] [Thread-1 (]: 8 of 25 START test not_null_stg_claims_claim_id ................................ [RUN]
[0m15:02:14.751888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_claims_admission_id.401e003a5b, now test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86)
[0m15:02:14.751888 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86
[0m15:02:14.751888 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86"
[0m15:02:14.751888 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86
[0m15:02:14.751888 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86"
[0m15:02:14.751888 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86"
[0m15:02:14.751888 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_e922bd79c0894ceb6644cf5252899b27_15754]
   as 
    
    
    



select claim_id
from "ReadmitDB"."dbo"."stg_claims"
where claim_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_e922bd79c0894ceb6644cf5252899b27_15754]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_e922bd79c0894ceb6644cf5252899b27_15754]
  ;')
[0m15:02:14.751888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:14.751888 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:14.751888 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:14.849956 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:14.852073 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86: ROLLBACK
[0m15:02:14.852073 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86: Close
[0m15:02:14.854025 [info ] [Thread-1 (]: 8 of 25 PASS not_null_stg_claims_claim_id ...................................... [[32mPASS[0m in 0.10s]
[0m15:02:14.855009 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86
[0m15:02:14.856033 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_labs_admission_id.d8209d95c3
[0m15:02:14.857002 [info ] [Thread-1 (]: 9 of 25 START test not_null_stg_labs_admission_id .............................. [RUN]
[0m15:02:14.858006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86, now test.readmit_risk.not_null_stg_labs_admission_id.d8209d95c3)
[0m15:02:14.859014 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_labs_admission_id.d8209d95c3
[0m15:02:14.864033 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_labs_admission_id.d8209d95c3"
[0m15:02:14.865006 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_labs_admission_id.d8209d95c3
[0m15:02:14.867806 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_stg_labs_admission_id.d8209d95c3"
[0m15:02:14.868319 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_stg_labs_admission_id.d8209d95c3"
[0m15:02:14.869407 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_labs_admission_id.d8209d95c3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_stg_labs_admission_id.d8209d95c3"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_c2eb9b7a57c54d56eabd790be9090ddf_7871]
   as 
    
    
    



select admission_id
from "ReadmitDB"."dbo"."stg_labs"
where admission_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_c2eb9b7a57c54d56eabd790be9090ddf_7871]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_c2eb9b7a57c54d56eabd790be9090ddf_7871]
  ;')
[0m15:02:14.869407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:14.869407 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:14.870490 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:14.884589 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:14.884589 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_labs_admission_id.d8209d95c3: ROLLBACK
[0m15:02:14.884589 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_labs_admission_id.d8209d95c3: Close
[0m15:02:14.884589 [info ] [Thread-1 (]: 9 of 25 PASS not_null_stg_labs_admission_id .................................... [[32mPASS[0m in 0.03s]
[0m15:02:14.884589 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_labs_admission_id.d8209d95c3
[0m15:02:14.884589 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_labs_lab_id.e63312a399
[0m15:02:14.884589 [info ] [Thread-1 (]: 10 of 25 START test not_null_stg_labs_lab_id ................................... [RUN]
[0m15:02:14.899515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_labs_admission_id.d8209d95c3, now test.readmit_risk.not_null_stg_labs_lab_id.e63312a399)
[0m15:02:14.900588 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_labs_lab_id.e63312a399
[0m15:02:14.903556 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_labs_lab_id.e63312a399"
[0m15:02:14.905519 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_labs_lab_id.e63312a399
[0m15:02:14.907598 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_stg_labs_lab_id.e63312a399"
[0m15:02:14.908599 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_stg_labs_lab_id.e63312a399"
[0m15:02:14.908599 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_labs_lab_id.e63312a399: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_stg_labs_lab_id.e63312a399"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_01d2387f9cbc9946d6a351a30426951d_6591]
   as 
    
    
    



select lab_id
from "ReadmitDB"."dbo"."stg_labs"
where lab_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_01d2387f9cbc9946d6a351a30426951d_6591]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_01d2387f9cbc9946d6a351a30426951d_6591]
  ;')
[0m15:02:14.909602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:14.909602 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:14.909602 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:14.978242 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:14.980236 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_labs_lab_id.e63312a399: ROLLBACK
[0m15:02:14.981244 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_labs_lab_id.e63312a399: Close
[0m15:02:14.983174 [info ] [Thread-1 (]: 10 of 25 PASS not_null_stg_labs_lab_id ......................................... [[32mPASS[0m in 0.08s]
[0m15:02:14.984227 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_labs_lab_id.e63312a399
[0m15:02:14.985228 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_patients_patient_id.e578180344
[0m15:02:14.986220 [info ] [Thread-1 (]: 11 of 25 START test not_null_stg_patients_patient_id ........................... [RUN]
[0m15:02:14.988197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_labs_lab_id.e63312a399, now test.readmit_risk.not_null_stg_patients_patient_id.e578180344)
[0m15:02:14.989220 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_patients_patient_id.e578180344
[0m15:02:14.996222 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_patients_patient_id.e578180344"
[0m15:02:14.997188 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_patients_patient_id.e578180344
[0m15:02:15.002997 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_stg_patients_patient_id.e578180344"
[0m15:02:15.005116 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_stg_patients_patient_id.e578180344"
[0m15:02:15.005116 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_patients_patient_id.e578180344: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_stg_patients_patient_id.e578180344"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_d785b63395cf96495c19c2bc30bdcf33_18346]
   as 
    
    
    



select patient_id
from "ReadmitDB"."dbo"."stg_patients"
where patient_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_d785b63395cf96495c19c2bc30bdcf33_18346]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_d785b63395cf96495c19c2bc30bdcf33_18346]
  ;')
[0m15:02:15.005116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:15.005116 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:15.005116 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:15.024243 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:15.035673 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_patients_patient_id.e578180344: ROLLBACK
[0m15:02:15.035673 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_patients_patient_id.e578180344: Close
[0m15:02:15.035673 [info ] [Thread-1 (]: 11 of 25 PASS not_null_stg_patients_patient_id ................................. [[32mPASS[0m in 0.05s]
[0m15:02:15.035673 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_patients_patient_id.e578180344
[0m15:02:15.035673 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_pharmacy_admission_id.741ca04761
[0m15:02:15.035673 [info ] [Thread-1 (]: 12 of 25 START test not_null_stg_pharmacy_admission_id ......................... [RUN]
[0m15:02:15.035673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_patients_patient_id.e578180344, now test.readmit_risk.not_null_stg_pharmacy_admission_id.741ca04761)
[0m15:02:15.035673 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_pharmacy_admission_id.741ca04761
[0m15:02:15.035673 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_pharmacy_admission_id.741ca04761"
[0m15:02:15.035673 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_pharmacy_admission_id.741ca04761
[0m15:02:15.035673 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_stg_pharmacy_admission_id.741ca04761"
[0m15:02:15.035673 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_stg_pharmacy_admission_id.741ca04761"
[0m15:02:15.035673 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_pharmacy_admission_id.741ca04761: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_stg_pharmacy_admission_id.741ca04761"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_fc9c7534c1f643852974453ed028ab8d_9652]
   as 
    
    
    



select admission_id
from "ReadmitDB"."dbo"."stg_pharmacy"
where admission_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_fc9c7534c1f643852974453ed028ab8d_9652]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_fc9c7534c1f643852974453ed028ab8d_9652]
  ;')
[0m15:02:15.049292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:15.050809 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:15.051551 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:15.056804 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:15.068043 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_pharmacy_admission_id.741ca04761: ROLLBACK
[0m15:02:15.069738 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_pharmacy_admission_id.741ca04761: Close
[0m15:02:15.069738 [info ] [Thread-1 (]: 12 of 25 PASS not_null_stg_pharmacy_admission_id ............................... [[32mPASS[0m in 0.03s]
[0m15:02:15.070798 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_pharmacy_admission_id.741ca04761
[0m15:02:15.071782 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a
[0m15:02:15.071782 [info ] [Thread-1 (]: 13 of 25 START test not_null_stg_pharmacy_rx_id ................................ [RUN]
[0m15:02:15.072784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_pharmacy_admission_id.741ca04761, now test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a)
[0m15:02:15.073913 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a
[0m15:02:15.073913 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a"
[0m15:02:15.073913 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a
[0m15:02:15.073913 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a"
[0m15:02:15.073913 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a"
[0m15:02:15.073913 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2d910e2f44338ff44779abeb89ab41e6_3632]
   as 
    
    
    



select rx_id
from "ReadmitDB"."dbo"."stg_pharmacy"
where rx_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2d910e2f44338ff44779abeb89ab41e6_3632]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2d910e2f44338ff44779abeb89ab41e6_3632]
  ;')
[0m15:02:15.082602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:15.082602 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:15.083608 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:15.118231 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:15.118231 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a: ROLLBACK
[0m15:02:15.118231 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a: Close
[0m15:02:15.132736 [info ] [Thread-1 (]: 13 of 25 PASS not_null_stg_pharmacy_rx_id ...................................... [[32mPASS[0m in 0.05s]
[0m15:02:15.134793 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a
[0m15:02:15.134793 [debug] [Thread-1 (]: Began running node test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba
[0m15:02:15.137416 [info ] [Thread-1 (]: 14 of 25 START test relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_  [RUN]
[0m15:02:15.137416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a, now test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba)
[0m15:02:15.137416 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba
[0m15:02:15.144096 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba"
[0m15:02:15.145264 [debug] [Thread-1 (]: Began executing node test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba
[0m15:02:15.145264 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba"
[0m15:02:15.145264 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba"
[0m15:02:15.149293 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_6fe3d2cf03bdaf136ebd996395045920_17761]
   as 
    
    
    

with child as (
    select patient_id as from_field
    from "ReadmitDB"."dbo"."stg_admissions"
    where patient_id is not null
),

parent as (
    select patient_id as to_field
    from "ReadmitDB"."dbo"."stg_patients"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_6fe3d2cf03bdaf136ebd996395045920_17761]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_6fe3d2cf03bdaf136ebd996395045920_17761]
  ;')
[0m15:02:15.150298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:15.150298 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:15.151300 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:15.186078 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:15.186078 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba: ROLLBACK
[0m15:02:15.186078 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba: Close
[0m15:02:15.186078 [info ] [Thread-1 (]: 14 of 25 PASS relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_  [[32mPASS[0m in 0.05s]
[0m15:02:15.186078 [debug] [Thread-1 (]: Finished running node test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba
[0m15:02:15.186078 [debug] [Thread-1 (]: Began running node test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c
[0m15:02:15.186078 [info ] [Thread-1 (]: 15 of 25 START test relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_  [RUN]
[0m15:02:15.201455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba, now test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c)
[0m15:02:15.202322 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c
[0m15:02:15.202322 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c"
[0m15:02:15.202322 [debug] [Thread-1 (]: Began executing node test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c
[0m15:02:15.202322 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c"
[0m15:02:15.202322 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c"
[0m15:02:15.202322 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7e5205100ca21ba063b1798634d334a6_1574]
   as 
    
    
    

with child as (
    select admission_id as from_field
    from "ReadmitDB"."dbo"."stg_claims"
    where admission_id is not null
),

parent as (
    select admission_id as to_field
    from "ReadmitDB"."dbo"."stg_admissions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7e5205100ca21ba063b1798634d334a6_1574]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7e5205100ca21ba063b1798634d334a6_1574]
  ;')
[0m15:02:15.202322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:15.202322 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:15.202322 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:15.240932 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:15.251612 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c: ROLLBACK
[0m15:02:15.252418 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c: Close
[0m15:02:15.254072 [info ] [Thread-1 (]: 15 of 25 PASS relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_  [[32mPASS[0m in 0.05s]
[0m15:02:15.255185 [debug] [Thread-1 (]: Finished running node test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c
[0m15:02:15.255185 [debug] [Thread-1 (]: Began running node test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b
[0m15:02:15.258849 [info ] [Thread-1 (]: 16 of 25 START test relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_  [RUN]
[0m15:02:15.258849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c, now test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b)
[0m15:02:15.262786 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b
[0m15:02:15.268518 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b"
[0m15:02:15.268518 [debug] [Thread-1 (]: Began executing node test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b
[0m15:02:15.268518 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b"
[0m15:02:15.268518 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b"
[0m15:02:15.268518 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1e7be210315c14e47a051a70dd61898e_10864]
   as 
    
    
    

with child as (
    select admission_id as from_field
    from "ReadmitDB"."dbo"."stg_labs"
    where admission_id is not null
),

parent as (
    select admission_id as to_field
    from "ReadmitDB"."dbo"."stg_admissions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1e7be210315c14e47a051a70dd61898e_10864]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1e7be210315c14e47a051a70dd61898e_10864]
  ;')
[0m15:02:15.268518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:15.268518 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:15.268518 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:15.302177 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:15.315911 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b: ROLLBACK
[0m15:02:15.317519 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b: Close
[0m15:02:15.317519 [info ] [Thread-1 (]: 16 of 25 PASS relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_  [[32mPASS[0m in 0.06s]
[0m15:02:15.317519 [debug] [Thread-1 (]: Finished running node test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b
[0m15:02:15.317519 [debug] [Thread-1 (]: Began running node test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8
[0m15:02:15.317519 [info ] [Thread-1 (]: 17 of 25 START test relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_  [RUN]
[0m15:02:15.317519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b, now test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8)
[0m15:02:15.317519 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8
[0m15:02:15.317519 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8"
[0m15:02:15.317519 [debug] [Thread-1 (]: Began executing node test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8
[0m15:02:15.317519 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8"
[0m15:02:15.317519 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8"
[0m15:02:15.317519 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_9091f3c69d75a9fb677e8cddbff376ba_13519]
   as 
    
    
    

with child as (
    select admission_id as from_field
    from "ReadmitDB"."dbo"."stg_pharmacy"
    where admission_id is not null
),

parent as (
    select admission_id as to_field
    from "ReadmitDB"."dbo"."stg_admissions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_9091f3c69d75a9fb677e8cddbff376ba_13519]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_9091f3c69d75a9fb677e8cddbff376ba_13519]
  ;')
[0m15:02:15.317519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:15.317519 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:15.317519 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:15.356880 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:15.356880 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8: ROLLBACK
[0m15:02:15.356880 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8: Close
[0m15:02:15.365899 [info ] [Thread-1 (]: 17 of 25 PASS relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_  [[32mPASS[0m in 0.05s]
[0m15:02:15.368274 [debug] [Thread-1 (]: Finished running node test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8
[0m15:02:15.368274 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e
[0m15:02:15.368274 [info ] [Thread-1 (]: 18 of 25 START test unique_admissions_enriched_admission_id .................... [RUN]
[0m15:02:15.368274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8, now test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e)
[0m15:02:15.368274 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e
[0m15:02:15.368274 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e"
[0m15:02:15.368274 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e
[0m15:02:15.368274 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e"
[0m15:02:15.368274 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e"
[0m15:02:15.368274 [debug] [Thread-1 (]: On test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2bcb223dc5bca2da23afd36b351f4f8b_11356]
   as 
    
    
    

select
    admission_id as unique_field,
    count(*) as n_records

from "ReadmitDB"."dbo"."admissions_enriched"
where admission_id is not null
group by admission_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2bcb223dc5bca2da23afd36b351f4f8b_11356]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2bcb223dc5bca2da23afd36b351f4f8b_11356]
  ;')
[0m15:02:15.382529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:15.382529 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:15.383567 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:15.407632 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:15.407632 [debug] [Thread-1 (]: On test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e: ROLLBACK
[0m15:02:15.407632 [debug] [Thread-1 (]: On test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e: Close
[0m15:02:15.407632 [info ] [Thread-1 (]: 18 of 25 PASS unique_admissions_enriched_admission_id .......................... [[32mPASS[0m in 0.04s]
[0m15:02:15.407632 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e
[0m15:02:15.407632 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d
[0m15:02:15.407632 [info ] [Thread-1 (]: 19 of 25 START test unique_fact_readmissions_admission_id ...................... [RUN]
[0m15:02:15.407632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e, now test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d)
[0m15:02:15.415865 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d
[0m15:02:15.418458 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d"
[0m15:02:15.418458 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d
[0m15:02:15.418458 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d"
[0m15:02:15.418458 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d"
[0m15:02:15.418458 [debug] [Thread-1 (]: On test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_3e324565142e5943b7695f08e2f4d13d_18336]
   as 
    
    
    

select
    admission_id as unique_field,
    count(*) as n_records

from "ReadmitDB"."dbo"."fact_readmissions"
where admission_id is not null
group by admission_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_3e324565142e5943b7695f08e2f4d13d_18336]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_3e324565142e5943b7695f08e2f4d13d_18336]
  ;')
[0m15:02:15.418458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:15.418458 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:15.418458 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:15.449379 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:15.453704 [debug] [Thread-1 (]: On test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d: ROLLBACK
[0m15:02:15.454746 [debug] [Thread-1 (]: On test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d: Close
[0m15:02:15.454746 [info ] [Thread-1 (]: 19 of 25 PASS unique_fact_readmissions_admission_id ............................ [[32mPASS[0m in 0.05s]
[0m15:02:15.455705 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d
[0m15:02:15.456765 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7
[0m15:02:15.456765 [info ] [Thread-1 (]: 20 of 25 START test unique_patients_enriched_patient_id ........................ [RUN]
[0m15:02:15.457941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d, now test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7)
[0m15:02:15.457941 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7
[0m15:02:15.457941 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7"
[0m15:02:15.457941 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7
[0m15:02:15.457941 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7"
[0m15:02:15.465869 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7"
[0m15:02:15.466875 [debug] [Thread-1 (]: On test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_48a11f64092638cf50edc41f3f0fd15c_14295]
   as 
    
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "ReadmitDB"."dbo"."patients_enriched"
where patient_id is not null
group by patient_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_48a11f64092638cf50edc41f3f0fd15c_14295]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_48a11f64092638cf50edc41f3f0fd15c_14295]
  ;')
[0m15:02:15.467874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:15.468883 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:15.469054 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:15.490872 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:15.490872 [debug] [Thread-1 (]: On test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7: ROLLBACK
[0m15:02:15.490872 [debug] [Thread-1 (]: On test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7: Close
[0m15:02:15.490872 [info ] [Thread-1 (]: 20 of 25 PASS unique_patients_enriched_patient_id .............................. [[32mPASS[0m in 0.03s]
[0m15:02:15.490872 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7
[0m15:02:15.490872 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_stg_admissions_admission_id.bc99100827
[0m15:02:15.499168 [info ] [Thread-1 (]: 21 of 25 START test unique_stg_admissions_admission_id ......................... [RUN]
[0m15:02:15.500221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7, now test.readmit_risk.unique_stg_admissions_admission_id.bc99100827)
[0m15:02:15.500221 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_stg_admissions_admission_id.bc99100827
[0m15:02:15.501240 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_stg_admissions_admission_id.bc99100827"
[0m15:02:15.501240 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_stg_admissions_admission_id.bc99100827
[0m15:02:15.501240 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.unique_stg_admissions_admission_id.bc99100827"
[0m15:02:15.501240 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.unique_stg_admissions_admission_id.bc99100827"
[0m15:02:15.501240 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_admissions_admission_id.bc99100827: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.unique_stg_admissions_admission_id.bc99100827"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_f7ea073d766e0715ac2a0c65c0922ea4_7452]
   as 
    
    
    

select
    admission_id as unique_field,
    count(*) as n_records

from "ReadmitDB"."dbo"."stg_admissions"
where admission_id is not null
group by admission_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_f7ea073d766e0715ac2a0c65c0922ea4_7452]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_f7ea073d766e0715ac2a0c65c0922ea4_7452]
  ;')
[0m15:02:15.501240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:15.501240 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:15.501240 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:15.536324 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:15.538375 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_admissions_admission_id.bc99100827: ROLLBACK
[0m15:02:15.538375 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_admissions_admission_id.bc99100827: Close
[0m15:02:15.539371 [info ] [Thread-1 (]: 21 of 25 PASS unique_stg_admissions_admission_id ............................... [[32mPASS[0m in 0.04s]
[0m15:02:15.540594 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_stg_admissions_admission_id.bc99100827
[0m15:02:15.540594 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5
[0m15:02:15.540594 [info ] [Thread-1 (]: 22 of 25 START test unique_stg_claims_claim_id ................................. [RUN]
[0m15:02:15.540594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_stg_admissions_admission_id.bc99100827, now test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5)
[0m15:02:15.540594 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5
[0m15:02:15.549208 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5"
[0m15:02:15.551697 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5
[0m15:02:15.555158 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5"
[0m15:02:15.557127 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5"
[0m15:02:15.557127 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_aff8bf6a2bd3d2a90b18a5ca79ffc0c3_1618]
   as 
    
    
    

select
    claim_id as unique_field,
    count(*) as n_records

from "ReadmitDB"."dbo"."stg_claims"
where claim_id is not null
group by claim_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_aff8bf6a2bd3d2a90b18a5ca79ffc0c3_1618]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_aff8bf6a2bd3d2a90b18a5ca79ffc0c3_1618]
  ;')
[0m15:02:15.558127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:15.558230 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:15.558230 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:15.601409 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:15.601409 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5: ROLLBACK
[0m15:02:15.601409 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5: Close
[0m15:02:15.601409 [info ] [Thread-1 (]: 22 of 25 PASS unique_stg_claims_claim_id ....................................... [[32mPASS[0m in 0.06s]
[0m15:02:15.601409 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5
[0m15:02:15.601409 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e
[0m15:02:15.601409 [info ] [Thread-1 (]: 23 of 25 START test unique_stg_labs_lab_id ..................................... [RUN]
[0m15:02:15.601409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5, now test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e)
[0m15:02:15.601409 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e
[0m15:02:15.621113 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e"
[0m15:02:15.622228 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e
[0m15:02:15.624385 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e"
[0m15:02:15.624385 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e"
[0m15:02:15.624385 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_c6fa431daf884a6538e019e6f88b0e1b_18752]
   as 
    
    
    

select
    lab_id as unique_field,
    count(*) as n_records

from "ReadmitDB"."dbo"."stg_labs"
where lab_id is not null
group by lab_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_c6fa431daf884a6538e019e6f88b0e1b_18752]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_c6fa431daf884a6538e019e6f88b0e1b_18752]
  ;')
[0m15:02:15.624385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:15.624385 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:15.624385 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:15.687799 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:15.689792 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e: ROLLBACK
[0m15:02:15.690791 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e: Close
[0m15:02:15.692795 [info ] [Thread-1 (]: 23 of 25 PASS unique_stg_labs_lab_id ........................................... [[32mPASS[0m in 0.09s]
[0m15:02:15.694741 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e
[0m15:02:15.694741 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0
[0m15:02:15.695756 [info ] [Thread-1 (]: 24 of 25 START test unique_stg_patients_patient_id ............................. [RUN]
[0m15:02:15.697723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e, now test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0)
[0m15:02:15.698757 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0
[0m15:02:15.706614 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0"
[0m15:02:15.707609 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0
[0m15:02:15.710610 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0"
[0m15:02:15.711646 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0"
[0m15:02:15.711646 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_ca5f2c44061a50ea3f645d645250418e_17203]
   as 
    
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "ReadmitDB"."dbo"."stg_patients"
where patient_id is not null
group by patient_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_ca5f2c44061a50ea3f645d645250418e_17203]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_ca5f2c44061a50ea3f645d645250418e_17203]
  ;')
[0m15:02:15.712608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:15.712608 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:15.713610 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:15.737434 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:15.740749 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0: ROLLBACK
[0m15:02:15.740749 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0: Close
[0m15:02:15.740749 [info ] [Thread-1 (]: 24 of 25 PASS unique_stg_patients_patient_id ................................... [[32mPASS[0m in 0.04s]
[0m15:02:15.740749 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0
[0m15:02:15.740749 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8
[0m15:02:15.740749 [info ] [Thread-1 (]: 25 of 25 START test unique_stg_pharmacy_rx_id .................................. [RUN]
[0m15:02:15.740749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0, now test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8)
[0m15:02:15.740749 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8
[0m15:02:15.752444 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8"
[0m15:02:15.753486 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8
[0m15:02:15.756489 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8"
[0m15:02:15.756489 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8"
[0m15:02:15.757636 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_6a74a5763996ca376649e01ff4c8b1f6_14233]
   as 
    
    
    

select
    rx_id as unique_field,
    count(*) as n_records

from "ReadmitDB"."dbo"."stg_pharmacy"
where rx_id is not null
group by rx_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_6a74a5763996ca376649e01ff4c8b1f6_14233]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_6a74a5763996ca376649e01ff4c8b1f6_14233]
  ;')
[0m15:02:15.757636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:15.757636 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:02:15.757636 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:02:15.790140 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:15.799082 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8: ROLLBACK
[0m15:02:15.801154 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8: Close
[0m15:02:15.801774 [info ] [Thread-1 (]: 25 of 25 PASS unique_stg_pharmacy_rx_id ........................................ [[32mPASS[0m in 0.06s]
[0m15:02:15.801774 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8
[0m15:02:15.801774 [debug] [MainThread]: On master: COMMIT
[0m15:02:15.801774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:15.801774 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m15:02:15.801774 [debug] [MainThread]: Connection 'test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8' was properly closed.
[0m15:02:15.801774 [info ] [MainThread]: 
[0m15:02:15.801774 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m15:02:15.810175 [debug] [MainThread]: Command end result
[0m15:02:15.836457 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m15:02:15.838553 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m15:02:15.838553 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m15:02:15.838553 [info ] [MainThread]: 
[0m15:02:15.838553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:02:15.838553 [info ] [MainThread]: 
[0m15:02:15.838553 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=25
[0m15:02:15.848968 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:02:15.850348 [debug] [MainThread]: Command `dbt test` succeeded at 15:02:15.850348 after 2.76 seconds
[0m15:02:15.850348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF42964E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF42BE3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF42C25B10>]}
[0m15:02:15.850348 [debug] [MainThread]: Flushing usage events
[0m15:02:19.581780 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:05:02.159605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFE970B990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFE9777C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFE970ACD0>]}


============================== 15:05:02.159605 | 82852e74-08c0-4995-897b-43b2bd5ad9ff ==============================
[0m15:05:02.159605 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:05:02.159605 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m15:05:02.473091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82852e74-08c0-4995-897b-43b2bd5ad9ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFEAFFB0D0>]}
[0m15:05:02.519962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82852e74-08c0-4995-897b-43b2bd5ad9ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFE8747B90>]}
[0m15:05:02.519962 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:05:02.674804 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m15:05:02.862217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:05:02.862217 [debug] [MainThread]: Partial parsing: updated file: readmit_risk://models\staging\schema.yml
[0m15:05:03.224817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82852e74-08c0-4995-897b-43b2bd5ad9ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFEB770F90>]}
[0m15:05:03.302931 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m15:05:03.302931 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m15:05:03.334980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82852e74-08c0-4995-897b-43b2bd5ad9ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFEB92E010>]}
[0m15:05:03.334980 [info ] [MainThread]: Found 5 seeds, 13 models, 22 data tests, 510 macros
[0m15:05:03.334980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82852e74-08c0-4995-897b-43b2bd5ad9ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFEB755490>]}
[0m15:05:03.334980 [info ] [MainThread]: 
[0m15:05:03.334980 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:05:03.350660 [info ] [MainThread]: 
[0m15:05:03.350660 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:05:03.358068 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m15:05:03.377631 [debug] [ThreadPool]: dbt-sqlserver
[0m15:05:03.378626 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m15:05:03.378626 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:05:03.379625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:03.380625 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:03.466020 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:03.508226 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:05:03.523925 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m15:05:03.524578 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m15:05:03.524578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82852e74-08c0-4995-897b-43b2bd5ad9ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFEB523850>]}
[0m15:05:03.524578 [debug] [MainThread]: On master: COMMIT
[0m15:05:03.524578 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f
[0m15:05:03.524578 [info ] [Thread-1 (]: 1 of 22 START test not_null_admissions_enriched_admission_id ................... [RUN]
[0m15:05:03.539589 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f'
[0m15:05:03.539589 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f
[0m15:05:03.539589 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f"
[0m15:05:03.539589 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f
[0m15:05:03.567660 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f"
[0m15:05:03.567660 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f"
[0m15:05:03.567660 [debug] [Thread-1 (]: On test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5c453eac14f4b87883608ab90631f899_2108]
   as 
    
    
    



select admission_id
from "ReadmitDB"."dbo"."admissions_enriched"
where admission_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5c453eac14f4b87883608ab90631f899_2108]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5c453eac14f4b87883608ab90631f899_2108]
  ;')
[0m15:05:03.567660 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:05:03.567660 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:03.567660 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:03.577354 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:03.577354 [debug] [Thread-1 (]: On test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f: ROLLBACK
[0m15:05:03.577354 [debug] [Thread-1 (]: On test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f: Close
[0m15:05:03.577354 [info ] [Thread-1 (]: 1 of 22 PASS not_null_admissions_enriched_admission_id ......................... [[32mPASS[0m in 0.05s]
[0m15:05:03.593306 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f
[0m15:05:03.593306 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c
[0m15:05:03.594200 [info ] [Thread-1 (]: 2 of 22 START test not_null_fact_readmissions_admission_id ..................... [RUN]
[0m15:05:03.594200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f, now test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c)
[0m15:05:03.594200 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c
[0m15:05:03.594200 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c"
[0m15:05:03.594200 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c
[0m15:05:03.594200 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c"
[0m15:05:03.594200 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c"
[0m15:05:03.594200 [debug] [Thread-1 (]: On test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_8518c4118139c09c218337bd47c210bd_10869]
   as 
    
    
    



select admission_id
from "ReadmitDB"."dbo"."fact_readmissions"
where admission_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_8518c4118139c09c218337bd47c210bd_10869]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_8518c4118139c09c218337bd47c210bd_10869]
  ;')
[0m15:05:03.594200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:03.594200 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:03.594200 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:03.615548 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:03.615548 [debug] [Thread-1 (]: On test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c: ROLLBACK
[0m15:05:03.615548 [debug] [Thread-1 (]: On test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c: Close
[0m15:05:03.615548 [info ] [Thread-1 (]: 2 of 22 PASS not_null_fact_readmissions_admission_id ........................... [[32mPASS[0m in 0.02s]
[0m15:05:03.615548 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c
[0m15:05:03.626184 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0
[0m15:05:03.626184 [info ] [Thread-1 (]: 3 of 22 START test not_null_fact_readmissions_label_readmit_30 ................. [RUN]
[0m15:05:03.627748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c, now test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0)
[0m15:05:03.628795 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0
[0m15:05:03.632018 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0"
[0m15:05:03.632018 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0
[0m15:05:03.632018 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0"
[0m15:05:03.632018 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0"
[0m15:05:03.632018 [debug] [Thread-1 (]: On test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_bed95e4e62bef66f3bfc252fbfff5807_5161]
   as 
    
    
    



select label_readmit_30
from "ReadmitDB"."dbo"."fact_readmissions"
where label_readmit_30 is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_bed95e4e62bef66f3bfc252fbfff5807_5161]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_bed95e4e62bef66f3bfc252fbfff5807_5161]
  ;')
[0m15:05:03.632018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:03.632018 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:03.632018 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:03.650670 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:03.650670 [debug] [Thread-1 (]: On test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0: ROLLBACK
[0m15:05:03.650670 [debug] [Thread-1 (]: On test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0: Close
[0m15:05:03.659955 [info ] [Thread-1 (]: 3 of 22 PASS not_null_fact_readmissions_label_readmit_30 ....................... [[32mPASS[0m in 0.03s]
[0m15:05:03.661976 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0
[0m15:05:03.663091 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46
[0m15:05:03.663091 [info ] [Thread-1 (]: 4 of 22 START test not_null_patients_enriched_patient_id ....................... [RUN]
[0m15:05:03.664351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0, now test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46)
[0m15:05:03.665359 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46
[0m15:05:03.667490 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46"
[0m15:05:03.667490 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46
[0m15:05:03.667490 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46"
[0m15:05:03.667490 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46"
[0m15:05:03.667490 [debug] [Thread-1 (]: On test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_94d3438421080892e10d8a24b6a606e2_6701]
   as 
    
    
    



select patient_id
from "ReadmitDB"."dbo"."patients_enriched"
where patient_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_94d3438421080892e10d8a24b6a606e2_6701]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_94d3438421080892e10d8a24b6a606e2_6701]
  ;')
[0m15:05:03.667490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:03.667490 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:03.667490 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:03.683702 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:03.693810 [debug] [Thread-1 (]: On test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46: ROLLBACK
[0m15:05:03.693810 [debug] [Thread-1 (]: On test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46: Close
[0m15:05:03.695235 [info ] [Thread-1 (]: 4 of 22 PASS not_null_patients_enriched_patient_id ............................. [[32mPASS[0m in 0.03s]
[0m15:05:03.696676 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46
[0m15:05:03.696676 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5
[0m15:05:03.697820 [info ] [Thread-1 (]: 5 of 22 START test not_null_stg_admissions_admission_id ........................ [RUN]
[0m15:05:03.698579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46, now test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5)
[0m15:05:03.698579 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5
[0m15:05:03.700735 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5"
[0m15:05:03.700735 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5
[0m15:05:03.700735 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5"
[0m15:05:03.700735 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5"
[0m15:05:03.700735 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_6caf86b824b61cb476dbbd51dff6c38e_15598]
   as 
    
    
    



select admission_id
from "ReadmitDB"."dbo"."stg_admissions"
where admission_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_6caf86b824b61cb476dbbd51dff6c38e_15598]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_6caf86b824b61cb476dbbd51dff6c38e_15598]
  ;')
[0m15:05:03.700735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:03.700735 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:03.700735 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:03.731994 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:03.734135 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5: ROLLBACK
[0m15:05:03.734135 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5: Close
[0m15:05:03.734135 [info ] [Thread-1 (]: 5 of 22 PASS not_null_stg_admissions_admission_id .............................. [[32mPASS[0m in 0.04s]
[0m15:05:03.734135 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5
[0m15:05:03.734135 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_admissions_patient_id.0706065292
[0m15:05:03.734135 [info ] [Thread-1 (]: 6 of 22 START test not_null_stg_admissions_patient_id .......................... [RUN]
[0m15:05:03.734135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5, now test.readmit_risk.not_null_stg_admissions_patient_id.0706065292)
[0m15:05:03.734135 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_admissions_patient_id.0706065292
[0m15:05:03.746002 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_admissions_patient_id.0706065292"
[0m15:05:03.746002 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_admissions_patient_id.0706065292
[0m15:05:03.750084 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_stg_admissions_patient_id.0706065292"
[0m15:05:03.751147 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_stg_admissions_patient_id.0706065292"
[0m15:05:03.751147 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_admissions_patient_id.0706065292: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_stg_admissions_patient_id.0706065292"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_9c3e890caa51fce66e84ba6ba2d5f68e_8762]
   as 
    
    
    



select patient_id
from "ReadmitDB"."dbo"."stg_admissions"
where patient_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_9c3e890caa51fce66e84ba6ba2d5f68e_8762]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_9c3e890caa51fce66e84ba6ba2d5f68e_8762]
  ;')
[0m15:05:03.751147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:03.751147 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:03.751147 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:03.761095 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:03.761095 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_admissions_patient_id.0706065292: ROLLBACK
[0m15:05:03.761095 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_admissions_patient_id.0706065292: Close
[0m15:05:03.761095 [info ] [Thread-1 (]: 6 of 22 PASS not_null_stg_admissions_patient_id ................................ [[32mPASS[0m in 0.03s]
[0m15:05:03.761095 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_admissions_patient_id.0706065292
[0m15:05:03.761095 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86
[0m15:05:03.775474 [info ] [Thread-1 (]: 7 of 22 START test not_null_stg_claims_claim_id ................................ [RUN]
[0m15:05:03.776477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_admissions_patient_id.0706065292, now test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86)
[0m15:05:03.777890 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86
[0m15:05:03.780978 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86"
[0m15:05:03.780978 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86
[0m15:05:03.780978 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86"
[0m15:05:03.780978 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86"
[0m15:05:03.780978 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_e922bd79c0894ceb6644cf5252899b27_9846]
   as 
    
    
    



select claim_id
from "ReadmitDB"."dbo"."stg_claims"
where claim_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_e922bd79c0894ceb6644cf5252899b27_9846]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_e922bd79c0894ceb6644cf5252899b27_9846]
  ;')
[0m15:05:03.780978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:03.780978 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:03.780978 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:03.811354 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:03.811354 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86: ROLLBACK
[0m15:05:03.811354 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86: Close
[0m15:05:03.811354 [info ] [Thread-1 (]: 7 of 22 PASS not_null_stg_claims_claim_id ...................................... [[32mPASS[0m in 0.03s]
[0m15:05:03.811354 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86
[0m15:05:03.811354 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_labs_lab_id.e63312a399
[0m15:05:03.811354 [info ] [Thread-1 (]: 8 of 22 START test not_null_stg_labs_lab_id .................................... [RUN]
[0m15:05:03.811354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86, now test.readmit_risk.not_null_stg_labs_lab_id.e63312a399)
[0m15:05:03.811354 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_labs_lab_id.e63312a399
[0m15:05:03.811354 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_labs_lab_id.e63312a399"
[0m15:05:03.811354 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_labs_lab_id.e63312a399
[0m15:05:03.827857 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_stg_labs_lab_id.e63312a399"
[0m15:05:03.828732 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_stg_labs_lab_id.e63312a399"
[0m15:05:03.829769 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_labs_lab_id.e63312a399: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_stg_labs_lab_id.e63312a399"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_01d2387f9cbc9946d6a351a30426951d_4233]
   as 
    
    
    



select lab_id
from "ReadmitDB"."dbo"."stg_labs"
where lab_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_01d2387f9cbc9946d6a351a30426951d_4233]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_01d2387f9cbc9946d6a351a30426951d_4233]
  ;')
[0m15:05:03.829769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:03.830769 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:03.830769 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:03.850781 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:03.859940 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_labs_lab_id.e63312a399: ROLLBACK
[0m15:05:03.860586 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_labs_lab_id.e63312a399: Close
[0m15:05:03.860586 [info ] [Thread-1 (]: 8 of 22 PASS not_null_stg_labs_lab_id .......................................... [[32mPASS[0m in 0.05s]
[0m15:05:03.860586 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_labs_lab_id.e63312a399
[0m15:05:03.860586 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_patients_patient_id.e578180344
[0m15:05:03.860586 [info ] [Thread-1 (]: 9 of 22 START test not_null_stg_patients_patient_id ............................ [RUN]
[0m15:05:03.860586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_labs_lab_id.e63312a399, now test.readmit_risk.not_null_stg_patients_patient_id.e578180344)
[0m15:05:03.860586 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_patients_patient_id.e578180344
[0m15:05:03.860586 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_patients_patient_id.e578180344"
[0m15:05:03.860586 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_patients_patient_id.e578180344
[0m15:05:03.860586 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_stg_patients_patient_id.e578180344"
[0m15:05:03.860586 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_stg_patients_patient_id.e578180344"
[0m15:05:03.875593 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_patients_patient_id.e578180344: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_stg_patients_patient_id.e578180344"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_d785b63395cf96495c19c2bc30bdcf33_13334]
   as 
    
    
    



select patient_id
from "ReadmitDB"."dbo"."stg_patients"
where patient_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_d785b63395cf96495c19c2bc30bdcf33_13334]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_d785b63395cf96495c19c2bc30bdcf33_13334]
  ;')
[0m15:05:03.875593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:03.876409 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:03.876956 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:03.881710 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:03.894789 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_patients_patient_id.e578180344: ROLLBACK
[0m15:05:03.895792 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_patients_patient_id.e578180344: Close
[0m15:05:03.896792 [info ] [Thread-1 (]: 9 of 22 PASS not_null_stg_patients_patient_id .................................. [[32mPASS[0m in 0.04s]
[0m15:05:03.897339 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_patients_patient_id.e578180344
[0m15:05:03.898357 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a
[0m15:05:03.898357 [info ] [Thread-1 (]: 10 of 22 START test not_null_stg_pharmacy_rx_id ................................ [RUN]
[0m15:05:03.899355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_patients_patient_id.e578180344, now test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a)
[0m15:05:03.899355 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a
[0m15:05:03.900394 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a"
[0m15:05:03.900394 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a
[0m15:05:03.900394 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a"
[0m15:05:03.900394 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a"
[0m15:05:03.900394 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2d910e2f44338ff44779abeb89ab41e6_13813]
   as 
    
    
    



select rx_id
from "ReadmitDB"."dbo"."stg_pharmacy"
where rx_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2d910e2f44338ff44779abeb89ab41e6_13813]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2d910e2f44338ff44779abeb89ab41e6_13813]
  ;')
[0m15:05:03.900394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:03.900394 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:03.900394 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:03.929388 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:03.930395 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a: ROLLBACK
[0m15:05:03.931473 [debug] [Thread-1 (]: On test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a: Close
[0m15:05:03.932394 [info ] [Thread-1 (]: 10 of 22 PASS not_null_stg_pharmacy_rx_id ...................................... [[32mPASS[0m in 0.03s]
[0m15:05:03.932394 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a
[0m15:05:03.933391 [debug] [Thread-1 (]: Began running node test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba
[0m15:05:03.933391 [info ] [Thread-1 (]: 11 of 22 START test relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_  [RUN]
[0m15:05:03.934499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a, now test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba)
[0m15:05:03.934499 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba
[0m15:05:03.934499 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba"
[0m15:05:03.934499 [debug] [Thread-1 (]: Began executing node test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba
[0m15:05:03.934499 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba"
[0m15:05:03.943169 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba"
[0m15:05:03.945039 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_6fe3d2cf03bdaf136ebd996395045920_17760]
   as 
    
    
    

with child as (
    select patient_id as from_field
    from "ReadmitDB"."dbo"."stg_admissions"
    where patient_id is not null
),

parent as (
    select patient_id as to_field
    from "ReadmitDB"."dbo"."stg_patients"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_6fe3d2cf03bdaf136ebd996395045920_17760]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_6fe3d2cf03bdaf136ebd996395045920_17760]
  ;')
[0m15:05:03.946122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:03.946122 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:03.947079 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:03.977302 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:03.977302 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba: ROLLBACK
[0m15:05:03.977302 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba: Close
[0m15:05:03.977302 [info ] [Thread-1 (]: 11 of 22 PASS relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_  [[32mPASS[0m in 0.04s]
[0m15:05:03.977302 [debug] [Thread-1 (]: Finished running node test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba
[0m15:05:03.977302 [debug] [Thread-1 (]: Began running node test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c
[0m15:05:03.977302 [info ] [Thread-1 (]: 12 of 22 START test relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_  [RUN]
[0m15:05:03.977302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba, now test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c)
[0m15:05:03.977302 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c
[0m15:05:03.977302 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c"
[0m15:05:03.977302 [debug] [Thread-1 (]: Began executing node test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c
[0m15:05:03.994793 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c"
[0m15:05:03.996825 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c"
[0m15:05:03.997800 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7e5205100ca21ba063b1798634d334a6_6794]
   as 
    
    
    

with child as (
    select admission_id as from_field
    from "ReadmitDB"."dbo"."stg_claims"
    where admission_id is not null
),

parent as (
    select admission_id as to_field
    from "ReadmitDB"."dbo"."stg_admissions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7e5205100ca21ba063b1798634d334a6_6794]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7e5205100ca21ba063b1798634d334a6_6794]
  ;')
[0m15:05:03.997800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:03.998839 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:03.998839 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:04.027287 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:04.027287 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c: ROLLBACK
[0m15:05:04.027287 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c: Close
[0m15:05:04.042292 [info ] [Thread-1 (]: 12 of 22 PASS relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_  [[32mPASS[0m in 0.06s]
[0m15:05:04.043730 [debug] [Thread-1 (]: Finished running node test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c
[0m15:05:04.043730 [debug] [Thread-1 (]: Began running node test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b
[0m15:05:04.043730 [info ] [Thread-1 (]: 13 of 22 START test relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_  [RUN]
[0m15:05:04.043730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c, now test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b)
[0m15:05:04.043730 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b
[0m15:05:04.043730 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b"
[0m15:05:04.043730 [debug] [Thread-1 (]: Began executing node test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b
[0m15:05:04.043730 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b"
[0m15:05:04.043730 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b"
[0m15:05:04.043730 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1e7be210315c14e47a051a70dd61898e_17196]
   as 
    
    
    

with child as (
    select admission_id as from_field
    from "ReadmitDB"."dbo"."stg_labs"
    where admission_id is not null
),

parent as (
    select admission_id as to_field
    from "ReadmitDB"."dbo"."stg_admissions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1e7be210315c14e47a051a70dd61898e_17196]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1e7be210315c14e47a051a70dd61898e_17196]
  ;')
[0m15:05:04.043730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:04.043730 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:04.043730 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:04.093152 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:04.095710 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b: ROLLBACK
[0m15:05:04.095710 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b: Close
[0m15:05:04.095710 [info ] [Thread-1 (]: 13 of 22 PASS relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_  [[32mPASS[0m in 0.05s]
[0m15:05:04.095710 [debug] [Thread-1 (]: Finished running node test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b
[0m15:05:04.095710 [debug] [Thread-1 (]: Began running node test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8
[0m15:05:04.095710 [info ] [Thread-1 (]: 14 of 22 START test relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_  [RUN]
[0m15:05:04.095710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b, now test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8)
[0m15:05:04.095710 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8
[0m15:05:04.095710 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8"
[0m15:05:04.109772 [debug] [Thread-1 (]: Began executing node test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8
[0m15:05:04.113820 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8"
[0m15:05:04.114737 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8"
[0m15:05:04.114737 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_9091f3c69d75a9fb677e8cddbff376ba_10072]
   as 
    
    
    

with child as (
    select admission_id as from_field
    from "ReadmitDB"."dbo"."stg_pharmacy"
    where admission_id is not null
),

parent as (
    select admission_id as to_field
    from "ReadmitDB"."dbo"."stg_admissions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_9091f3c69d75a9fb677e8cddbff376ba_10072]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_9091f3c69d75a9fb677e8cddbff376ba_10072]
  ;')
[0m15:05:04.115759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:04.115759 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:04.115759 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:04.145478 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:04.145478 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8: ROLLBACK
[0m15:05:04.145478 [debug] [Thread-1 (]: On test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8: Close
[0m15:05:04.145478 [info ] [Thread-1 (]: 14 of 22 PASS relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_  [[32mPASS[0m in 0.05s]
[0m15:05:04.145478 [debug] [Thread-1 (]: Finished running node test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8
[0m15:05:04.145478 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e
[0m15:05:04.145478 [info ] [Thread-1 (]: 15 of 22 START test unique_admissions_enriched_admission_id .................... [RUN]
[0m15:05:04.160717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8, now test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e)
[0m15:05:04.161422 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e
[0m15:05:04.161422 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e"
[0m15:05:04.161422 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e
[0m15:05:04.161422 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e"
[0m15:05:04.161422 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e"
[0m15:05:04.161422 [debug] [Thread-1 (]: On test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2bcb223dc5bca2da23afd36b351f4f8b_6671]
   as 
    
    
    

select
    admission_id as unique_field,
    count(*) as n_records

from "ReadmitDB"."dbo"."admissions_enriched"
where admission_id is not null
group by admission_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2bcb223dc5bca2da23afd36b351f4f8b_6671]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2bcb223dc5bca2da23afd36b351f4f8b_6671]
  ;')
[0m15:05:04.161422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:04.161422 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:04.161422 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:04.193117 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:04.196692 [debug] [Thread-1 (]: On test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e: ROLLBACK
[0m15:05:04.197787 [debug] [Thread-1 (]: On test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e: Close
[0m15:05:04.198784 [info ] [Thread-1 (]: 15 of 22 PASS unique_admissions_enriched_admission_id .......................... [[32mPASS[0m in 0.04s]
[0m15:05:04.199743 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e
[0m15:05:04.200758 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d
[0m15:05:04.200758 [info ] [Thread-1 (]: 16 of 22 START test unique_fact_readmissions_admission_id ...................... [RUN]
[0m15:05:04.201885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e, now test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d)
[0m15:05:04.201885 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d
[0m15:05:04.201885 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d"
[0m15:05:04.201885 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d
[0m15:05:04.201885 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d"
[0m15:05:04.210621 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d"
[0m15:05:04.211618 [debug] [Thread-1 (]: On test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_3e324565142e5943b7695f08e2f4d13d_3982]
   as 
    
    
    

select
    admission_id as unique_field,
    count(*) as n_records

from "ReadmitDB"."dbo"."fact_readmissions"
where admission_id is not null
group by admission_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_3e324565142e5943b7695f08e2f4d13d_3982]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_3e324565142e5943b7695f08e2f4d13d_3982]
  ;')
[0m15:05:04.212376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:04.212989 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:04.212989 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:04.234424 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:04.234424 [debug] [Thread-1 (]: On test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d: ROLLBACK
[0m15:05:04.234424 [debug] [Thread-1 (]: On test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d: Close
[0m15:05:04.243003 [info ] [Thread-1 (]: 16 of 22 PASS unique_fact_readmissions_admission_id ............................ [[32mPASS[0m in 0.03s]
[0m15:05:04.245007 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d
[0m15:05:04.245927 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7
[0m15:05:04.245927 [info ] [Thread-1 (]: 17 of 22 START test unique_patients_enriched_patient_id ........................ [RUN]
[0m15:05:04.245927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d, now test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7)
[0m15:05:04.245927 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7
[0m15:05:04.245927 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7"
[0m15:05:04.245927 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7
[0m15:05:04.245927 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7"
[0m15:05:04.245927 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7"
[0m15:05:04.245927 [debug] [Thread-1 (]: On test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_48a11f64092638cf50edc41f3f0fd15c_7584]
   as 
    
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "ReadmitDB"."dbo"."patients_enriched"
where patient_id is not null
group by patient_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_48a11f64092638cf50edc41f3f0fd15c_7584]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_48a11f64092638cf50edc41f3f0fd15c_7584]
  ;')
[0m15:05:04.245927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:04.245927 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:04.259612 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:04.280621 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:04.281620 [debug] [Thread-1 (]: On test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7: ROLLBACK
[0m15:05:04.282620 [debug] [Thread-1 (]: On test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7: Close
[0m15:05:04.282620 [info ] [Thread-1 (]: 17 of 22 PASS unique_patients_enriched_patient_id .............................. [[32mPASS[0m in 0.04s]
[0m15:05:04.283840 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7
[0m15:05:04.283840 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_stg_admissions_admission_id.bc99100827
[0m15:05:04.283840 [info ] [Thread-1 (]: 18 of 22 START test unique_stg_admissions_admission_id ......................... [RUN]
[0m15:05:04.283840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7, now test.readmit_risk.unique_stg_admissions_admission_id.bc99100827)
[0m15:05:04.283840 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_stg_admissions_admission_id.bc99100827
[0m15:05:04.283840 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_stg_admissions_admission_id.bc99100827"
[0m15:05:04.283840 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_stg_admissions_admission_id.bc99100827
[0m15:05:04.292948 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.unique_stg_admissions_admission_id.bc99100827"
[0m15:05:04.293953 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.unique_stg_admissions_admission_id.bc99100827"
[0m15:05:04.294843 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_admissions_admission_id.bc99100827: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.unique_stg_admissions_admission_id.bc99100827"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_f7ea073d766e0715ac2a0c65c0922ea4_6458]
   as 
    
    
    

select
    admission_id as unique_field,
    count(*) as n_records

from "ReadmitDB"."dbo"."stg_admissions"
where admission_id is not null
group by admission_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_f7ea073d766e0715ac2a0c65c0922ea4_6458]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_f7ea073d766e0715ac2a0c65c0922ea4_6458]
  ;')
[0m15:05:04.296024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:04.297029 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:04.298030 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:04.316750 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:04.316750 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_admissions_admission_id.bc99100827: ROLLBACK
[0m15:05:04.316750 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_admissions_admission_id.bc99100827: Close
[0m15:05:04.326222 [info ] [Thread-1 (]: 18 of 22 PASS unique_stg_admissions_admission_id ............................... [[32mPASS[0m in 0.04s]
[0m15:05:04.327225 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_stg_admissions_admission_id.bc99100827
[0m15:05:04.328377 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5
[0m15:05:04.328377 [info ] [Thread-1 (]: 19 of 22 START test unique_stg_claims_claim_id ................................. [RUN]
[0m15:05:04.328377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_stg_admissions_admission_id.bc99100827, now test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5)
[0m15:05:04.328377 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5
[0m15:05:04.328377 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5"
[0m15:05:04.328377 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5
[0m15:05:04.328377 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5"
[0m15:05:04.328377 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5"
[0m15:05:04.328377 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_aff8bf6a2bd3d2a90b18a5ca79ffc0c3_16780]
   as 
    
    
    

select
    claim_id as unique_field,
    count(*) as n_records

from "ReadmitDB"."dbo"."stg_claims"
where claim_id is not null
group by claim_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_aff8bf6a2bd3d2a90b18a5ca79ffc0c3_16780]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_aff8bf6a2bd3d2a90b18a5ca79ffc0c3_16780]
  ;')
[0m15:05:04.328377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:04.328377 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:04.345008 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:04.400157 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:04.403154 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5: ROLLBACK
[0m15:05:04.403154 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5: Close
[0m15:05:04.404154 [info ] [Thread-1 (]: 19 of 22 PASS unique_stg_claims_claim_id ....................................... [[32mPASS[0m in 0.08s]
[0m15:05:04.405155 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5
[0m15:05:04.406155 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e
[0m15:05:04.407155 [info ] [Thread-1 (]: 20 of 22 START test unique_stg_labs_lab_id ..................................... [RUN]
[0m15:05:04.409155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5, now test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e)
[0m15:05:04.409155 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e
[0m15:05:04.414039 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e"
[0m15:05:04.415038 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e
[0m15:05:04.417039 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e"
[0m15:05:04.418039 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e"
[0m15:05:04.418039 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_c6fa431daf884a6538e019e6f88b0e1b_13269]
   as 
    
    
    

select
    lab_id as unique_field,
    count(*) as n_records

from "ReadmitDB"."dbo"."stg_labs"
where lab_id is not null
group by lab_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_c6fa431daf884a6538e019e6f88b0e1b_13269]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_c6fa431daf884a6538e019e6f88b0e1b_13269]
  ;')
[0m15:05:04.419039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:04.419039 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:04.425125 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:04.478901 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:04.478901 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e: ROLLBACK
[0m15:05:04.478901 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e: Close
[0m15:05:04.478901 [info ] [Thread-1 (]: 20 of 22 PASS unique_stg_labs_lab_id ........................................... [[32mPASS[0m in 0.07s]
[0m15:05:04.478901 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e
[0m15:05:04.478901 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0
[0m15:05:04.478901 [info ] [Thread-1 (]: 21 of 22 START test unique_stg_patients_patient_id ............................. [RUN]
[0m15:05:04.492852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e, now test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0)
[0m15:05:04.492852 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0
[0m15:05:04.497939 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0"
[0m15:05:04.498858 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0
[0m15:05:04.500892 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0"
[0m15:05:04.501858 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0"
[0m15:05:04.501858 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_ca5f2c44061a50ea3f645d645250418e_4267]
   as 
    
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "ReadmitDB"."dbo"."stg_patients"
where patient_id is not null
group by patient_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_ca5f2c44061a50ea3f645d645250418e_4267]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_ca5f2c44061a50ea3f645d645250418e_4267]
  ;')
[0m15:05:04.501858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:04.502857 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:04.502857 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:04.516003 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:04.526273 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0: ROLLBACK
[0m15:05:04.527280 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0: Close
[0m15:05:04.528246 [info ] [Thread-1 (]: 21 of 22 PASS unique_stg_patients_patient_id ................................... [[32mPASS[0m in 0.05s]
[0m15:05:04.530485 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0
[0m15:05:04.531491 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8
[0m15:05:04.532515 [info ] [Thread-1 (]: 22 of 22 START test unique_stg_pharmacy_rx_id .................................. [RUN]
[0m15:05:04.533531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0, now test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8)
[0m15:05:04.534580 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8
[0m15:05:04.535528 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8"
[0m15:05:04.535528 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8
[0m15:05:04.594362 [debug] [Thread-1 (]: Writing runtime sql for node "test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8"
[0m15:05:04.594362 [debug] [Thread-1 (]: Using sqlserver connection "test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8"
[0m15:05:04.594362 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8"} */

    -- Create target schema if it does not
  USE [ReadmitDB];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_6a74a5763996ca376649e01ff4c8b1f6_13053]
   as 
    
    
    

select
    rx_id as unique_field,
    count(*) as n_records

from "ReadmitDB"."dbo"."stg_pharmacy"
where rx_id is not null
group by rx_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_6a74a5763996ca376649e01ff4c8b1f6_13053]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_6a74a5763996ca376649e01ff4c8b1f6_13053]
  ;')
[0m15:05:04.594362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:04.594362 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:05:04.594362 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:05:04.642819 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:04.642819 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8: ROLLBACK
[0m15:05:04.642819 [debug] [Thread-1 (]: On test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8: Close
[0m15:05:04.642819 [info ] [Thread-1 (]: 22 of 22 PASS unique_stg_pharmacy_rx_id ........................................ [[32mPASS[0m in 0.11s]
[0m15:05:04.642819 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8
[0m15:05:04.658444 [debug] [MainThread]: On master: COMMIT
[0m15:05:04.658444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:04.658444 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m15:05:04.658444 [debug] [MainThread]: Connection 'test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8' was properly closed.
[0m15:05:04.658444 [info ] [MainThread]: 
[0m15:05:04.658444 [info ] [MainThread]: Finished running 22 data tests in 0 hours 0 minutes and 1.31 seconds (1.31s).
[0m15:05:04.671593 [debug] [MainThread]: Command end result
[0m15:05:04.694214 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m15:05:04.694214 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m15:05:04.694214 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m15:05:04.694214 [info ] [MainThread]: 
[0m15:05:04.694214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:05:04.709442 [info ] [MainThread]: 
[0m15:05:04.710448 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=22
[0m15:05:04.711460 [debug] [MainThread]: Command `dbt test` succeeded at 15:05:04.711460 after 2.60 seconds
[0m15:05:04.712446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFE2A8A390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFE2A8A190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFE2A8AA10>]}
[0m15:05:04.712446 [debug] [MainThread]: Flushing usage events
[0m15:05:06.096376 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:21:37.356170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002163834DC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002163B9D6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002163B9D5110>]}


============================== 15:21:37.356170 | 68d24dcf-00ed-42e1-9da2-c2a4c7c24d59 ==============================
[0m15:21:37.356170 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:21:37.356170 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m15:21:37.684395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68d24dcf-00ed-42e1-9da2-c2a4c7c24d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002163B9D5990>]}
[0m15:21:37.734085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68d24dcf-00ed-42e1-9da2-c2a4c7c24d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002163D0D4C90>]}
[0m15:21:37.734085 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:21:37.879591 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m15:21:38.067033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:21:38.067033 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:21:38.098309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68d24dcf-00ed-42e1-9da2-c2a4c7c24d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002163D0E47D0>]}
[0m15:21:38.129493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68d24dcf-00ed-42e1-9da2-c2a4c7c24d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002163D792B50>]}
[0m15:21:38.129493 [info ] [MainThread]: Found 5 seeds, 13 models, 22 data tests, 510 macros
[0m15:21:38.129493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68d24dcf-00ed-42e1-9da2-c2a4c7c24d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002163D558510>]}
[0m15:21:38.129493 [info ] [MainThread]: 
[0m15:21:38.129493 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:21:38.129493 [info ] [MainThread]: 
[0m15:21:38.129493 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:21:38.148005 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m15:21:38.164006 [debug] [ThreadPool]: dbt-sqlserver
[0m15:21:38.165618 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m15:21:38.165618 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:21:38.165618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:38.165618 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:21:38.267270 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:21:38.328140 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:21:38.343726 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m15:21:38.343726 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m15:21:38.343726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68d24dcf-00ed-42e1-9da2-c2a4c7c24d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002163D0C2B50>]}
[0m15:21:38.359349 [debug] [Thread-1 (]: Began running node seed.readmit_risk.admissions
[0m15:21:38.359349 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'seed.readmit_risk.admissions'
[0m15:21:38.359349 [debug] [Thread-1 (]: Began compiling node seed.readmit_risk.admissions
[0m15:21:38.359349 [debug] [Thread-1 (]: Began executing node seed.readmit_risk.admissions
[0m15:21:38.359349 [debug] [Thread-1 (]: Finished running node seed.readmit_risk.admissions
[0m15:21:38.359349 [debug] [Thread-1 (]: Began running node seed.readmit_risk.claims
[0m15:21:38.359349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.readmit_risk.admissions, now seed.readmit_risk.claims)
[0m15:21:38.359349 [debug] [Thread-1 (]: Began compiling node seed.readmit_risk.claims
[0m15:21:38.359349 [debug] [Thread-1 (]: Began executing node seed.readmit_risk.claims
[0m15:21:38.375010 [debug] [Thread-1 (]: Finished running node seed.readmit_risk.claims
[0m15:21:38.375010 [debug] [Thread-1 (]: Began running node seed.readmit_risk.labs
[0m15:21:38.375010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.readmit_risk.claims, now seed.readmit_risk.labs)
[0m15:21:38.375010 [debug] [Thread-1 (]: Began compiling node seed.readmit_risk.labs
[0m15:21:38.375010 [debug] [Thread-1 (]: Began executing node seed.readmit_risk.labs
[0m15:21:38.375010 [debug] [Thread-1 (]: Finished running node seed.readmit_risk.labs
[0m15:21:38.375010 [debug] [Thread-1 (]: Began running node seed.readmit_risk.patients
[0m15:21:38.375010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.readmit_risk.labs, now seed.readmit_risk.patients)
[0m15:21:38.375010 [debug] [Thread-1 (]: Began compiling node seed.readmit_risk.patients
[0m15:21:38.375010 [debug] [Thread-1 (]: Began executing node seed.readmit_risk.patients
[0m15:21:38.375010 [debug] [Thread-1 (]: Finished running node seed.readmit_risk.patients
[0m15:21:38.375010 [debug] [Thread-1 (]: Began running node seed.readmit_risk.pharmacy
[0m15:21:38.375010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.readmit_risk.patients, now seed.readmit_risk.pharmacy)
[0m15:21:38.375010 [debug] [Thread-1 (]: Began compiling node seed.readmit_risk.pharmacy
[0m15:21:38.375010 [debug] [Thread-1 (]: Began executing node seed.readmit_risk.pharmacy
[0m15:21:38.375010 [debug] [Thread-1 (]: Finished running node seed.readmit_risk.pharmacy
[0m15:21:38.375010 [debug] [Thread-1 (]: Began running node model.readmit_risk.stg_admissions
[0m15:21:38.375010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.readmit_risk.pharmacy, now model.readmit_risk.stg_admissions)
[0m15:21:38.375010 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.stg_admissions
[0m15:21:38.390636 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.stg_admissions"
[0m15:21:38.390636 [debug] [Thread-1 (]: Began executing node model.readmit_risk.stg_admissions
[0m15:21:38.390636 [debug] [Thread-1 (]: Finished running node model.readmit_risk.stg_admissions
[0m15:21:38.390636 [debug] [Thread-1 (]: Began running node model.readmit_risk.stg_claims
[0m15:21:38.390636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.stg_admissions, now model.readmit_risk.stg_claims)
[0m15:21:38.390636 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.stg_claims
[0m15:21:38.390636 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.stg_claims"
[0m15:21:38.390636 [debug] [Thread-1 (]: Began executing node model.readmit_risk.stg_claims
[0m15:21:38.390636 [debug] [Thread-1 (]: Finished running node model.readmit_risk.stg_claims
[0m15:21:38.390636 [debug] [Thread-1 (]: Began running node model.readmit_risk.stg_labs
[0m15:21:38.390636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.stg_claims, now model.readmit_risk.stg_labs)
[0m15:21:38.390636 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.stg_labs
[0m15:21:38.390636 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.stg_labs"
[0m15:21:38.390636 [debug] [Thread-1 (]: Began executing node model.readmit_risk.stg_labs
[0m15:21:38.390636 [debug] [Thread-1 (]: Finished running node model.readmit_risk.stg_labs
[0m15:21:38.406253 [debug] [Thread-1 (]: Began running node model.readmit_risk.stg_patients
[0m15:21:38.406253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.stg_labs, now model.readmit_risk.stg_patients)
[0m15:21:38.406253 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.stg_patients
[0m15:21:38.406253 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.stg_patients"
[0m15:21:38.406253 [debug] [Thread-1 (]: Began executing node model.readmit_risk.stg_patients
[0m15:21:38.406253 [debug] [Thread-1 (]: Finished running node model.readmit_risk.stg_patients
[0m15:21:38.406253 [debug] [Thread-1 (]: Began running node model.readmit_risk.stg_pharmacy
[0m15:21:38.406253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.stg_patients, now model.readmit_risk.stg_pharmacy)
[0m15:21:38.406253 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.stg_pharmacy
[0m15:21:38.406253 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.stg_pharmacy"
[0m15:21:38.406253 [debug] [Thread-1 (]: Began executing node model.readmit_risk.stg_pharmacy
[0m15:21:38.406253 [debug] [Thread-1 (]: Finished running node model.readmit_risk.stg_pharmacy
[0m15:21:38.406253 [debug] [Thread-1 (]: Began running node model.readmit_risk.admissions_enriched
[0m15:21:38.406253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.stg_pharmacy, now model.readmit_risk.admissions_enriched)
[0m15:21:38.406253 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.admissions_enriched
[0m15:21:38.421882 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.admissions_enriched"
[0m15:21:38.421882 [debug] [Thread-1 (]: Began executing node model.readmit_risk.admissions_enriched
[0m15:21:38.421882 [debug] [Thread-1 (]: Finished running node model.readmit_risk.admissions_enriched
[0m15:21:38.421882 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5
[0m15:21:38.421882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.admissions_enriched, now test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5)
[0m15:21:38.421882 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5
[0m15:21:38.421882 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5"
[0m15:21:38.421882 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5
[0m15:21:38.437463 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5
[0m15:21:38.437463 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_admissions_patient_id.0706065292
[0m15:21:38.437463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_admissions_admission_id.9974668cd5, now test.readmit_risk.not_null_stg_admissions_patient_id.0706065292)
[0m15:21:38.437463 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_admissions_patient_id.0706065292
[0m15:21:38.437463 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_admissions_patient_id.0706065292"
[0m15:21:38.437463 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_admissions_patient_id.0706065292
[0m15:21:38.437463 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_admissions_patient_id.0706065292
[0m15:21:38.437463 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_stg_admissions_admission_id.bc99100827
[0m15:21:38.437463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_admissions_patient_id.0706065292, now test.readmit_risk.unique_stg_admissions_admission_id.bc99100827)
[0m15:21:38.437463 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_stg_admissions_admission_id.bc99100827
[0m15:21:38.437463 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_stg_admissions_admission_id.bc99100827"
[0m15:21:38.437463 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_stg_admissions_admission_id.bc99100827
[0m15:21:38.437463 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_stg_admissions_admission_id.bc99100827
[0m15:21:38.437463 [debug] [Thread-1 (]: Began running node model.readmit_risk.claims_agg
[0m15:21:38.437463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_stg_admissions_admission_id.bc99100827, now model.readmit_risk.claims_agg)
[0m15:21:38.437463 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.claims_agg
[0m15:21:38.453157 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.claims_agg"
[0m15:21:38.453157 [debug] [Thread-1 (]: Began executing node model.readmit_risk.claims_agg
[0m15:21:38.453157 [debug] [Thread-1 (]: Finished running node model.readmit_risk.claims_agg
[0m15:21:38.453157 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86
[0m15:21:38.453157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.claims_agg, now test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86)
[0m15:21:38.453157 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86
[0m15:21:38.453157 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86"
[0m15:21:38.453157 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86
[0m15:21:38.453157 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86
[0m15:21:38.453157 [debug] [Thread-1 (]: Began running node test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c
[0m15:21:38.453157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_claims_claim_id.f8032ece86, now test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c)
[0m15:21:38.453157 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c
[0m15:21:38.453157 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c"
[0m15:21:38.468823 [debug] [Thread-1 (]: Began executing node test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c
[0m15:21:38.468823 [debug] [Thread-1 (]: Finished running node test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c
[0m15:21:38.468823 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5
[0m15:21:38.468823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.relationships_stg_claims_admission_id__admission_id__ref_stg_admissions_.164a89140c, now test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5)
[0m15:21:38.468823 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5
[0m15:21:38.468823 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5"
[0m15:21:38.468823 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5
[0m15:21:38.468823 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5
[0m15:21:38.468823 [debug] [Thread-1 (]: Began running node model.readmit_risk.labs_latest
[0m15:21:38.468823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_stg_claims_claim_id.0e20e780e5, now model.readmit_risk.labs_latest)
[0m15:21:38.468823 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.labs_latest
[0m15:21:38.468823 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.labs_latest"
[0m15:21:38.468823 [debug] [Thread-1 (]: Began executing node model.readmit_risk.labs_latest
[0m15:21:38.468823 [debug] [Thread-1 (]: Finished running node model.readmit_risk.labs_latest
[0m15:21:38.468823 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_labs_lab_id.e63312a399
[0m15:21:38.468823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.labs_latest, now test.readmit_risk.not_null_stg_labs_lab_id.e63312a399)
[0m15:21:38.468823 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_labs_lab_id.e63312a399
[0m15:21:38.484441 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_labs_lab_id.e63312a399"
[0m15:21:38.484441 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_labs_lab_id.e63312a399
[0m15:21:38.484441 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_labs_lab_id.e63312a399
[0m15:21:38.484441 [debug] [Thread-1 (]: Began running node test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b
[0m15:21:38.484441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_labs_lab_id.e63312a399, now test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b)
[0m15:21:38.484441 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b
[0m15:21:38.484441 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b"
[0m15:21:38.484441 [debug] [Thread-1 (]: Began executing node test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b
[0m15:21:38.484441 [debug] [Thread-1 (]: Finished running node test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b
[0m15:21:38.484441 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e
[0m15:21:38.484441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.relationships_stg_labs_admission_id__admission_id__ref_stg_admissions_.f1834ebd9b, now test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e)
[0m15:21:38.484441 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e
[0m15:21:38.484441 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e"
[0m15:21:38.484441 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e
[0m15:21:38.484441 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e
[0m15:21:38.484441 [debug] [Thread-1 (]: Began running node model.readmit_risk.patients_enriched
[0m15:21:38.500009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_stg_labs_lab_id.accf0ec63e, now model.readmit_risk.patients_enriched)
[0m15:21:38.500009 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.patients_enriched
[0m15:21:38.500009 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.patients_enriched"
[0m15:21:38.500009 [debug] [Thread-1 (]: Began executing node model.readmit_risk.patients_enriched
[0m15:21:38.500009 [debug] [Thread-1 (]: Finished running node model.readmit_risk.patients_enriched
[0m15:21:38.500009 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_patients_patient_id.e578180344
[0m15:21:38.500009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.patients_enriched, now test.readmit_risk.not_null_stg_patients_patient_id.e578180344)
[0m15:21:38.500009 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_patients_patient_id.e578180344
[0m15:21:38.500009 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_patients_patient_id.e578180344"
[0m15:21:38.500009 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_patients_patient_id.e578180344
[0m15:21:38.500009 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_patients_patient_id.e578180344
[0m15:21:38.500009 [debug] [Thread-1 (]: Began running node test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba
[0m15:21:38.500009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_patients_patient_id.e578180344, now test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba)
[0m15:21:38.500009 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba
[0m15:21:38.500009 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba"
[0m15:21:38.515673 [debug] [Thread-1 (]: Began executing node test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba
[0m15:21:38.515673 [debug] [Thread-1 (]: Finished running node test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba
[0m15:21:38.515673 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0
[0m15:21:38.515673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.relationships_stg_admissions_patient_id__patient_id__ref_stg_patients_.befd48eeba, now test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0)
[0m15:21:38.515673 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0
[0m15:21:38.515673 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0"
[0m15:21:38.515673 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0
[0m15:21:38.515673 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0
[0m15:21:38.515673 [debug] [Thread-1 (]: Began running node model.readmit_risk.pharmacy_agg
[0m15:21:38.515673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_stg_patients_patient_id.8907d3ccf0, now model.readmit_risk.pharmacy_agg)
[0m15:21:38.515673 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.pharmacy_agg
[0m15:21:38.515673 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.pharmacy_agg"
[0m15:21:38.515673 [debug] [Thread-1 (]: Began executing node model.readmit_risk.pharmacy_agg
[0m15:21:38.515673 [debug] [Thread-1 (]: Finished running node model.readmit_risk.pharmacy_agg
[0m15:21:38.515673 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a
[0m15:21:38.515673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.pharmacy_agg, now test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a)
[0m15:21:38.515673 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a
[0m15:21:38.531272 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a"
[0m15:21:38.531272 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a
[0m15:21:38.531272 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a
[0m15:21:38.531272 [debug] [Thread-1 (]: Began running node test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8
[0m15:21:38.531272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_stg_pharmacy_rx_id.0abb63556a, now test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8)
[0m15:21:38.531272 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8
[0m15:21:38.531272 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8"
[0m15:21:38.531272 [debug] [Thread-1 (]: Began executing node test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8
[0m15:21:38.531272 [debug] [Thread-1 (]: Finished running node test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8
[0m15:21:38.531272 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8
[0m15:21:38.531272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.relationships_stg_pharmacy_admission_id__admission_id__ref_stg_admissions_.7ac04784a8, now test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8)
[0m15:21:38.531272 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8
[0m15:21:38.531272 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8"
[0m15:21:38.531272 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8
[0m15:21:38.531272 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8
[0m15:21:38.531272 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f
[0m15:21:38.531272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_stg_pharmacy_rx_id.5c585f7ce8, now test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f)
[0m15:21:38.546829 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f
[0m15:21:38.546829 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f"
[0m15:21:38.546829 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f
[0m15:21:38.546829 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f
[0m15:21:38.546829 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e
[0m15:21:38.546829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_admissions_enriched_admission_id.2b4079e66f, now test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e)
[0m15:21:38.546829 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e
[0m15:21:38.546829 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e"
[0m15:21:38.546829 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e
[0m15:21:38.546829 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e
[0m15:21:38.546829 [debug] [Thread-1 (]: Began running node model.readmit_risk.dim_patient
[0m15:21:38.546829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_admissions_enriched_admission_id.de290e9d8e, now model.readmit_risk.dim_patient)
[0m15:21:38.546829 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.dim_patient
[0m15:21:38.546829 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.dim_patient"
[0m15:21:38.546829 [debug] [Thread-1 (]: Began executing node model.readmit_risk.dim_patient
[0m15:21:38.546829 [debug] [Thread-1 (]: Finished running node model.readmit_risk.dim_patient
[0m15:21:38.546829 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46
[0m15:21:38.546829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.dim_patient, now test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46)
[0m15:21:38.546829 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46
[0m15:21:38.562478 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46"
[0m15:21:38.562478 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46
[0m15:21:38.562478 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46
[0m15:21:38.562478 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7
[0m15:21:38.562478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_patients_enriched_patient_id.f86f27ba46, now test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7)
[0m15:21:38.562478 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7
[0m15:21:38.562478 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7"
[0m15:21:38.562478 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7
[0m15:21:38.562478 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7
[0m15:21:38.562478 [debug] [Thread-1 (]: Began running node model.readmit_risk.fact_readmissions
[0m15:21:38.562478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.unique_patients_enriched_patient_id.0b6b5043e7, now model.readmit_risk.fact_readmissions)
[0m15:21:38.562478 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.fact_readmissions
[0m15:21:38.562478 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.fact_readmissions"
[0m15:21:38.562478 [debug] [Thread-1 (]: Began executing node model.readmit_risk.fact_readmissions
[0m15:21:38.562478 [debug] [Thread-1 (]: Finished running node model.readmit_risk.fact_readmissions
[0m15:21:38.562478 [debug] [Thread-1 (]: Began running node model.readmit_risk.features_ml
[0m15:21:38.562478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.fact_readmissions, now model.readmit_risk.features_ml)
[0m15:21:38.578125 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.features_ml
[0m15:21:38.578125 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.features_ml"
[0m15:21:38.578125 [debug] [Thread-1 (]: Began executing node model.readmit_risk.features_ml
[0m15:21:38.578125 [debug] [Thread-1 (]: Finished running node model.readmit_risk.features_ml
[0m15:21:38.578125 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c
[0m15:21:38.578125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.readmit_risk.features_ml, now test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c)
[0m15:21:38.578125 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c
[0m15:21:38.578125 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c"
[0m15:21:38.578125 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c
[0m15:21:38.578125 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c
[0m15:21:38.578125 [debug] [Thread-1 (]: Began running node test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0
[0m15:21:38.578125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_fact_readmissions_admission_id.7bb270e67c, now test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0)
[0m15:21:38.578125 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0
[0m15:21:38.578125 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0"
[0m15:21:38.593777 [debug] [Thread-1 (]: Began executing node test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0
[0m15:21:38.593777 [debug] [Thread-1 (]: Finished running node test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0
[0m15:21:38.593777 [debug] [Thread-1 (]: Began running node test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d
[0m15:21:38.593777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.readmit_risk.not_null_fact_readmissions_label_readmit_30.72e74f62d0, now test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d)
[0m15:21:38.593777 [debug] [Thread-1 (]: Began compiling node test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d
[0m15:21:38.593777 [debug] [Thread-1 (]: Writing injected SQL for node "test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d"
[0m15:21:38.593777 [debug] [Thread-1 (]: Began executing node test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d
[0m15:21:38.593777 [debug] [Thread-1 (]: Finished running node test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d
[0m15:21:38.593777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:38.593777 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m15:21:38.593777 [debug] [MainThread]: Connection 'test.readmit_risk.unique_fact_readmissions_admission_id.3c9915343d' was properly closed.
[0m15:21:38.609398 [debug] [MainThread]: Command end result
[0m15:21:38.671915 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m15:21:38.671915 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m15:21:38.687543 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m15:21:39.267136 [debug] [MainThread]: Acquiring new sqlserver connection 'generate_catalog'
[0m15:21:39.267136 [info ] [MainThread]: Building catalog
[0m15:21:39.282761 [debug] [ThreadPool]: Acquiring new sqlserver connection 'ReadmitDB.information_schema'
[0m15:21:39.299618 [debug] [ThreadPool]: dbt-sqlserver
[0m15:21:39.301127 [debug] [ThreadPool]: Using sqlserver connection "ReadmitDB.information_schema"
[0m15:21:39.301127 [debug] [ThreadPool]: On ReadmitDB.information_schema: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "ReadmitDB.information_schema"} */
with
    principals as (
        select
            name as principal_name,
            principal_id as principal_id
        from
            sys.database_principals with (nolock)
    ),

    schemas as (
        select
            name as schema_name,
            schema_id as schema_id,
            principal_id as principal_id
        from
            sys.schemas with (nolock)
    ),

    tables as (
        select
            object_id,
            name as table_name,
            schema_id as schema_id,
            principal_id as principal_id,
            'BASE TABLE' as table_type
        from
            sys.tables with (nolock)
    ),

    tables_with_metadata as (
        select
            object_id,
            table_name,
            schema_name,
            coalesce(tables.principal_id, schemas.principal_id) as owner_principal_id,
            table_type
        from
            tables
        join schemas on tables.schema_id = schemas.schema_id
    ),

    views as (
        select
            object_id,
            name as table_name,
            schema_id as schema_id,
            principal_id as principal_id,
            'VIEW' as table_type
        from
            sys.views with (nolock)
    ),

    views_with_metadata as (
        select
            object_id,
            table_name,
            schema_name,
            coalesce(views.principal_id, schemas.principal_id) as owner_principal_id,
            table_type
        from
            views
        join schemas on views.schema_id = schemas.schema_id
    ),

    tables_and_views as (
        select
            object_id,
            table_name,
            schema_name,
            principal_name,
            table_type
        from
            tables_with_metadata
        join principals on tables_with_metadata.owner_principal_id = principals.principal_id
        union all
        select
            object_id,
            table_name,
            schema_name,
            principal_name,
            table_type
        from
            views_with_metadata
        join principals on views_with_metadata.owner_principal_id = principals.principal_id
    ),

    cols as (

        select
            c.object_id,
            c.name as column_name,
            c.column_id as column_index,
            t.name as column_type
        from sys.columns as c with (nolock)
        left join sys.types as t on c.system_type_id = t.system_type_id
    )

    select
        DB_NAME() as table_database,
        tv.schema_name as table_schema,
        tv.table_name,
        tv.table_type,
        null as table_comment,
        tv.principal_name as table_owner,
        cols.column_name,
        cols.column_index,
        cols.column_type,
        null as column_comment
    from tables_and_views tv
    join cols on tv.object_id = cols.object_id
    where (
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('stg_labs')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('patients')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('pharmacy_agg')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('claims_agg')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('stg_claims')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('patients_enriched')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('stg_pharmacy')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('labs')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('features_ml')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('fact_readmissions')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('admissions')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('stg_admissions')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('dim_patient')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('labs_latest')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('admissions_enriched')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('pharmacy')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('claims')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('stg_patients')
                )
            )

    order by column_index
    
    OPTION (LABEL = 'dbt-sqlserver');

[0m15:21:39.302908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:39.303377 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:21:39.303377 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:21:39.584714 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:21:39.584714 [debug] [ThreadPool]: On ReadmitDB.information_schema: ROLLBACK
[0m15:21:39.584714 [debug] [ThreadPool]: On ReadmitDB.information_schema: Close
[0m15:21:39.601094 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\catalog.json
[0m15:21:39.631814 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m15:21:39.631814 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m15:21:39.631814 [info ] [MainThread]: Catalog written to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\catalog.json
[0m15:21:39.631814 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:21:39.631814 after 2.35 seconds
[0m15:21:39.631814 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:21:39.631814 [debug] [MainThread]: Connection 'ReadmitDB.information_schema' was properly closed.
[0m15:21:39.631814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002163A422B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021634CCA710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021634CCA250>]}
[0m15:21:39.631814 [debug] [MainThread]: Flushing usage events
[0m15:21:48.136186 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:21:54.991013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98EDE7C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98F043D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98F1097D0>]}


============================== 15:21:55.008825 | 835e6f45-06d7-4849-9c05-2d5feff521f9 ==============================
[0m15:21:55.008825 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:21:55.009712 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'None', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m15:21:55.317094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '835e6f45-06d7-4849-9c05-2d5feff521f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98F1D6050>]}
[0m15:21:55.363961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '835e6f45-06d7-4849-9c05-2d5feff521f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9908DCC90>]}
[0m15:21:55.457690 [error] [MainThread]: Encountered an error:
[WinError 10013] An attempt was made to access a socket in a way forbidden by its access permissions
[0m15:21:55.490769 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\cli\requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\cli\requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 456, in __init__
    self.server_bind()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 472, in server_bind
    self.socket.bind(self.server_address)
PermissionError: [WinError 10013] An attempt was made to access a socket in a way forbidden by its access permissions

[0m15:21:55.492803 [debug] [MainThread]: Command `dbt docs serve` failed at 15:21:55.492803 after 0.56 seconds
[0m15:21:55.493777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98F112610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98F19A310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98F19A1D0>]}
[0m15:21:55.494213 [debug] [MainThread]: Flushing usage events
[0m15:22:03.692841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:25:17.126250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2272ACA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2272AC090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2273DB990>]}


============================== 15:25:17.142349 | 676b4edf-959c-4271-94be-65138b1de098 ==============================
[0m15:25:17.142349 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:25:17.142349 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt docs serve --port 8085', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m15:25:17.426035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '676b4edf-959c-4271-94be-65138b1de098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A228C4A890>]}
[0m15:25:17.483381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '676b4edf-959c-4271-94be-65138b1de098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2263A7DD0>]}
[0m15:31:51.247392 [error] [MainThread]: Encountered an error:

[0m15:31:51.296605 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\cli\requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\cli\requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m15:31:51.302522 [debug] [MainThread]: Command `dbt docs serve` failed at 15:31:51.301519 after 394.26 seconds
[0m15:31:51.304109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2273E44D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A227372610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A226B85590>]}
[0m15:31:51.305261 [debug] [MainThread]: Flushing usage events
[0m15:40:07.657702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169344B33D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001693358EAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169344A9550>]}


============================== 15:40:07.657702 | 4463982b-675d-4ab7-bd6e-a06afa5e1843 ==============================
[0m15:40:07.657702 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:40:07.657702 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select features_ml', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt'}
[0m15:40:08.005459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4463982b-675d-4ab7-bd6e-a06afa5e1843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169344A9350>]}
[0m15:40:08.052329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4463982b-675d-4ab7-bd6e-a06afa5e1843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016934504CD0>]}
[0m15:40:08.052329 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:40:08.217283 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m15:40:08.285098 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:40:08.285098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4463982b-675d-4ab7-bd6e-a06afa5e1843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016933C3A7D0>]}
[0m15:40:09.282387 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'claims_enriched' in the 'models' section of file 'models\core\schema.yml'
[0m15:40:09.282387 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'labs_enriched' in the 'models' section of file 'models\core\schema.yml'
[0m15:40:09.282387 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'pharmacy_enriched' in the 'models' section of file 'models\core\schema.yml'
[0m15:40:09.423362 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.readmit_risk.not_null_claims_enriched_claim_id.bc86ff40d2' (models\core\schema.yml) depends on a node named 'claims_enriched' in package '' which was not found
[0m15:40:09.424256 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.readmit_risk.unique_claims_enriched_claim_id.e459bab564' (models\core\schema.yml) depends on a node named 'claims_enriched' in package '' which was not found
[0m15:40:09.425257 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.readmit_risk.not_null_labs_enriched_lab_id.917247a7e2' (models\core\schema.yml) depends on a node named 'labs_enriched' in package '' which was not found
[0m15:40:09.426422 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.readmit_risk.unique_labs_enriched_lab_id.4104eb1c96' (models\core\schema.yml) depends on a node named 'labs_enriched' in package '' which was not found
[0m15:40:09.426831 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.readmit_risk.not_null_pharmacy_enriched_rx_id.3cd07b5749' (models\core\schema.yml) depends on a node named 'pharmacy_enriched' in package '' which was not found
[0m15:40:09.427431 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.readmit_risk.unique_pharmacy_enriched_rx_id.cb8eaad8cd' (models\core\schema.yml) depends on a node named 'pharmacy_enriched' in package '' which was not found
[0m15:40:09.512795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4463982b-675d-4ab7-bd6e-a06afa5e1843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169362BE9D0>]}
[0m15:40:09.657097 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m15:40:09.659141 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m15:40:09.684053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4463982b-675d-4ab7-bd6e-a06afa5e1843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001693609DDD0>]}
[0m15:40:09.684053 [info ] [MainThread]: Found 13 models, 5 seeds, 22 data tests, 510 macros
[0m15:40:09.684053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4463982b-675d-4ab7-bd6e-a06afa5e1843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001693667C550>]}
[0m15:40:09.684053 [info ] [MainThread]: 
[0m15:40:09.684053 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:40:09.684053 [info ] [MainThread]: 
[0m15:40:09.699058 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:40:09.699058 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB'
[0m15:40:09.699058 [debug] [ThreadPool]: dbt-sqlserver
[0m15:40:09.699058 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB"
[0m15:40:09.699058 [debug] [ThreadPool]: On list_ReadmitDB: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB"} */
USE [ReadmitDB];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:40:09.714716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:09.714716 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:40:09.866515 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:40:09.868470 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:40:09.868470 [debug] [ThreadPool]: On list_ReadmitDB: Close
[0m15:40:09.894304 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m15:40:09.900834 [debug] [ThreadPool]: dbt-sqlserver
[0m15:40:09.900834 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m15:40:09.900834 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:40:09.900834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:09.900834 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:40:09.900834 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:40:10.021730 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:40:10.025651 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m15:40:10.025651 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m15:40:10.030426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4463982b-675d-4ab7-bd6e-a06afa5e1843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169364C4350>]}
[0m15:40:10.031358 [debug] [MainThread]: On master: COMMIT
[0m15:40:10.036204 [debug] [Thread-1 (]: Began running node model.readmit_risk.features_ml
[0m15:40:10.036204 [info ] [Thread-1 (]: 1 of 1 START sql table model dbo.features_ml ................................... [RUN]
[0m15:40:10.037364 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.readmit_risk.features_ml'
[0m15:40:10.038423 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.features_ml
[0m15:40:10.045476 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.features_ml"
[0m15:40:10.046490 [debug] [Thread-1 (]: Began executing node model.readmit_risk.features_ml
[0m15:40:10.074643 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:40:10.086350 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."features_ml__dbt_tmp__dbt_tmp_vw"
[0m15:40:10.086350 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:40:10.086350 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:40:10.086350 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'features_ml__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:40:10.086350 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:40:10.086350 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:40:10.086350 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:40:10.133319 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:40:10.135367 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:40:10.136332 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."features_ml__dbt_tmp__dbt_tmp_vw";');

[0m15:40:10.138919 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:40:10.150588 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.features_ml"
[0m15:40:10.150588 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:40:10.150588 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

  
    USE [ReadmitDB];
    USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."features_ml__dbt_tmp__dbt_tmp_vw" as 

with patient_data as (
    select
        patient_id,
        age,
        gender,
        ethnicity,
        bmi,
        ses_group,
        ever_diabetes,
        ever_heart_failure,
        ever_copd,
        ever_ckd
    from "ReadmitDB"."dbo"."dim_patient"
),

admission_data as (
    select
        admission_id,
        patient_id,
        length_of_stay,
        prior_admissions,
        department,
        readmitted_30d as readmit_label
    from "ReadmitDB"."dbo"."fact_readmissions"
),

claims_agg as (
    select
        admission_id,
        sum(amount_billed) as sum_billed,
        sum(amount_paid) as sum_paid
    from "ReadmitDB"."dbo"."stg_claims"
    group by admission_id
),

labs_agg as (
    select
        admission_id,
        avg(glucose_mgdl) as avg_glucose,
        max(hba1c_pct) as max_hba1c,
        avg(creatinine_mgdl) as avg_creatinine,
        avg(systolic_bp) as avg_systolic_bp
    from "ReadmitDB"."dbo"."stg_labs"
    group by admission_id
),

pharmacy_agg as (
    select
        admission_id,
        avg(adherence_rate) as avg_adherence
    from "ReadmitDB"."dbo"."stg_pharmacy"
    group by admission_id
)

select
    a.admission_id,
    a.patient_id,
    p.age,
    p.gender,
    p.ethnicity,
    p.bmi,
    p.ses_group,
    p.ever_diabetes,
    p.ever_heart_failure,
    p.ever_copd,
    p.ever_ckd,
    a.length_of_stay,
    a.prior_admissions,
    a.department,
    c.sum_billed,
    c.sum_paid,
    l.avg_glucose,
    l.max_hba1c,
    l.avg_creatinine,
    l.avg_systolic_bp,
    ph.avg_adherence,
    a.readmit_label
from admission_data a
left join patient_data p on a.patient_id = p.patient_id
left join claims_agg c on a.admission_id = c.admission_id
left join labs_agg l on a.admission_id = l.admission_id
left join pharmacy_agg ph on a.admission_id = ph.admission_id
;
-- this view aggregates patient and admission data, including demographics, clinical history, and financials
-- it serves as a comprehensive dataset for readmission risk modeling 
-- and is designed to be used in further feature engineering and model training processes
-- the view combines data from multiple staging tables to create a unified patient profile
-- this staging model cleans and normalizes patient data for further analysis
-- it ensures that all relevant patient attributes are available for modeling readmission risk
-- this staging model cleans and normalizes patient data for further analysis;
    ')

EXEC('
            SELECT * INTO "ReadmitDB"."dbo"."features_ml__dbt_tmp" FROM "ReadmitDB"."dbo"."features_ml__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.features_ml__dbt_tmp__dbt_tmp_vw')



    
    use [ReadmitDB];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_features_ml__dbt_tmp_cci'
        AND object_id=object_id('dbo_features_ml__dbt_tmp')
    )
    DROP index "dbo"."features_ml__dbt_tmp".dbo_features_ml__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_features_ml__dbt_tmp_cci
    ON "dbo"."features_ml__dbt_tmp"

   


  
[0m15:40:10.190286 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:40:10.193369 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: ROLLBACK
[0m15:40:10.194362 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: Close
[0m15:40:10.195329 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\readmit_risk\models\core\features_ml.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'readmitted_30d'. (207) (SQLMoreResults)")
[0m15:40:10.317182 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\task\base.py", line 363, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\task\base.py", line 310, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\task\base.py", line 410, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\task\run.py", line 336, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\task\run.py", line 296, in _execute_model
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\clients\jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt_common\clients\jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 82, in macro
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\clients\jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt_common\clients\jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt_common\record.py", line 507, in record_replay_wrapper
    return func_to_record(*call_args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\adapters\base\impl.py", line 449, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'readmitted_30d'. (207) (SQLMoreResults)")

[0m15:40:10.318367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4463982b-675d-4ab7-bd6e-a06afa5e1843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169360EDF50>]}
[0m15:40:10.318367 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbo.features_ml .......................... [[31mERROR[0m in 0.28s]
[0m15:40:10.318367 [debug] [Thread-1 (]: Finished running node model.readmit_risk.features_ml
[0m15:40:10.318367 [debug] [Thread-4 (]: Marking all children of 'model.readmit_risk.features_ml' to be skipped because of status 'error'.  Reason: ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'readmitted_30d'. (207) (SQLMoreResults)").
[0m15:40:10.318367 [debug] [MainThread]: On master: COMMIT
[0m15:40:10.318367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:10.318367 [debug] [MainThread]: Connection 'list_ReadmitDB' was properly closed.
[0m15:40:10.318367 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m15:40:10.318367 [debug] [MainThread]: Connection 'model.readmit_risk.features_ml' was properly closed.
[0m15:40:10.318367 [info ] [MainThread]: 
[0m15:40:10.318367 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m15:40:10.326352 [debug] [MainThread]: Command end result
[0m15:40:10.350417 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m15:40:10.352656 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m15:40:10.352656 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m15:40:10.352656 [info ] [MainThread]: 
[0m15:40:10.352656 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:40:10.352656 [info ] [MainThread]: 
[0m15:40:10.352656 [error] [MainThread]: [31mFailure in model features_ml (models\core\features_ml.sql)[0m
[0m15:40:10.352656 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'readmitted_30d'. (207) (SQLMoreResults)")
[0m15:40:10.352656 [info ] [MainThread]: 
[0m15:40:10.352656 [info ] [MainThread]:   compiled code at target\compiled\readmit_risk\models\core\features_ml.sql
[0m15:40:10.352656 [info ] [MainThread]: 
[0m15:40:10.352656 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:40:10.352656 [debug] [MainThread]: Command `dbt run` failed at 15:40:10.352656 after 2.81 seconds
[0m15:40:10.352656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016936144190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001692D81A010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001692D81A390>]}
[0m15:40:10.364573 [debug] [MainThread]: Flushing usage events
[0m15:40:14.807653 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:24.346829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B5458E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B545A150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B545B110>]}


============================== 15:45:24.346829 | d3cc7026-a7d1-4f8a-a848-2f7ab830e2b2 ==============================
[0m15:45:24.346829 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:45:24.362466 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --models features_ml', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'printer_width': '80', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m15:45:24.362466 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:45:24.362466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd3cc7026-a7d1-4f8a-a848-2f7ab830e2b2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B54CBB50>]}
[0m15:45:24.623080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3cc7026-a7d1-4f8a-a848-2f7ab830e2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B6D4DFD0>]}
[0m15:45:24.669945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3cc7026-a7d1-4f8a-a848-2f7ab830e2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B4497D10>]}
[0m15:45:24.669945 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:45:24.839626 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m15:45:24.972893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:45:24.988517 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:45:25.066631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3cc7026-a7d1-4f8a-a848-2f7ab830e2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B711D050>]}
[0m15:45:25.129127 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m15:45:25.129127 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m15:45:25.160281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3cc7026-a7d1-4f8a-a848-2f7ab830e2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B710E8D0>]}
[0m15:45:25.160281 [info ] [MainThread]: Found 13 models, 5 seeds, 22 data tests, 510 macros
[0m15:45:25.160281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3cc7026-a7d1-4f8a-a848-2f7ab830e2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B20E7BD0>]}
[0m15:45:25.160281 [info ] [MainThread]: 
[0m15:45:25.160281 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:45:25.160281 [info ] [MainThread]: 
[0m15:45:25.160281 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:45:25.160281 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB'
[0m15:45:25.183941 [debug] [ThreadPool]: dbt-sqlserver
[0m15:45:25.185058 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB"
[0m15:45:25.185058 [debug] [ThreadPool]: On list_ReadmitDB: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB"} */
USE [ReadmitDB];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:45:25.185058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:25.185058 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:45:25.313513 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:45:25.330417 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:45:25.330417 [debug] [ThreadPool]: On list_ReadmitDB: Close
[0m15:45:25.353957 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m15:45:25.362880 [debug] [ThreadPool]: dbt-sqlserver
[0m15:45:25.363879 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m15:45:25.364495 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:45:25.364495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:25.365364 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:45:25.365364 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:45:25.458478 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:45:25.458478 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m15:45:25.474214 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m15:45:25.474214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3cc7026-a7d1-4f8a-a848-2f7ab830e2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B710D7D0>]}
[0m15:45:25.474214 [debug] [MainThread]: On master: COMMIT
[0m15:45:25.474214 [debug] [Thread-1 (]: Began running node model.readmit_risk.features_ml
[0m15:45:25.489761 [info ] [Thread-1 (]: 1 of 1 START sql table model dbo.features_ml ................................... [RUN]
[0m15:45:25.489761 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.readmit_risk.features_ml'
[0m15:45:25.489761 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.features_ml
[0m15:45:25.489761 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.features_ml"
[0m15:45:25.489761 [debug] [Thread-1 (]: Began executing node model.readmit_risk.features_ml
[0m15:45:25.522822 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:45:25.532806 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."features_ml__dbt_tmp__dbt_tmp_vw"
[0m15:45:25.532806 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:45:25.532806 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:45:25.532806 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'features_ml__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:45:25.532806 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:45:25.532806 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:45:25.549132 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:45:25.597750 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:45:25.597750 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:45:25.597750 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."features_ml__dbt_tmp__dbt_tmp_vw";');

[0m15:45:25.597750 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:45:25.613484 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.features_ml"
[0m15:45:25.613484 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:45:25.613484 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

  
    USE [ReadmitDB];
    USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."features_ml__dbt_tmp__dbt_tmp_vw" as 

with patient_data as (
    select
        patient_id,
        age,
        gender,
        ethnicity,
        bmi,
        ses_group,
        ever_diabetes,
        ever_heart_failure,
        ever_copd,
        ever_ckd
    from "ReadmitDB"."dbo"."dim_patient"
),

admission_data as (
    select
        admission_id,
        patient_id,
        length_of_stay,
        prior_admissions,
        department,
        readmitted_30d as readmit_label
    from "ReadmitDB"."dbo"."fact_readmissions"
),

claims_agg as (
    select
        admission_id,
        sum(amount_billed) as sum_billed,
        sum(amount_paid) as sum_paid
    from "ReadmitDB"."dbo"."stg_claims"
    group by admission_id
),

labs_agg as (
    select
        admission_id,
        avg(glucose_mgdl) as avg_glucose,
        max(hba1c_pct) as max_hba1c,
        avg(creatinine_mgdl) as avg_creatinine,
        avg(systolic_bp) as avg_systolic_bp
    from "ReadmitDB"."dbo"."stg_labs"
    group by admission_id
),

pharmacy_agg as (
    select
        admission_id,
        avg(adherence_rate) as avg_adherence
    from "ReadmitDB"."dbo"."stg_pharmacy"
    group by admission_id
)

select
    a.admission_id,
    a.patient_id,
    p.age,
    p.gender,
    p.ethnicity,
    p.bmi,
    p.ses_group,
    p.ever_diabetes,
    p.ever_heart_failure,
    p.ever_copd,
    p.ever_ckd,
    a.length_of_stay,
    a.prior_admissions,
    a.department,
    c.sum_billed,
    c.sum_paid,
    l.avg_glucose,
    l.max_hba1c,
    l.avg_creatinine,
    l.avg_systolic_bp,
    ph.avg_adherence,
    a.readmit_label
from admission_data a
left join patient_data p on a.patient_id = p.patient_id
left join claims_agg c on a.admission_id = c.admission_id
left join labs_agg l on a.admission_id = l.admission_id
left join pharmacy_agg ph on a.admission_id = ph.admission_id
;
-- this view aggregates patient and admission data, including demographics, clinical history, and financials
-- it serves as a comprehensive dataset for readmission risk modeling 
-- and is designed to be used in further feature engineering and model training processes
-- the view combines data from multiple staging tables to create a unified patient profile
-- this staging model cleans and normalizes patient data for further analysis
-- it ensures that all relevant patient attributes are available for modeling readmission risk
-- this staging model cleans and normalizes patient data for further analysis;
    ')

EXEC('
            SELECT * INTO "ReadmitDB"."dbo"."features_ml__dbt_tmp" FROM "ReadmitDB"."dbo"."features_ml__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.features_ml__dbt_tmp__dbt_tmp_vw')



    
    use [ReadmitDB];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_features_ml__dbt_tmp_cci'
        AND object_id=object_id('dbo_features_ml__dbt_tmp')
    )
    DROP index "dbo"."features_ml__dbt_tmp".dbo_features_ml__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_features_ml__dbt_tmp_cci
    ON "dbo"."features_ml__dbt_tmp"

   


  
[0m15:45:25.644667 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:45:25.644667 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: ROLLBACK
[0m15:45:25.644667 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: Close
[0m15:45:25.644667 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\readmit_risk\models\core\features_ml.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'readmitted_30d'. (207) (SQLMoreResults)")
[0m15:45:25.644667 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\task\base.py", line 363, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\task\base.py", line 310, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\task\base.py", line 410, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\task\run.py", line 336, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\task\run.py", line 296, in _execute_model
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\clients\jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt_common\clients\jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 82, in macro
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\clients\jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt_common\clients\jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt_common\record.py", line 507, in record_replay_wrapper
    return func_to_record(*call_args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\adapters\base\impl.py", line 449, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Documents\health-readmission-case\.venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'readmitted_30d'. (207) (SQLMoreResults)")

[0m15:45:25.660328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3cc7026-a7d1-4f8a-a848-2f7ab830e2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B6D882D0>]}
[0m15:45:25.660328 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbo.features_ml .......................... [[31mERROR[0m in 0.17s]
[0m15:45:25.660328 [debug] [Thread-1 (]: Finished running node model.readmit_risk.features_ml
[0m15:45:25.660328 [debug] [Thread-4 (]: Marking all children of 'model.readmit_risk.features_ml' to be skipped because of status 'error'.  Reason: ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'readmitted_30d'. (207) (SQLMoreResults)").
[0m15:45:25.666741 [debug] [MainThread]: On master: COMMIT
[0m15:45:25.667745 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:25.667745 [debug] [MainThread]: Connection 'list_ReadmitDB' was properly closed.
[0m15:45:25.668991 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m15:45:25.668991 [debug] [MainThread]: Connection 'model.readmit_risk.features_ml' was properly closed.
[0m15:45:25.669701 [info ] [MainThread]: 
[0m15:45:25.670260 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m15:45:25.671306 [debug] [MainThread]: Command end result
[0m15:45:25.690637 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m15:45:25.697585 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m15:45:25.702069 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m15:45:25.703031 [info ] [MainThread]: 
[0m15:45:25.704026 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:45:25.704026 [info ] [MainThread]: 
[0m15:45:25.705109 [error] [MainThread]: [31mFailure in model features_ml (models\core\features_ml.sql)[0m
[0m15:45:25.705109 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'readmitted_30d'. (207) (SQLMoreResults)")
[0m15:45:25.705109 [info ] [MainThread]: 
[0m15:45:25.705109 [info ] [MainThread]:   compiled code at target\compiled\readmit_risk\models\core\features_ml.sql
[0m15:45:25.705109 [info ] [MainThread]: 
[0m15:45:25.705109 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:45:25.705109 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:45:25.705109 [debug] [MainThread]: Command `dbt run` failed at 15:45:25.705109 after 1.41 seconds
[0m15:45:25.705109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210AE81A3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210AE81A390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B5459610>]}
[0m15:45:25.705109 [debug] [MainThread]: Flushing usage events
[0m15:45:27.882187 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:55.456217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E010A8AC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E010AD02D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E010AD0350>]}


============================== 15:45:55.456217 | 71c9412d-22df-4edb-9701-3e274d4a097a ==============================
[0m15:45:55.456217 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:45:55.456217 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --models features_ml', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'printer_width': '80', 'empty': 'False', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m15:45:55.456217 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:45:55.456217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '71c9412d-22df-4edb-9701-3e274d4a097a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E010B17D50>]}
[0m15:45:55.739661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71c9412d-22df-4edb-9701-3e274d4a097a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0123B47D0>]}
[0m15:45:55.800867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71c9412d-22df-4edb-9701-3e274d4a097a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E00FAC7C50>]}
[0m15:45:55.801363 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:45:55.949949 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m15:45:56.074829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:45:56.137425 [debug] [MainThread]: Partial parsing: updated file: readmit_risk://models\core\features_ml.sql
[0m15:45:56.334404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71c9412d-22df-4edb-9701-3e274d4a097a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0123E1E90>]}
[0m15:45:56.397012 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m15:45:56.397012 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m15:45:56.428235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71c9412d-22df-4edb-9701-3e274d4a097a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0126B6A90>]}
[0m15:45:56.428235 [info ] [MainThread]: Found 13 models, 5 seeds, 22 data tests, 510 macros
[0m15:45:56.428235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71c9412d-22df-4edb-9701-3e274d4a097a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E012670A90>]}
[0m15:45:56.428235 [info ] [MainThread]: 
[0m15:45:56.428235 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:45:56.428235 [info ] [MainThread]: 
[0m15:45:56.428235 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:45:56.428235 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB'
[0m15:45:56.453032 [debug] [ThreadPool]: dbt-sqlserver
[0m15:45:56.453032 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB"
[0m15:45:56.453032 [debug] [ThreadPool]: On list_ReadmitDB: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB"} */
USE [ReadmitDB];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:45:56.453032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:56.453032 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:45:56.513457 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:45:56.515454 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:45:56.518584 [debug] [ThreadPool]: On list_ReadmitDB: Close
[0m15:45:56.518584 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m15:45:56.518584 [debug] [ThreadPool]: dbt-sqlserver
[0m15:45:56.534282 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m15:45:56.534282 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:45:56.534282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:56.534282 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:45:56.534282 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:45:56.534282 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:45:56.534282 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m15:45:56.534282 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m15:45:56.549834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71c9412d-22df-4edb-9701-3e274d4a097a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0126D6550>]}
[0m15:45:56.549834 [debug] [MainThread]: On master: COMMIT
[0m15:45:56.549834 [debug] [Thread-1 (]: Began running node model.readmit_risk.features_ml
[0m15:45:56.549834 [info ] [Thread-1 (]: 1 of 1 START sql table model dbo.features_ml ................................... [RUN]
[0m15:45:56.549834 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.readmit_risk.features_ml'
[0m15:45:56.549834 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.features_ml
[0m15:45:56.565523 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.features_ml"
[0m15:45:56.565523 [debug] [Thread-1 (]: Began executing node model.readmit_risk.features_ml
[0m15:45:56.593035 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:45:56.601046 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."features_ml__dbt_tmp__dbt_tmp_vw"
[0m15:45:56.602956 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:45:56.602956 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:45:56.602956 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'features_ml__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:45:56.602956 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:45:56.602956 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:45:56.602956 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:45:56.602956 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:45:56.602956 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:45:56.602956 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."features_ml__dbt_tmp__dbt_tmp_vw";');

[0m15:45:56.602956 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:45:56.619126 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.features_ml"
[0m15:45:56.619126 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:45:56.619126 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

  
    USE [ReadmitDB];
    USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."features_ml__dbt_tmp__dbt_tmp_vw" as 

select
    f.admission_id,
    f.patient_id,
    dp.age,
    dp.gender,
    dp.ethnicity,
    dp.bmi,
    dp.ses_group,
    dp.ever_diabetes,
    dp.ever_heart_failure,
    dp.ever_copd,
    dp.ever_ckd,
    f.length_of_stay,
    f.prior_admissions,
    f.department,
    f.sum_billed,
    f.sum_paid,
    f.avg_adherence,
    f.high_hba1c_flag,
    f.label_readmit_30 as readmit_label
from "ReadmitDB"."dbo"."fact_readmissions" f
left join "ReadmitDB"."dbo"."dim_patient" dp 
    on f.patient_id = dp.patient_id
;;
    ')

EXEC('
            SELECT * INTO "ReadmitDB"."dbo"."features_ml__dbt_tmp" FROM "ReadmitDB"."dbo"."features_ml__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.features_ml__dbt_tmp__dbt_tmp_vw')



    
    use [ReadmitDB];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_features_ml__dbt_tmp_cci'
        AND object_id=object_id('dbo_features_ml__dbt_tmp')
    )
    DROP index "dbo"."features_ml__dbt_tmp".dbo_features_ml__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_features_ml__dbt_tmp_cci
    ON "dbo"."features_ml__dbt_tmp"

   


  
[0m15:45:56.808363 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:45:56.808363 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:45:56.808363 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.features_ml', 'features_ml__dbt_backup'
[0m15:45:57.416417 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m15:45:57.432159 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:45:57.432159 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.features_ml__dbt_tmp', 'features_ml'
[0m15:45:57.432159 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:45:57.463399 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: COMMIT
[0m15:45:57.463399 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."features_ml__dbt_backup"
[0m15:45:57.463399 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:45:57.463399 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

      
    USE [ReadmitDB];
    EXEC('DROP table IF EXISTS "dbo"."features_ml__dbt_backup";');

[0m15:45:57.463399 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:45:57.463399 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: Close
[0m15:45:57.463399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71c9412d-22df-4edb-9701-3e274d4a097a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E012ACF510>]}
[0m15:45:57.478963 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbo.features_ml .............................. [[32mOK[0m in 0.91s]
[0m15:45:57.478963 [debug] [Thread-1 (]: Finished running node model.readmit_risk.features_ml
[0m15:45:57.478963 [debug] [MainThread]: On master: COMMIT
[0m15:45:57.478963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:57.478963 [debug] [MainThread]: Connection 'list_ReadmitDB' was properly closed.
[0m15:45:57.478963 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m15:45:57.478963 [debug] [MainThread]: Connection 'model.readmit_risk.features_ml' was properly closed.
[0m15:45:57.478963 [info ] [MainThread]: 
[0m15:45:57.478963 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m15:45:57.478963 [debug] [MainThread]: Command end result
[0m15:45:57.509208 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m15:45:57.510374 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m15:45:57.510374 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m15:45:57.517266 [info ] [MainThread]: 
[0m15:45:57.518309 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:45:57.519039 [info ] [MainThread]: 
[0m15:45:57.519039 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:45:57.519039 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:45:57.519039 [debug] [MainThread]: Command `dbt run` succeeded at 15:45:57.519039 after 2.12 seconds
[0m15:45:57.519039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E010B15850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E010B17ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01317EA90>]}
[0m15:45:57.519039 [debug] [MainThread]: Flushing usage events
[0m15:45:59.251463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:47:29.289963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156D81F8990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156D81F9050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156D7FC0D10>]}


============================== 15:47:29.293436 | 038952db-67b3-4738-b6b1-144d7b82acdb ==============================
[0m15:47:29.293436 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:47:29.293436 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select features_ml', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt'}
[0m15:47:29.587074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '038952db-67b3-4738-b6b1-144d7b82acdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156D8200110>]}
[0m15:47:29.618322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '038952db-67b3-4738-b6b1-144d7b82acdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156D7237ED0>]}
[0m15:47:29.633977 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:47:29.777528 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m15:47:29.934135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:47:29.982889 [debug] [MainThread]: Partial parsing: updated file: readmit_risk://models\core\features_ml.sql
[0m15:47:30.182718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '038952db-67b3-4738-b6b1-144d7b82acdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156D9D8EA90>]}
[0m15:47:30.245709 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m15:47:30.245709 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m15:47:30.277006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '038952db-67b3-4738-b6b1-144d7b82acdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156DA04EE90>]}
[0m15:47:30.277006 [info ] [MainThread]: Found 13 models, 5 seeds, 22 data tests, 510 macros
[0m15:47:30.277006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '038952db-67b3-4738-b6b1-144d7b82acdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156D9D79310>]}
[0m15:47:30.277006 [info ] [MainThread]: 
[0m15:47:30.277006 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:47:30.277006 [info ] [MainThread]: 
[0m15:47:30.277006 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:47:30.277006 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB'
[0m15:47:30.296441 [debug] [ThreadPool]: dbt-sqlserver
[0m15:47:30.297076 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB"
[0m15:47:30.297076 [debug] [ThreadPool]: On list_ReadmitDB: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB"} */
USE [ReadmitDB];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:47:30.297076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:30.298144 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:47:30.424616 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:47:30.424616 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:47:30.424616 [debug] [ThreadPool]: On list_ReadmitDB: Close
[0m15:47:30.440312 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m15:47:30.455941 [debug] [ThreadPool]: dbt-sqlserver
[0m15:47:30.455941 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m15:47:30.455941 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:47:30.455941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:30.455941 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:47:30.455941 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:47:30.606302 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:47:30.606302 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m15:47:30.606302 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m15:47:30.621925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '038952db-67b3-4738-b6b1-144d7b82acdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156D6CBEC50>]}
[0m15:47:30.621925 [debug] [MainThread]: On master: COMMIT
[0m15:47:30.621925 [debug] [Thread-1 (]: Began running node model.readmit_risk.features_ml
[0m15:47:30.621925 [info ] [Thread-1 (]: 1 of 1 START sql table model dbo.features_ml ................................... [RUN]
[0m15:47:30.621925 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.readmit_risk.features_ml'
[0m15:47:30.621925 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.features_ml
[0m15:47:30.638001 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.features_ml"
[0m15:47:30.638001 [debug] [Thread-1 (]: Began executing node model.readmit_risk.features_ml
[0m15:47:30.678402 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:47:30.678402 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."features_ml__dbt_tmp__dbt_tmp_vw"
[0m15:47:30.678402 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:47:30.693625 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:47:30.693625 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'features_ml__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:47:30.694644 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:47:30.694644 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:47:30.695629 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:47:30.852598 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:47:30.868292 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:47:30.868292 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."features_ml__dbt_tmp__dbt_tmp_vw";');

[0m15:47:30.868292 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:47:30.883860 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.features_ml"
[0m15:47:30.883860 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:47:30.883860 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

  
    USE [ReadmitDB];
    USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."features_ml__dbt_tmp__dbt_tmp_vw" as 

select
  f.admission_id,
  f.patient_id,
  dp.age,
  dp.gender,
  dp.ethnicity,
  dp.bmi,
  dp.ses_group,
  dp.ever_diabetes,
  dp.ever_heart_failure,
  dp.ever_copd,
  dp.ever_ckd,
  f.length_of_stay,
  f.prior_admissions,
  f.department,
  f.sum_billed,
  f.sum_paid,
  f.avg_adherence,
  f.high_hba1c_flag,
  f.label_readmit_30 as readmit_label
from "ReadmitDB"."dbo"."fact_readmissions" f
left join "ReadmitDB"."dbo"."dim_patient" dp on f.patient_id = dp.patient_id
;;
    ')

EXEC('
            SELECT * INTO "ReadmitDB"."dbo"."features_ml__dbt_tmp" FROM "ReadmitDB"."dbo"."features_ml__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.features_ml__dbt_tmp__dbt_tmp_vw')



    
    use [ReadmitDB];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_features_ml__dbt_tmp_cci'
        AND object_id=object_id('dbo_features_ml__dbt_tmp')
    )
    DROP index "dbo"."features_ml__dbt_tmp".dbo_features_ml__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_features_ml__dbt_tmp_cci
    ON "dbo"."features_ml__dbt_tmp"

   


  
[0m15:47:40.656037 [debug] [Thread-1 (]: SQL status: OK in 10.000 seconds
[0m15:47:40.670544 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:47:40.670544 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.features_ml', 'features_ml__dbt_backup'
[0m15:47:41.219110 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m15:47:41.227404 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:47:41.227404 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.features_ml__dbt_tmp', 'features_ml'
[0m15:47:41.235979 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:47:41.266705 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: COMMIT
[0m15:47:41.266705 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."features_ml__dbt_backup"
[0m15:47:41.266705 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:47:41.266705 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

      
    USE [ReadmitDB];
    EXEC('DROP table IF EXISTS "dbo"."features_ml__dbt_backup";');

[0m15:47:41.282339 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:47:41.282339 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: Close
[0m15:47:41.282339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '038952db-67b3-4738-b6b1-144d7b82acdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156D9E33090>]}
[0m15:47:41.282339 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbo.features_ml .............................. [[32mOK[0m in 10.66s]
[0m15:47:41.282339 [debug] [Thread-1 (]: Finished running node model.readmit_risk.features_ml
[0m15:47:41.297864 [debug] [MainThread]: On master: COMMIT
[0m15:47:41.297864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:41.297864 [debug] [MainThread]: Connection 'list_ReadmitDB' was properly closed.
[0m15:47:41.297864 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m15:47:41.297864 [debug] [MainThread]: Connection 'model.readmit_risk.features_ml' was properly closed.
[0m15:47:41.297864 [info ] [MainThread]: 
[0m15:47:41.297864 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.02 seconds (11.02s).
[0m15:47:41.297864 [debug] [MainThread]: Command end result
[0m15:47:41.340917 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m15:47:41.356654 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m15:47:41.363652 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m15:47:41.364653 [info ] [MainThread]: 
[0m15:47:41.364653 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:47:41.365653 [info ] [MainThread]: 
[0m15:47:41.366665 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:47:41.368604 [debug] [MainThread]: Command `dbt run` succeeded at 15:47:41.368604 after 12.13 seconds
[0m15:47:41.368604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156D18A1090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156D18A1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156D81F8850>]}
[0m15:47:41.369603 [debug] [MainThread]: Flushing usage events
[0m15:47:46.625966 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:56:23.282135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF46A8CC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF46A83850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF46BB3BD0>]}


============================== 15:56:23.295511 | ff520a64-d3de-424a-9b60-55fc88a1d209 ==============================
[0m15:56:23.295511 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:56:23.295511 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --models features_ml', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m15:56:23.295511 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:56:23.295511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ff520a64-d3de-424a-9b60-55fc88a1d209', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF46B48B50>]}
[0m15:56:23.666806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff520a64-d3de-424a-9b60-55fc88a1d209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF483F8150>]}
[0m15:56:23.713682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff520a64-d3de-424a-9b60-55fc88a1d209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF45B87E50>]}
[0m15:56:23.713682 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:56:23.915862 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m15:56:24.090938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:56:24.090938 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:56:24.207143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff520a64-d3de-424a-9b60-55fc88a1d209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF487C6C10>]}
[0m15:56:24.280428 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m15:56:24.280428 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m15:56:24.328171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff520a64-d3de-424a-9b60-55fc88a1d209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF48854510>]}
[0m15:56:24.328171 [info ] [MainThread]: Found 13 models, 5 seeds, 22 data tests, 510 macros
[0m15:56:24.331236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff520a64-d3de-424a-9b60-55fc88a1d209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF487468D0>]}
[0m15:56:24.331236 [info ] [MainThread]: 
[0m15:56:24.331236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:56:24.331236 [info ] [MainThread]: 
[0m15:56:24.331236 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:56:24.331236 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB'
[0m15:56:24.355039 [debug] [ThreadPool]: dbt-sqlserver
[0m15:56:24.356165 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB"
[0m15:56:24.356165 [debug] [ThreadPool]: On list_ReadmitDB: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB"} */
USE [ReadmitDB];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:56:24.357291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:24.357291 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:56:24.482771 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:56:24.482771 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:56:24.482771 [debug] [ThreadPool]: On list_ReadmitDB: Close
[0m15:56:24.501140 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m15:56:24.501140 [debug] [ThreadPool]: dbt-sqlserver
[0m15:56:24.501140 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m15:56:24.514329 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:56:24.514329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:24.514329 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:56:24.514329 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:56:24.578151 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:56:24.578151 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m15:56:24.578151 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m15:56:24.593946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff520a64-d3de-424a-9b60-55fc88a1d209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF48854690>]}
[0m15:56:24.593946 [debug] [MainThread]: On master: COMMIT
[0m15:56:24.593946 [debug] [Thread-1 (]: Began running node model.readmit_risk.features_ml
[0m15:56:24.593946 [info ] [Thread-1 (]: 1 of 1 START sql table model dbo.features_ml ................................... [RUN]
[0m15:56:24.602655 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.readmit_risk.features_ml'
[0m15:56:24.602655 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.features_ml
[0m15:56:24.612232 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.features_ml"
[0m15:56:24.612821 [debug] [Thread-1 (]: Began executing node model.readmit_risk.features_ml
[0m15:56:24.646587 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:56:24.654182 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."features_ml__dbt_tmp__dbt_tmp_vw"
[0m15:56:24.664506 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:56:24.664506 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:56:24.664506 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'features_ml__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:56:24.664506 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:56:24.664506 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:56:24.664506 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:56:24.702641 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:24.710646 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:56:24.710646 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."features_ml__dbt_tmp__dbt_tmp_vw";');

[0m15:56:24.713350 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:24.726904 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.features_ml"
[0m15:56:24.726904 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:56:24.726904 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

  
    USE [ReadmitDB];
    USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."features_ml__dbt_tmp__dbt_tmp_vw" as 

select
  f.admission_id,
  f.patient_id,
  dp.age,
  dp.gender,
  dp.ethnicity,
  dp.bmi,
  dp.ses_group,
  dp.ever_diabetes,
  dp.ever_heart_failure,
  dp.ever_copd,
  dp.ever_ckd,
  f.length_of_stay,
  f.prior_admissions,
  f.department,
  f.sum_billed,
  f.sum_paid,
  f.avg_adherence,
  f.high_hba1c_flag,
  f.label_readmit_30 as readmit_label
from "ReadmitDB"."dbo"."fact_readmissions" f
left join "ReadmitDB"."dbo"."dim_patient" dp on f.patient_id = dp.patient_id
;;
    ')

EXEC('
            SELECT * INTO "ReadmitDB"."dbo"."features_ml__dbt_tmp" FROM "ReadmitDB"."dbo"."features_ml__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.features_ml__dbt_tmp__dbt_tmp_vw')



    
    use [ReadmitDB];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_features_ml__dbt_tmp_cci'
        AND object_id=object_id('dbo_features_ml__dbt_tmp')
    )
    DROP index "dbo"."features_ml__dbt_tmp".dbo_features_ml__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_features_ml__dbt_tmp_cci
    ON "dbo"."features_ml__dbt_tmp"

   


  
[0m15:56:24.878206 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:24.893939 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:56:24.893939 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.features_ml', 'features_ml__dbt_backup'
[0m15:56:25.259150 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:25.274842 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:56:25.274842 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.features_ml__dbt_tmp', 'features_ml'
[0m15:56:25.274842 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:25.290658 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: COMMIT
[0m15:56:25.306280 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."features_ml__dbt_backup"
[0m15:56:25.306280 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:56:25.306280 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

      
    USE [ReadmitDB];
    EXEC('DROP table IF EXISTS "dbo"."features_ml__dbt_backup";');

[0m15:56:25.306280 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:25.306280 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: Close
[0m15:56:25.321955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff520a64-d3de-424a-9b60-55fc88a1d209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF4900D3D0>]}
[0m15:56:25.321955 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbo.features_ml .............................. [[32mOK[0m in 0.70s]
[0m15:56:25.321955 [debug] [Thread-1 (]: Finished running node model.readmit_risk.features_ml
[0m15:56:25.321955 [debug] [MainThread]: On master: COMMIT
[0m15:56:25.321955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:25.321955 [debug] [MainThread]: Connection 'list_ReadmitDB' was properly closed.
[0m15:56:25.321955 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m15:56:25.321955 [debug] [MainThread]: Connection 'model.readmit_risk.features_ml' was properly closed.
[0m15:56:25.321955 [info ] [MainThread]: 
[0m15:56:25.321955 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m15:56:25.321955 [debug] [MainThread]: Command end result
[0m15:56:25.364453 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m15:56:25.364453 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m15:56:25.364453 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m15:56:25.364453 [info ] [MainThread]: 
[0m15:56:25.364453 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:56:25.364453 [info ] [MainThread]: 
[0m15:56:25.364453 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:56:25.364453 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:56:25.364453 [debug] [MainThread]: Command `dbt run` succeeded at 15:56:25.364453 after 2.17 seconds
[0m15:56:25.364453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF49058390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF3FF0A210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF3FF0A490>]}
[0m15:56:25.364453 [debug] [MainThread]: Flushing usage events
[0m15:56:38.225109 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:25.497098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E992194D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E992196D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E9915D3D0>]}


============================== 15:57:25.497098 | 44d03540-5607-45ab-9f76-af70c64b1250 ==============================
[0m15:57:25.497098 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:57:25.497098 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --models features_ml', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt'}
[0m15:57:25.497098 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:57:25.497098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '44d03540-5607-45ab-9f76-af70c64b1250', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E9928BB50>]}
[0m15:57:25.869186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44d03540-5607-45ab-9f76-af70c64b1250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E989CE210>]}
[0m15:57:25.931795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44d03540-5607-45ab-9f76-af70c64b1250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E9AAF9090>]}
[0m15:57:25.931795 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:57:26.137455 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m15:57:26.296317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:57:26.296317 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:57:26.390208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44d03540-5607-45ab-9f76-af70c64b1250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E9AF1F790>]}
[0m15:57:26.468435 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m15:57:26.468435 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m15:57:26.504910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44d03540-5607-45ab-9f76-af70c64b1250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E9AB3C690>]}
[0m15:57:26.506028 [info ] [MainThread]: Found 13 models, 5 seeds, 22 data tests, 510 macros
[0m15:57:26.506028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44d03540-5607-45ab-9f76-af70c64b1250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E9AE15C50>]}
[0m15:57:26.506028 [info ] [MainThread]: 
[0m15:57:26.506028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:26.506028 [info ] [MainThread]: 
[0m15:57:26.506028 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:57:26.506028 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB'
[0m15:57:26.532234 [debug] [ThreadPool]: dbt-sqlserver
[0m15:57:26.532234 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB"
[0m15:57:26.532234 [debug] [ThreadPool]: On list_ReadmitDB: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB"} */
USE [ReadmitDB];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:57:26.532234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:26.532234 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:57:26.651347 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:57:26.667051 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:57:26.667051 [debug] [ThreadPool]: On list_ReadmitDB: Close
[0m15:57:26.667051 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m15:57:26.690995 [debug] [ThreadPool]: dbt-sqlserver
[0m15:57:26.690995 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m15:57:26.690995 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:57:26.690995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:26.690995 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:57:26.690995 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:57:26.762462 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:57:26.762462 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m15:57:26.762462 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m15:57:26.774206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44d03540-5607-45ab-9f76-af70c64b1250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E9AF1F790>]}
[0m15:57:26.777709 [debug] [MainThread]: On master: COMMIT
[0m15:57:26.778258 [debug] [Thread-1 (]: Began running node model.readmit_risk.features_ml
[0m15:57:26.778258 [info ] [Thread-1 (]: 1 of 1 START sql table model dbo.features_ml ................................... [RUN]
[0m15:57:26.778258 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.readmit_risk.features_ml'
[0m15:57:26.778258 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.features_ml
[0m15:57:26.793846 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.features_ml"
[0m15:57:26.797021 [debug] [Thread-1 (]: Began executing node model.readmit_risk.features_ml
[0m15:57:26.837234 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:57:26.837234 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."features_ml__dbt_tmp__dbt_tmp_vw"
[0m15:57:26.837234 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:57:26.837234 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:57:26.837234 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'features_ml__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:57:26.852238 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:57:26.852894 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:57:26.857572 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:57:26.884616 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:57:26.892944 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:57:26.892944 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."features_ml__dbt_tmp__dbt_tmp_vw";');

[0m15:57:26.892944 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:57:26.908566 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.features_ml"
[0m15:57:26.908566 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:57:26.908566 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

  
    USE [ReadmitDB];
    USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."features_ml__dbt_tmp__dbt_tmp_vw" as 

select
  f.admission_id,
  f.patient_id,
  dp.age,
  dp.gender,
  dp.ethnicity,
  dp.bmi,
  dp.ses_group,
  dp.ever_diabetes,
  dp.ever_heart_failure,
  dp.ever_copd,
  dp.ever_ckd,
  f.length_of_stay,
  f.prior_admissions,
  f.department,
  f.sum_billed,
  f.sum_paid,
  f.avg_adherence,
  f.high_hba1c_flag,
  f.label_readmit_30 as readmit_label
from "ReadmitDB"."dbo"."fact_readmissions" f
left join "ReadmitDB"."dbo"."dim_patient" dp on f.patient_id = dp.patient_id
;;
    ')

EXEC('
            SELECT * INTO "ReadmitDB"."dbo"."features_ml__dbt_tmp" FROM "ReadmitDB"."dbo"."features_ml__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.features_ml__dbt_tmp__dbt_tmp_vw')



    
    use [ReadmitDB];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_features_ml__dbt_tmp_cci'
        AND object_id=object_id('dbo_features_ml__dbt_tmp')
    )
    DROP index "dbo"."features_ml__dbt_tmp".dbo_features_ml__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_features_ml__dbt_tmp_cci
    ON "dbo"."features_ml__dbt_tmp"

   


  
[0m15:57:27.066396 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:57:27.082247 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:57:27.082247 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.features_ml', 'features_ml__dbt_backup'
[0m15:57:27.470203 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:57:27.476790 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:57:27.476790 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.features_ml__dbt_tmp', 'features_ml'
[0m15:57:27.479796 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:57:27.496821 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: COMMIT
[0m15:57:27.496821 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."features_ml__dbt_backup"
[0m15:57:27.496821 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:57:27.508252 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

      
    USE [ReadmitDB];
    EXEC('DROP table IF EXISTS "dbo"."features_ml__dbt_backup";');

[0m15:57:27.512778 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:57:27.512778 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: Close
[0m15:57:27.516530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44d03540-5607-45ab-9f76-af70c64b1250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E9B720050>]}
[0m15:57:27.516530 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbo.features_ml .............................. [[32mOK[0m in 0.73s]
[0m15:57:27.516530 [debug] [Thread-1 (]: Finished running node model.readmit_risk.features_ml
[0m15:57:27.520677 [debug] [MainThread]: On master: COMMIT
[0m15:57:27.520677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:27.520677 [debug] [MainThread]: Connection 'list_ReadmitDB' was properly closed.
[0m15:57:27.523226 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m15:57:27.523226 [debug] [MainThread]: Connection 'model.readmit_risk.features_ml' was properly closed.
[0m15:57:27.524032 [info ] [MainThread]: 
[0m15:57:27.524723 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m15:57:27.524723 [debug] [MainThread]: Command end result
[0m15:57:27.555876 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m15:57:27.562460 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m15:57:27.570946 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m15:57:27.572236 [info ] [MainThread]: 
[0m15:57:27.572236 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:57:27.572236 [info ] [MainThread]: 
[0m15:57:27.572236 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:57:27.575100 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:57:27.576125 [debug] [MainThread]: Command `dbt run` succeeded at 15:57:27.576125 after 2.15 seconds
[0m15:57:27.576125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E9928BB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E9B7AE510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E9921BE10>]}
[0m15:57:27.576125 [debug] [MainThread]: Flushing usage events
[0m15:57:34.924069 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:57.269344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA510A010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA51094D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA51093D0>]}


============================== 15:57:57.273379 | 94f4aaba-f4d7-41d9-9cc4-4525227ef8b1 ==============================
[0m15:57:57.273379 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:57:57.273379 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --models features_ml', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\Administrator\\Documents\\health-readmission-case\\readmit_risk\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\Administrator\\.dbt'}
[0m15:57:57.273379 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:57:57.273379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '94f4aaba-f4d7-41d9-9cc4-4525227ef8b1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA5150210>]}
[0m15:57:57.662315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94f4aaba-f4d7-41d9-9cc4-4525227ef8b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA6A4A750>]}
[0m15:57:57.724964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94f4aaba-f4d7-41d9-9cc4-4525227ef8b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA4147F50>]}
[0m15:57:57.724964 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:57:57.942171 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m15:57:58.099796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:57:58.099796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:57:58.209154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94f4aaba-f4d7-41d9-9cc4-4525227ef8b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA6D95F90>]}
[0m15:57:58.302893 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m15:57:58.302893 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m15:57:58.334053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94f4aaba-f4d7-41d9-9cc4-4525227ef8b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA6DAC3D0>]}
[0m15:57:58.334053 [info ] [MainThread]: Found 13 models, 5 seeds, 22 data tests, 510 macros
[0m15:57:58.334053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94f4aaba-f4d7-41d9-9cc4-4525227ef8b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA6D05BD0>]}
[0m15:57:58.334053 [info ] [MainThread]: 
[0m15:57:58.334053 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:58.349733 [info ] [MainThread]: 
[0m15:57:58.349733 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:57:58.349733 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB'
[0m15:57:58.368135 [debug] [ThreadPool]: dbt-sqlserver
[0m15:57:58.370618 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB"
[0m15:57:58.370618 [debug] [ThreadPool]: On list_ReadmitDB: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB"} */
USE [ReadmitDB];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:57:58.370618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:58.372660 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:57:58.408031 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:57:58.423164 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:57:58.423164 [debug] [ThreadPool]: On list_ReadmitDB: Close
[0m15:57:58.423164 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_ReadmitDB_dbo'
[0m15:57:58.423164 [debug] [ThreadPool]: dbt-sqlserver
[0m15:57:58.438239 [debug] [ThreadPool]: Using sqlserver connection "list_ReadmitDB_dbo"
[0m15:57:58.438239 [debug] [ThreadPool]: On list_ReadmitDB_dbo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "connection_name": "list_ReadmitDB_dbo"} */
USE [ReadmitDB];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:57:58.439377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:58.439377 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:57:58.439377 [debug] [ThreadPool]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:57:58.446603 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:57:58.446603 [debug] [ThreadPool]: On list_ReadmitDB_dbo: ROLLBACK
[0m15:57:58.446603 [debug] [ThreadPool]: On list_ReadmitDB_dbo: Close
[0m15:57:58.452305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94f4aaba-f4d7-41d9-9cc4-4525227ef8b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA6A93290>]}
[0m15:57:58.454869 [debug] [MainThread]: On master: COMMIT
[0m15:57:58.456228 [debug] [Thread-1 (]: Began running node model.readmit_risk.features_ml
[0m15:57:58.456228 [info ] [Thread-1 (]: 1 of 1 START sql table model dbo.features_ml ................................... [RUN]
[0m15:57:58.456228 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.readmit_risk.features_ml'
[0m15:57:58.456228 [debug] [Thread-1 (]: Began compiling node model.readmit_risk.features_ml
[0m15:57:58.463347 [debug] [Thread-1 (]: Writing injected SQL for node "model.readmit_risk.features_ml"
[0m15:57:58.463347 [debug] [Thread-1 (]: Began executing node model.readmit_risk.features_ml
[0m15:57:58.505881 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:57:58.512805 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."features_ml__dbt_tmp__dbt_tmp_vw"
[0m15:57:58.512805 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:57:58.512805 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:57:58.522594 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

        USE [ReadmitDB];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'ReadmitDB'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'features_ml__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:57:58.523658 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:57:58.523658 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;Database=ReadmitDB;UID={dbt_users};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:57:58.523658 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: ReadmitDB
[0m15:57:58.523658 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:57:58.523658 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:57:58.523658 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

      
      
    
    USE [ReadmitDB];
    EXEC('DROP view IF EXISTS "dbo"."features_ml__dbt_tmp__dbt_tmp_vw";');

[0m15:57:58.523658 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:57:58.547085 [debug] [Thread-1 (]: Writing runtime sql for node "model.readmit_risk.features_ml"
[0m15:57:58.547085 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:57:58.547085 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

  
    USE [ReadmitDB];
    USE [ReadmitDB];
    
    

    

    
    USE [ReadmitDB];
    EXEC('
        create view "dbo"."features_ml__dbt_tmp__dbt_tmp_vw" as 

select
  f.admission_id,
  f.patient_id,
  dp.age,
  dp.gender,
  dp.ethnicity,
  dp.bmi,
  dp.ses_group,
  dp.ever_diabetes,
  dp.ever_heart_failure,
  dp.ever_copd,
  dp.ever_ckd,
  f.length_of_stay,
  f.prior_admissions,
  f.department,
  f.sum_billed,
  f.sum_paid,
  f.avg_adherence,
  f.high_hba1c_flag,
  f.label_readmit_30 as readmit_label
from "ReadmitDB"."dbo"."fact_readmissions" f
left join "ReadmitDB"."dbo"."dim_patient" dp on f.patient_id = dp.patient_id
;;
    ')

EXEC('
            SELECT * INTO "ReadmitDB"."dbo"."features_ml__dbt_tmp" FROM "ReadmitDB"."dbo"."features_ml__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.features_ml__dbt_tmp__dbt_tmp_vw')



    
    use [ReadmitDB];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_features_ml__dbt_tmp_cci'
        AND object_id=object_id('dbo_features_ml__dbt_tmp')
    )
    DROP index "dbo"."features_ml__dbt_tmp".dbo_features_ml__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_features_ml__dbt_tmp_cci
    ON "dbo"."features_ml__dbt_tmp"

   


  
[0m15:57:58.667113 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:57:58.682733 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:57:58.682733 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.features_ml', 'features_ml__dbt_backup'
[0m15:57:58.698294 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:57:58.698294 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:57:58.698294 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */
USE [ReadmitDB];
      EXEC sp_rename 'dbo.features_ml__dbt_tmp', 'features_ml'
[0m15:57:58.698294 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:57:58.713984 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: COMMIT
[0m15:57:58.729604 [debug] [Thread-1 (]: Applying DROP to: "ReadmitDB"."dbo"."features_ml__dbt_backup"
[0m15:57:58.729604 [debug] [Thread-1 (]: Using sqlserver connection "model.readmit_risk.features_ml"
[0m15:57:58.729604 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "readmit_risk", "target_name": "dev", "node_id": "model.readmit_risk.features_ml"} */

      
    USE [ReadmitDB];
    EXEC('DROP table IF EXISTS "dbo"."features_ml__dbt_backup";');

[0m15:57:58.729604 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:57:58.729604 [debug] [Thread-1 (]: On model.readmit_risk.features_ml: Close
[0m15:57:58.729604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f4aaba-f4d7-41d9-9cc4-4525227ef8b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA698C5D0>]}
[0m15:57:58.729604 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbo.features_ml .............................. [[32mOK[0m in 0.27s]
[0m15:57:58.745226 [debug] [Thread-1 (]: Finished running node model.readmit_risk.features_ml
[0m15:57:58.745226 [debug] [MainThread]: On master: COMMIT
[0m15:57:58.745226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:58.745226 [debug] [MainThread]: Connection 'list_ReadmitDB' was properly closed.
[0m15:57:58.745226 [debug] [MainThread]: Connection 'list_ReadmitDB_dbo' was properly closed.
[0m15:57:58.745226 [debug] [MainThread]: Connection 'model.readmit_risk.features_ml' was properly closed.
[0m15:57:58.745226 [info ] [MainThread]: 
[0m15:57:58.745226 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m15:57:58.745226 [debug] [MainThread]: Command end result
[0m15:57:58.781229 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\manifest.json
[0m15:57:58.781229 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\semantic_manifest.json
[0m15:57:58.790140 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Administrator\Documents\health-readmission-case\readmit_risk\target\run_results.json
[0m15:57:58.790140 [info ] [MainThread]: 
[0m15:57:58.790140 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:57:58.790140 [info ] [MainThread]: 
[0m15:57:58.790140 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:57:58.790140 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:57:58.790140 [debug] [MainThread]: Command `dbt run` succeeded at 15:57:58.790140 after 1.63 seconds
[0m15:57:58.790140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA4DE0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA5197F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA5197E90>]}
[0m15:57:58.790140 [debug] [MainThread]: Flushing usage events
[0m15:58:04.294307 [debug] [MainThread]: An error was encountered while trying to flush usage events
